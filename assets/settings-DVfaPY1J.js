import{_ as b,H as y,G as g,J as c,o as C,c as h,w as r,a as t,a7 as v,a8 as T,K as d,T as p,L as s,a9 as k,M as i,a6 as f,P as D,a3 as w,aa as I}from"./index-BtDICxnb.js";import{f as U}from"./project-6HA_Id1_.js";import{a as n,V as S}from"./VRow-B11LTdUE.js";import{V as B}from"./VTextarea-B1JpEhDg.js";import{V}from"./VSelect-B_T9vk1H.js";import{V as E,a as N,b as q,c as F,d as H}from"./VExpansionPanels-DrlPXF4t.js";import{V as L}from"./VChip-BJ4ELN6o.js";import{V as P}from"./VSpacer-B_edWnRm.js";import{V as A}from"./VDialog-HWsD1kdY.js";import{V as G}from"./VContainer-BAuHVaek.js";import"./db-lljOPxAB.js";/* empty css              */import"./VCheckboxBtn-CBg8mxtM.js";import"./VSelectionControl-CAEgh1GB.js";import"./filter-DQ_VrjRN.js";const J={data(){return{localuser:y,projectstates:[{state:"私密",abbr:"private"},{state:"开源",abbr:"public"}],currentProjectID:this.$route.params.id,currentProject:{},aboutTags:{items:["动画","故事","音乐","硬核","艺术","水"],chips:[]},confirmDelete:!1}},async created(){this.localuser.isLogin==!1&&this.$router.push("/app/account/login"),await this.fetchProject()},setup(){g({title:"项目设置"})},methods:{removetag(o){this.aboutTags.chips.splice(this.aboutTags.chips.indexOf(o),1)},async fetchProject(){try{this.currentProject=await U(this.currentProjectID),this.aboutTags.chips=this.currentProject.tags.map(o=>o.name)}catch(o){console.error(o),this.$toast.add({severity:"error",summary:"错误",detail:"无法获取项目数据",life:3e3})}},async deleteProject(){try{await c.delete(`/project/${this.currentProjectID}`),this.$toast.add({severity:"info",summary:"成功",detail:"项目已删除",life:3e3}),this.$router.push("/explore")}catch(o){console.error(o),this.$toast.add({severity:"error",summary:"错误",detail:"删除项目失败",life:3e3})}},async SaveProjectsInfo(){this.currentProject.tags=this.aboutTags.chips.map(o=>o);try{const o=(await c.put(`/project/${this.currentProjectID}`,this.currentProject)).data;this.$toast.add({severity:o.status,summary:o.message,detail:o.message,life:3e3})}catch(o){console.error(o),this.$toast.add({severity:"error",summary:"错误",detail:"保存项目失败",life:3e3})}},cancel(){this.$router.push("/explore/my")}}};function K(o,e,M,O,l,u){return C(),h(G,null,{default:r(()=>[t(S,null,{default:r(()=>[t(n,{cols:"12"},{default:r(()=>[t(v,{label:"标题",required:"",modelValue:l.currentProject.title,"onUpdate:modelValue":e[0]||(e[0]=a=>l.currentProject.title=a),hint:"将会在首页展示"},null,8,["modelValue"])]),_:1}),t(n,{cols:"12"},{default:r(()=>[t(B,{hint:"介绍作品类型，玩法，并向对这个作品有帮助的人致谢！",label:"简介",modelValue:l.currentProject.description,"onUpdate:modelValue":e[1]||(e[1]=a=>l.currentProject.description=a)},null,8,["modelValue"])]),_:1}),t(n,{cols:"12",sm:"6"},{default:r(()=>[t(V,{items:["scratch","python","text"],label:"类型",required:"",hint:"不建议你改",modelValue:l.currentProject.type,"onUpdate:modelValue":e[2]||(e[2]=a=>l.currentProject.type=a)},null,8,["modelValue"])]),_:1}),t(n,{cols:"12",sm:"6"},{default:r(()=>[t(V,{modelValue:l.currentProject.state,"onUpdate:modelValue":e[3]||(e[3]=a=>l.currentProject.state=a),items:l.projectstates,"item-title":"state","item-value":"abbr",label:"项目状态",hint:"我们鼓励开源"},null,8,["modelValue","items"])]),_:1}),t(n,{cols:"12"},{default:r(()=>[t(E,{modelValue:l.aboutTags.chips,"onUpdate:modelValue":e[4]||(e[4]=a=>l.aboutTags.chips=a),items:l.aboutTags.items,label:"标签","prepend-icon":"mdi-tag",variant:"solo",chips:"",multiple:""},{selection:r(({attrs:a,item:m,select:j,selected:x})=>[t(L,T(a,{"model-value":x,closable:"",onClick:j,"onClick:close":R=>u.removetag(m)}),{default:r(()=>[d("strong",null,p(m.name),1),e[8]||(e[8]=s("  ")),e[9]||(e[9]=d("span",null,"(interest)",-1))]),_:2},1040,["model-value","onClick","onClick:close"])]),_:1},8,["modelValue","items"])]),_:1}),t(N,null,{default:r(()=>[t(q,null,{default:r(()=>[t(F,null,{default:r(()=>e[10]||(e[10]=[s("详细数据")])),_:1}),t(H,null,{default:r(()=>[s(p(l.currentProject),1)]),_:1})]),_:1})]),_:1})]),_:1}),t(k),t(f,null,{default:r(()=>[t(i,{color:"error",text:"删除",variant:"tonal",onClick:e[5]||(e[5]=a=>l.confirmDelete=!0)}),t(P),t(i,{text:"取消",variant:"plain",onClick:u.cancel},null,8,["onClick"]),t(i,{color:"primary",text:"保存",variant:"tonal",onClick:u.SaveProjectsInfo},null,8,["onClick"])]),_:1}),t(A,{modelValue:l.confirmDelete,"onUpdate:modelValue":e[7]||(e[7]=a=>l.confirmDelete=a),"max-width":"500px"},{default:r(()=>[t(D,null,{default:r(()=>[t(w,{class:"headline"},{default:r(()=>e[11]||(e[11]=[s("确认删除")])),_:1}),t(I,null,{default:r(()=>e[12]||(e[12]=[s("你确定要删除这个项目吗？此操作无法撤销。")])),_:1}),t(f,null,{default:r(()=>[t(P),t(i,{color:"primary",text:"",onClick:e[6]||(e[6]=a=>l.confirmDelete=!1)},{default:r(()=>e[13]||(e[13]=[s("取消")])),_:1}),t(i,{color:"error",text:"",onClick:u.deleteProject},{default:r(()=>e[14]||(e[14]=[s("删除")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const ie=b(J,[["render",K]]);export{ie as default};
