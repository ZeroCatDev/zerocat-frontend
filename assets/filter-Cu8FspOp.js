import{p as x,A as v,x as S,aB as m,ay as A,f as k,D as w,F as C,cn as I,cD as B}from"./index-CMux7lMK.js";const $=(t,l,e)=>{if(t==null||l==null)return-1;if(!l.length)return 0;t=t.toString().toLocaleLowerCase(),l=l.toString().toLocaleLowerCase();const r=[];let n=t.indexOf(l);for(;~n;)r.push([n,n+l.length]),n=t.indexOf(l,n+l.length);return r.length?r:-1};function O(t,l){if(!(t==null||typeof t=="boolean"||t===-1))return typeof t=="number"?[[t,t+l.length]]:Array.isArray(t[0])?t:[t]}const P=x({customFilter:Function,customKeyFilter:Object,filterKeys:[Array,String],filterMode:{type:String,default:"intersection"},noFilter:Boolean},"filter");function D(t,l,e){var c;const r=[],n=(e==null?void 0:e.default)??$,i=e!=null&&e.filterKeys?I(e.filterKeys):!1,a=Object.keys((e==null?void 0:e.customKeyFilter)??{}).length;if(!(t!=null&&t.length))return r;let u=null;e:for(let d=0;d<t.length;d++){const[f,M=f]=I(t[d]),h={},g={};let s=-1;if((l||a>0)&&!(e!=null&&e.noFilter)){let K=!1;if(typeof f=="object"){if(f.type==="divider"||f.type==="subheader"){(u==null?void 0:u.type)==="divider"&&f.type==="subheader"&&r.push(u),u={index:d,matches:{},type:f.type};continue}const L=i||Object.keys(M);K=L.length===a;for(const b of L){const j=B(M,b),_=(c=e==null?void 0:e.customKeyFilter)==null?void 0:c[b];if(s=_?_(j,l,f):n(j,l,f),s!==-1&&s!==!1)_?h[b]=O(s,l):g[b]=O(s,l);else if((e==null?void 0:e.filterMode)==="every")continue e}}else s=n(f,l,f),s!==-1&&s!==!1&&(g.title=O(s,l));const F=Object.keys(g).length,y=Object.keys(h).length;if(!F&&!y||(e==null?void 0:e.filterMode)==="union"&&y!==a&&!F||(e==null?void 0:e.filterMode)==="intersection"&&(y!==a||!F&&a>0&&!K))continue}u&&(r.push(u),u=null),r.push({index:d,matches:{...g,...h}})}return r}function R(t,l,e,r){const n=v([]),i=v(new Map),a=S(()=>r!=null&&r.transform?m(l).map(c=>[c,r.transform(c)]):m(l));A(()=>{const c=typeof e=="function"?e():m(e),d=typeof c!="string"&&typeof c!="number"?"":String(c),f=D(a.value,d,{customKeyFilter:{...t.customKeyFilter,...m(r==null?void 0:r.customKeyFilter)},default:t.customFilter,filterKeys:t.filterKeys,filterMode:t.filterMode,noFilter:t.noFilter}),M=m(l),h=[],g=new Map;f.forEach(s=>{let{index:K,matches:F}=s;const y=M[K];h.push(y),g.set(y.value,F)}),n.value=h,i.value=g});function u(c){return i.value.get(c.value)}return{filteredItems:n,filteredMatches:i,getMatches:u}}function z(t,l,e){return e==null||!e.length?l:e.map((r,n)=>{const i=n===0?0:e[n-1][1],a=[k("span",{class:w(`${t}__unmask`)},[l.slice(i,r[0])]),k("span",{class:w(`${t}__mask`)},[l.slice(r[0],r[1])])];return n===e.length-1&&a.push(k("span",{class:w(`${t}__unmask`)},[l.slice(r[1])])),k(C,null,[a])})}export{z as h,P as m,R as u};
