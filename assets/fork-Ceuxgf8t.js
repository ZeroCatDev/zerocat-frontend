import{o as f}from"./openEdit-AJJkPSPH.js";import{_ as h,H as y,J as o,r as j,o as x,c as g,w as a,a as s,O as k,a2 as w,a3 as V,L as i,T as p,a4 as b,P as $,K as l,a7 as v,M as _}from"./index-DL7175Ml.js";import{_ as C}from"./43-lazyload-CBkwrR6M.js";import{V as R}from"./VContainer-DniT_RcQ.js";/* empty css              */const F={data(){return{project:{},projectfile:{},newid:"",openEditor:f,localuser:y,checktext:"",checkknow:!1,checklicense:!1,scratch_proxy:"https://scratch.192325.xyz",textRules:[e=>e?!0:"记得输入内容哦~",e=>{if(e!="我保证会好好对待改编的作品")return"输的不太对~"}]}},async created(){await this.getproject()},methods:{async getproject(){try{const e=await o.get(`${this.scratch_proxy}/projects/${this.$route.params.id}`);this.project=e.data}catch(e){console.log(e)}},async forkproject(e){try{const t=await o.post(`/project/${e}/fork`);console.log(t.data),this.$toast.add({severity:"success",summary:"成功",detail:"分叉成功",life:3e3}),t.data.id&&this.$router.push(`/projects/${t.data.id}`)}catch(t){console.log(t),this.$toast.add({severity:"error",summary:"错误",detail:t,life:3e3})}},async getProjectFile(){try{await this.getproject();const e=await o.get(`${this.scratch_proxy}/projects/source/${this.$route.params.id}?token=${this.project.project_token}`);this.projectfile=e.data,this.$toast.add({severity:"success",summary:"成功",detail:"获取项目文件成功",life:3e3});const t=await o.post("/project/",{title:this.project.title,type:"scratch",state:"public"});this.newid=t.data.id;const n=await o.put(`/project/${this.newid}/source`,this.projectfile);this.$toast.add({severity:"info",summary:"信息",detail:n.data,life:3e3});const c=await o.post(`/project/${this.newid}/push`);this.$toast.add({severity:"info",summary:"信息",detail:c.data,life:3e3})}catch(e){console.error(e),this.$toast.add({severity:"error",summary:"错误",detail:"操作失败，请稍后再试",life:3e3})}}}};function z(e,t,n,c,r,u){const m=j("v-text");return x(),g(R,{class:"pa-md-12"},{default:a(()=>[s($,{style:{"aspect-ratio":"4/3"},rounded:"lg"},{default:a(()=>[s(k,{src:"https://scratch.192325.xyz/thumbnails/"+r.project.id,class:"align-end","lazy-src":C,height:"100%",gradient:"to bottom, rgba(0,0,0,.1), rgba(0,0,0,.5)",cover:""},{default:a(()=>[s(w,null,{default:a(()=>[s(V,null,{default:a(()=>[i(p(r.project.title),1)]),_:1}),s(b,null,{default:a(()=>[i(p(r.project.description),1)]),_:1})]),_:1})]),_:1},8,["src"])]),_:1}),t[3]||(t[3]=l("br",null,null,-1)),s(m,null,{default:a(()=>t[2]||(t[2]=[i("如果您已了解以上内容，请在下方的输入框中输入")])),_:1}),t[4]||(t[4]=i()),t[5]||(t[5]=l("br",null,null,-1)),t[6]||(t[6]=l("br",null,null,-1)),s(v,{hint:"请准确输入上方的话",label:"我保证会好好对待改编的作品",type:"input",modelValue:r.checktext,"onUpdate:modelValue":t[0]||(t[0]=d=>r.checktext=d),rules:r.textRules,required:"",variant:"outlined",clearable:""},null,8,["modelValue","rules"]),t[7]||(t[7]=l("br",null,null,-1)),s(_,{class:"text-none",color:"primary",rounded:"xl",text:"Fork",variant:"flat",size:"large",onClick:t[1]||(t[1]=d=>u.getProjectFile(r.project.id)),"append-icon":"mdi-arrow-right",disabled:!r.checktext},null,8,["disabled"])]),_:1})}const S=h(F,[["render",z]]);export{S as default};
