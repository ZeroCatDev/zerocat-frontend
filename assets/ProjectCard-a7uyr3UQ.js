import{_ as p,by as m,aa as g,Y as h,o as l,N as r,e as o,$ as y,W as n,n as b,bM as k,aN as d,a9 as f,L as i,X as u,aP as _}from"./index-BtdOAlf3.js";const w={props:{project:{type:Object,required:!0},author:{type:Object,default:null},showAuthor:{type:Boolean,default:!0}},data(){return{loading:!1,error:null,s3BucketUrl:""}},async mounted(){this.s3BucketUrl=await g("s3.staticurl")},created(){this.initializeData()},watch:{project:{handler(){this.initializeData()},deep:!0},author:{handler(){this.initializeData()},deep:!0},showAuthor(){this.loadAuthorIfNeeded()}},methods:{initializeData(){this.project&&this.loadAuthorIfNeeded()},loadAuthorIfNeeded(){var e;this.showAuthor&&!this.author&&((e=this.project)!=null&&e.author)&&(this.author=this.project.author)},getProjectLink(){var e,a;return this.project?(e=this.project.author)!=null&&e.username&&this.project.name?`/${this.project.author.username}/${this.project.name}`:(a=this.project.author)!=null&&a.username?`/${this.project.author.username}/${this.project.id}`:"":""},async fetchProject(e){if(!this.loading){this.loading=!0;try{const a=await m([e]);a&&a.length>0&&(this.project=a[0],this.loadAuthorIfNeeded())}catch(a){console.error("Failed to fetch project:",a)}finally{this.loading=!1}}},async fetchAuthor(e){}}};function A(e,a,t,I,c,j){return l(),h(n,{class:"box-shadow",rounded:"lg"},{default:r(()=>[o(n,{to:j.getProjectLink(),rounded:"lg",style:{"aspect-ratio":"4/3"}},{default:r(()=>[o(b,{src:t.project?c.s3BucketUrl+"/scratch_slt/"+t.project.id:"",class:"align-end",cover:"",gradient:"to bottom, rgba(0,0,0,.1), rgba(0,0,0,.5)",height:"100%","lazy-src":k},{default:r(()=>[o(d,null,{default:r(()=>[o(f,null,{default:r(()=>{var s;return[i(u(((s=t.project)==null?void 0:s.title)||"加载中..."),1)]}),_:1}),o(_,null,{default:r(()=>{var s;return[i(u(((s=t.project)==null?void 0:s.description)||""),1)]}),_:1})]),_:1})]),_:1},8,["src"])]),_:1},8,["to"]),t.showAuthor&&t.author?(l(),h(d,{key:0,"append-avatar":t.author.avatar?c.s3BucketUrl+"/user/"+t.author.avatar:""},{default:r(()=>[o(f,null,{default:r(()=>[i(u(t.author.display_name||t.author.username||"未知用户"),1)]),_:1}),o(_,null,{default:r(()=>[i(u(t.author.username||""),1)]),_:1})]),_:1},8,["append-avatar"])):y("",!0)]),_:1})}const V=p(w,[["render",A],["__scopeId","data-v-64370181"]]);export{V as _};
