import{P as b}from"./Projects-DpQGcvrN.js";import{o as j}from"./openEdit-AJJkPSPH.js";import{_ as C,H as x,I as k,G as w,J as h,o as U,c as T,w as o,a as l,a4 as m,M as u,L as p,K as c,P as I,a7 as D,a5 as S,T as V,a6 as _,a3 as B}from"./index-l8nl0mmO.js";import{a,V as g}from"./VRow-DzCNb48S.js";import{V as d}from"./VSelect-BW3ypnSW.js";import{V as E}from"./VAutocomplete-BuitKNIO.js";import{V as N}from"./VTextarea-rEi6ay5e.js";import{V as q,a as A,b as H,c as F,d as G}from"./VExpansionPanels-DgyVvsgt.js";import{V as J}from"./VChip-WiSErpP0.js";import{V as K}from"./VSpacer-BIG1Il7u.js";import{V as L}from"./VDialog-DgxBAFjA.js";import{V as M}from"./VContainer-CrLf5Spu.js";import"./showProjects-yawC8ZSb.js";import"./project-B55DSewP.js";import"./db-DaSIEcjd.js";import"./user-BtZz5K0W.js";import"./43-lazyload-CBkwrR6M.js";import"./VPagination-Bo48AUo4.js";/* empty css              */import"./VCheckboxBtn-Cb5K70ZU.js";import"./VSelectionControl-CF5AxGnf.js";import"./filter-Bl4MA730.js";const O={components:{Projects:b},data(){return{localuser:x,projectstates:[{state:"私密",abbr:"private"},{state:"开源",abbr:"public"}],projecthistory:[{state:"关闭",abbr:"0"},{state:"开启",abbr:"1"}],searchstates:[{state:"所有",abbr:""},{state:"私密",abbr:"private"},{state:"开源",abbr:"public"}],typeitems:[{name:"所有",type:""},{name:"Scratch",type:"scratch"},{name:"Python",type:"python"}],orderitems:[{name:"观看量升序",type:"view_up"},{name:"观看量降序",type:"view_down"},{name:"时间升序",type:"time_up"},{name:"时间降序",type:"time_down"},{name:"序号升序",type:"id_up"},{name:"序号降序",type:"id_down"}],currentProjectID:0,dialog:!1,currentProject:{},previousProject:{},search:{title:"",type:"",description:"",source:"",order:"view_up",authorid:"",type:"",state:"",tag:""},aboutTags:{items:["动画","故事","音乐","硬核","艺术","水"],chips:k({}),selected:[]},url:""}},async created(){this.localuser.islogin==!1&&this.$router.push("/app/account/login"),await this.onPageChange()},setup(){w({title:"我的作品"})},methods:{removetag(s){chips.value.splice(chips.value.indexOf(s),1)},projecttypeProps(s){return{title:s.name,subtitle:s.department}},async onPageChange(s=1){this.url=`/searchapi?search_userid=${this.localuser.user.userid}&search_type=${this.search.type}&search_title=${this.search.title}&search_source=${this.search.source}&search_description=${this.search.description}&search_orderby=${this.search.order}&search_state=${this.search.state}&search_tag=${this.search.tag}`},resetSearch(){this.search={title:"",type:"scratch",description:"",source:"",order:"view_up",authorid:"",state:"public",tag:"",limit:20},this.onPageChange()},openinfo(s,e){this.currentProjectID=s,this.currentProject=e,this.previousProject={...e},this.aboutTags.chips=this.currentProject.tags.map(n=>n.name),this.dialog=!0},pushproject(s,e){h({url:"/project/"+s+"/push",method:"post"}).then(n=>{console.log(n),this.$toast.add({severity:"info",summary:"info",detail:n.message,life:3e3}),this.onPageChange()}).catch(n=>{console.log(n),this.$toast.add({severity:"error",summary:"失败",detail:"失败",life:3e3})})},openedit(s,e){this.$toast.add({severity:"info",summary:"info",detail:`尝试打开${e.type}编辑器并编辑${s}号作品`,life:3e3}),j(s,e.type)},deleteProject(){this.$toast.add({severity:"error",summary:"info",detail:`尝试删除${this.currentProjectID}号作品`,life:3e3}),h({url:"/project/"+this.currentProjectID,method:"delete"}).then(s=>{console.log(s),this.$toast.add({severity:"info",summary:"info",detail:s.message,life:3e3}),this.onPageChange(),this.dialog=!1}).catch(s=>{console.log(s),this.$toast.add({severity:"error",summary:"error",detail:"删除失败",life:3e3})})},SaveProjectsInfo(){this.currentProject.tags=this.aboutTags.chips.map(s=>s),h({url:"/project/"+this.currentProjectID,method:"put",data:this.currentProject}).then(s=>{console.log(s),this.$toast.add({severity:"info",summary:"info",detail:s.message,life:3e3}),this.dialog=!1,this.onPageChange()}).catch(s=>{console.log(s),this.$toast.add({severity:"error",summary:"error",detail:"修改失败",life:3e3})})}}};function R(s,e,n,z,t,i){const y=b;return U(),T(M,null,{default:o(()=>[l(g,null,{default:o(()=>[l(a,{cols:"6"},{default:o(()=>[l(m,{label:"作品名 包含："+t.search.title,modelValue:t.search.title,"onUpdate:modelValue":e[0]||(e[0]=r=>t.search.title=r)},null,8,["label","modelValue"])]),_:1}),l(a,{cols:"6"},{default:o(()=>[l(m,{label:"作品描述 包含："+t.search.description,modelValue:t.search.description,"onUpdate:modelValue":e[1]||(e[1]=r=>t.search.description=r)},null,8,["label","modelValue"])]),_:1}),l(a,{cols:"6"},{default:o(()=>[l(m,{label:"作品内容 包含："+t.search.source,modelValue:t.search.source,"onUpdate:modelValue":e[2]||(e[2]=r=>t.search.source=r)},null,8,["label","modelValue"])]),_:1}),l(a,{cols:"6"},{default:o(()=>[l(m,{"control-variant":"用户ID",label:"用户ID 为："+t.search.authorid,modelValue:t.localuser.user.userid,"onUpdate:modelValue":e[3]||(e[3]=r=>t.localuser.user.userid=r),disabled:""},null,8,["label","modelValue"])]),_:1}),l(a,{cols:"3"},{default:o(()=>[l(d,{modelValue:t.search.order,"onUpdate:modelValue":e[4]||(e[4]=r=>t.search.order=r),items:t.orderitems,"item-title":"name","item-value":"type",label:"排序"},null,8,["modelValue","items"])]),_:1}),l(a,{cols:"3"},{default:o(()=>[l(d,{modelValue:t.search.type,"onUpdate:modelValue":e[5]||(e[5]=r=>t.search.type=r),items:t.typeitems,"item-title":"name","item-value":"type",label:"项目类型"},null,8,["modelValue","items"])]),_:1}),l(a,{cols:"3"},{default:o(()=>[l(d,{modelValue:t.search.state,"onUpdate:modelValue":e[6]||(e[6]=r=>t.search.state=r),items:t.searchstates,"item-title":"state","item-value":"abbr",label:"项目状态"},null,8,["modelValue","items"])]),_:1}),l(a,{cols:"3"},{default:o(()=>[l(E,{label:"标签 为："+t.search.tag,items:["","动画","故事","音乐","硬核","艺术","水"],modelValue:t.search.tag,"onUpdate:modelValue":e[7]||(e[7]=r=>t.search.tag=r)},null,8,["label","modelValue"])]),_:1}),l(a,{cols:"12"},{default:o(()=>[l(u,{color:"primary",variant:"flat",rounded:"xl",onClick:e[8]||(e[8]=r=>i.onPageChange()),"append-icon":"mdi-magnify"},{default:o(()=>e[18]||(e[18]=[p("搜索")])),_:1}),l(u,{color:"",variant:"flat",rounded:"xl",onClick:e[9]||(e[9]=r=>{t.search.order="view_up",t.search.type="",t.search.authorid="",t.search.source="",t.search.description="",t.search.title="",t.search.state="public",i.onPageChange()})},{default:o(()=>e[19]||(e[19]=[p("重置")])),_:1})]),_:1})]),_:1}),e[23]||(e[23]=c("br",null,null,-1)),e[24]||(e[24]=c("br",null,null,-1)),l(y,{url:t.url,actions:[{name:"信息",function:i.openinfo},{name:"编辑",function:i.openedit}]},null,8,["url","actions"]),l(L,{modelValue:t.dialog,"onUpdate:modelValue":e[17]||(e[17]=r=>t.dialog=r),"max-width":"70vw",persistent:"",origin:"center center"},{default:o(()=>[l(I,{"prepend-icon":"mdi-xml",title:"作品信息"},{default:o(()=>[l(D,null,{default:o(()=>[l(g,{dense:""},{default:o(()=>[l(a,{cols:"12",md:"12",sm:"12"},{default:o(()=>[l(m,{label:"标题",required:"",modelValue:t.currentProject.title,"onUpdate:modelValue":e[10]||(e[10]=r=>t.currentProject.title=r),hint:"将会在首页展示"},null,8,["modelValue"])]),_:1}),l(a,{cols:"12",md:"12",sm:"12"},{default:o(()=>[l(N,{hint:"介绍作品类型，玩法，并向对这个作品有帮助的人致谢！",label:"简介",modelValue:t.currentProject.description,"onUpdate:modelValue":e[11]||(e[11]=r=>t.currentProject.description=r)},null,8,["modelValue"])]),_:1}),l(a,{cols:"12",sm:"6"},{default:o(()=>[l(d,{items:["scratch","python","text"],label:"类型",required:"",hint:"不建议你改",modelValue:t.currentProject.type,"onUpdate:modelValue":e[12]||(e[12]=r=>t.currentProject.type=r)},null,8,["modelValue"])]),_:1}),l(a,{cols:"12",sm:"6"},{default:o(()=>[l(d,{modelValue:t.currentProject.state,"onUpdate:modelValue":e[13]||(e[13]=r=>t.currentProject.state=r),items:t.projectstates,"item-title":"state","item-value":"abbr",label:"项目状态",hint:"我们鼓励开源"},null,8,["modelValue","items"])]),_:1}),l(a,{cols:"12"},{default:o(()=>[l(q,{modelValue:t.aboutTags.chips,"onUpdate:modelValue":e[14]||(e[14]=r=>t.aboutTags.chips=r),items:t.aboutTags.items,label:"标签","prepend-icon":"mdi-tag",variant:"solo",chips:"",multiple:""},{selection:o(({attrs:r,item:f,select:P,selected:v})=>[l(J,S(r,{"model-value":v,closable:"",onClick:P,"onClick:close":Q=>i.removetag(f)}),{default:o(()=>[c("strong",null,V(f.name),1),e[20]||(e[20]=p("  ")),e[21]||(e[21]=c("span",null,"(interest)",-1))]),_:2},1040,["model-value","onClick","onClick:close"])]),_:1},8,["modelValue","items"])]),_:1}),l(A,null,{default:o(()=>[l(H,null,{default:o(()=>[l(F,null,{default:o(()=>e[22]||(e[22]=[p("详细数据")])),_:1}),l(G,null,{default:o(()=>[p(V(t.currentProject),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(_),l(B,null,{default:o(()=>[l(u,{color:"error",text:"删除",variant:"tonal",onClick:i.deleteProject},null,8,["onClick"]),l(u,{color:"text",text:"一键推送",variant:"tonal",onClick:e[15]||(e[15]=r=>i.pushproject(t.currentProject.id))}),l(K),l(u,{text:"取消",variant:"plain",onClick:e[16]||(e[16]=r=>t.dialog=!1)}),l(u,{color:"primary",text:"保存",variant:"tonal",onClick:i.SaveProjectsInfo},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const ge=C(O,[["render",R]]);export{ge as default};
