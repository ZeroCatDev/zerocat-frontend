import{_ as P,H as b,G as k,J as u,o as w,c as D,w as l,a as e,a7 as c,a8 as N,K as f,T as V,L as s,a9 as j,M as n,a6 as y,P as T,a3 as I,aa as U}from"./index-CdD9dhXN.js";import{g as B}from"./project-EwLI3TB6.js";import{a as i,V as h}from"./VRow-Bm2JQBg0.js";import{V as E}from"./VTextarea-D-Wi3oGF.js";import{V as x}from"./VSelect-B1Ww8yc9.js";import{V as q,a as S,b as H,c as L,d as A}from"./VExpansionPanels-CB7gNMs2.js";import{V as F}from"./VChip-COrkZB_D.js";import{V as g}from"./VSpacer-DwZJcbk5.js";import{V as G}from"./VDialog-jVfcd0kc.js";import{V as J}from"./VContainer-BTAM09H7.js";/* empty css              */import"./VCheckboxBtn-5l2Tpzup.js";import"./filter-Db-PIaji.js";const K={data(){return{localuser:b,states:[{state:"私密",abbr:"private"},{state:"开源",abbr:"public"}],projectID:this.$route.params.id,project:{},newProjectName:"",tags:{items:["动画","故事","音乐","硬核","艺术","水"],chips:[]},confirmDelete:!1}},async created(){this.localuser.isLogin||this.$router.push("/app/account/login"),await this.fetchProject()},setup(){k({title:"项目设置"})},methods:{removeTag(o){this.tags.chips.splice(this.tags.chips.indexOf(o),1)},async fetchProject(){try{const{username:o,projectname:t}=this.$route.params;this.project=await B(o,t),this.projectID=this.project.id,this.newProjectName=this.project.name,this.tags.chips=this.project.tags.map(p=>p.name)}catch(o){console.error(o),this.$toast.add({severity:"error",summary:"错误",detail:"无法获取项目数据",life:3e3})}},async deleteProject(){try{await u.delete(`/project/${this.projectID}`),this.$toast.add({severity:"info",summary:"成功",detail:"项目已删除",life:3e3}),this.$router.push("/explore")}catch(o){console.error(o),this.$toast.add({severity:"error",summary:"错误",detail:"删除项目失败",life:3e3})}},async saveProject(){this.project.tags=this.tags.chips.map(o=>o);try{const o=(await u.put(`/project/id/${this.projectID}`,this.project)).data;this.$toast.add({severity:o.status,summary:o.message,detail:o.message,life:3e3})}catch(o){console.error(o),this.$toast.add({severity:"error",summary:"错误",detail:"保存项目失败",life:3e3})}},async renameProject(){try{const o=(await u.put(`/project/rename/${this.projectID}`,{newName:this.newProjectName})).data;this.$toast.add({severity:o.status,summary:o.message,detail:o.message,life:3e3})}catch(o){console.error(o),this.$toast.add({severity:"error",summary:"错误",detail:"修改项目名称失败",life:3e3})}},cancel(){this.$router.push("/explore/my")}}};function M(o,t,p,O,r,m){return w(),D(J,null,{default:l(()=>[e(h,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e(c,{label:"标题",required:"",modelValue:r.project.title,"onUpdate:modelValue":t[0]||(t[0]=a=>r.project.title=a),hint:"将会在首页展示"},null,8,["modelValue"])]),_:1}),e(i,{cols:"12"},{default:l(()=>[e(E,{hint:"介绍作品类型，玩法，并向对这个作品有帮助的人致谢！",label:"简介",modelValue:r.project.description,"onUpdate:modelValue":t[1]||(t[1]=a=>r.project.description=a)},null,8,["modelValue"])]),_:1}),e(i,{cols:"12",sm:"6"},{default:l(()=>[e(x,{items:["scratch","python","text"],label:"类型",required:"",hint:"不建议你改",modelValue:r.project.type,"onUpdate:modelValue":t[2]||(t[2]=a=>r.project.type=a)},null,8,["modelValue"])]),_:1}),e(i,{cols:"12",sm:"6"},{default:l(()=>[e(x,{modelValue:r.project.state,"onUpdate:modelValue":t[3]||(t[3]=a=>r.project.state=a),items:r.states,"item-title":"state","item-value":"abbr",label:"项目状态",hint:"我们鼓励开源"},null,8,["modelValue","items"])]),_:1}),e(i,{cols:"12"},{default:l(()=>[e(q,{modelValue:r.tags.chips,"onUpdate:modelValue":t[4]||(t[4]=a=>r.tags.chips=a),items:r.tags.items,label:"标签","prepend-icon":"mdi-tag",variant:"solo",chips:"",multiple:""},{selection:l(({attrs:a,item:d,select:v,selected:C})=>[e(F,N(a,{"model-value":C,closable:"",onClick:v,"onClick:close":R=>m.removeTag(d)}),{default:l(()=>[f("strong",null,V(d.name),1),t[9]||(t[9]=s("  ")),t[10]||(t[10]=f("span",null,"(interest)",-1))]),_:2},1040,["model-value","onClick","onClick:close"])]),_:1},8,["modelValue","items"])]),_:1}),e(S,null,{default:l(()=>[e(H,null,{default:l(()=>[e(L,null,{default:l(()=>t[11]||(t[11]=[s("详细数据")])),_:1}),e(A,null,{default:l(()=>[s(V(r.project),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(j),e(y,null,{default:l(()=>[e(n,{color:"error",text:"删除",variant:"tonal",onClick:t[5]||(t[5]=a=>r.confirmDelete=!0)}),e(g),e(n,{text:"取消",variant:"plain",onClick:m.cancel},null,8,["onClick"]),e(n,{color:"primary",text:"保存",variant:"tonal",onClick:m.saveProject},null,8,["onClick"])]),_:1}),e(j),e(h,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e(c,{label:"项目名称",required:"",modelValue:r.newProjectName,"onUpdate:modelValue":t[6]||(t[6]=a=>r.newProjectName=a),hint:"修改项目名称"},null,8,["modelValue"])]),_:1}),e(i,{cols:"12"},{default:l(()=>[e(n,{color:"primary",text:"修改名称",variant:"tonal",onClick:m.renameProject},null,8,["onClick"])]),_:1})]),_:1}),e(G,{modelValue:r.confirmDelete,"onUpdate:modelValue":t[8]||(t[8]=a=>r.confirmDelete=a),"max-width":"500px"},{default:l(()=>[e(T,null,{default:l(()=>[e(I,{class:"headline"},{default:l(()=>t[12]||(t[12]=[s("确认删除")])),_:1}),e(U,null,{default:l(()=>t[13]||(t[13]=[s("你确定要删除这个项目吗？此操作无法撤销。")])),_:1}),e(y,null,{default:l(()=>[e(g),e(n,{color:"primary",text:"",onClick:t[7]||(t[7]=a=>r.confirmDelete=!1)},{default:l(()=>t[14]||(t[14]=[s("取消")])),_:1}),e(n,{color:"error",text:"",onClick:m.deleteProject},{default:l(()=>t[15]||(t[15]=[s("删除")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const ae=P(K,[["render",M]]);export{ae as default};
