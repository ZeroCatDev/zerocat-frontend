import{a as A,_ as B}from"./Comment-EcLc2zfb.js";import{_ as v}from"./NewProjectList-s5Vn5eHa.js";import{_ as V,H as j,J as p,o as a,e as m,a as e,w as r,R as g,S as F,Q as b,$ as G,L as i,T as n,a0 as J,a1 as K,M as P,G as M,c as h,P as x,a2 as C,a3 as S,a4 as N,K as c,U as T,O as D,a5 as y}from"./index-CdD9dhXN.js";import{V as O}from"./VDialog-jVfcd0kc.js";import{P as R}from"./ProjectRunner-CHwnpsA8.js";import{o as Q}from"./openEdit-AJJkPSPH.js";import{g as z}from"./project-EwLI3TB6.js";import{a as W}from"./user-DmKEWVdi.js";import{a as L,V as X}from"./VRow-Bm2JQBg0.js";import{V as u}from"./VChip-COrkZB_D.js";import{V as Y}from"./VContainer-BTAM09H7.js";import"./VForm-CuOotZ7Z.js";import"./VTextarea-D-Wi3oGF.js";import"./VSpacer-DwZJcbk5.js";/* empty css              */const Z={components:{NewProjectList:v},props:{projectId:{type:Number,required:!0}},data(){return{localuser:j,userinfo:j.user,newProjectListDialog:!1,projectLists:[]}},watch:{projectId:{immediate:!0,handler(s){this.getProjectList(s)}}},methods:{async getProjectList(s){this.projectLists=(await p({url:"/projectlist/check?projectid="+s,method:"get"})).data.data},async addProjectToList(s){await p({url:"/projectlist/add",data:{userid:this.userinfo.id,projectid:this.projectId,listid:s},method:"post"}).then(o=>{this.$toast.add({severity:"info",summary:"info",detail:o.data.message,life:3e3}),this.getProjectList(this.projectId)})},async removeProjectFromList(s){await p({url:"/projectlist/remove",data:{projectid:this.projectId,listid:s},method:"post"}).then(o=>{this.$toast.add({severity:"info",summary:"info",detail:o.data.message,life:3e3}),this.getProjectList(this.projectId)})}}};function $(s,o,f,w,t,d){const _=v;return a(),m(g,null,[e(K,null,{default:r(()=>[(a(!0),m(g,null,F(t.projectLists,l=>(a(),m("div",{key:l.id},[e(b,{"append-icon":l.include==!0?"mdi-minus-circle":"mdi-plus-circle",active:l.include==!0,color:"primary",onClick:I=>l.include==!0?d.removeProjectFromList(l.id):d.addProjectToList(l.id)},{default:r(()=>[e(G,null,{default:r(()=>[i(n(l.title),1)]),_:2},1024),e(J,null,{default:r(()=>[i(n(l.description),1)]),_:2},1024)]),_:2},1032,["append-icon","active","onClick"])]))),128)),e(b,{onClick:o[0]||(o[0]=l=>t.newProjectListDialog=!0)},{default:r(()=>o[2]||(o[2]=[i("新建列表")])),_:1})]),_:1}),e(O,{modelValue:t.newProjectListDialog,"onUpdate:modelValue":o[1]||(o[1]=l=>t.newProjectListDialog=l)},{default:r(()=>[e(_,{listid:s.editlistid,close:()=>t.newProjectListDialog=!1,callback:d.getProjectList},null,8,["listid","close","callback"])]),_:1},8,["modelValue"])],64)}const E=V(Z,[["render",$]]),tt={components:{NewProjectList:v},name:"addtolist",props:{projectId:{type:Number,required:!0}},data(){return{localuser:j,userinfo:j.user,newProjectListDialog:!1,projectLists:"",star:!1,starinfo:{}}},watch:{projectId:{immediate:!0,handler(s){this.getStarStatus(s)}}},methods:{getStarStatus(s){p({url:`/projectlist/checkstar?projectid=${s}`,method:"get"}).then(o=>{this.star=o.data.star,this.starinfo=o.data})},ToggleStarProject(){this.star==0?p({url:"/projectlist/star",method:"post",data:{projectid:this.projectId}}).then(s=>{this.star=s.data.star,this.starinfo.count=Number(this.starinfo.count)+1}):p({url:"/projectlist/unstar",method:"post",data:{projectid:this.projectId}}).then(s=>{this.star=s.data.star,this.starinfo.count=Number(this.starinfo.count)-1})}}};function et(s,o,f,w,t,d){return a(),m(g,null,[e(P,{onClick:o[0]||(o[0]=_=>d.ToggleStarProject()),color:t.star?"yellow":"","prepend-icon":"mdi-star",variant:"tonal"},{default:r(()=>[i("Star "+n(t.starinfo.count),1)]),_:1},8,["color"]),i(n(t.projectLists),1)],64)}const U=V(tt,[["render",et]]),ot={components:{ProjectRunner:R,TimeAgo:A,Comment:B,AddTolist:E,ProjectStar:U},data(){return{projectid:this.$route.params.id,project:{},author:{},openEditor:Q,localuser:j}},async mounted(){this.fetchProjectAndAuthorDetails()},methods:{async fetchProjectAndAuthorDetails(){const s=this.$route.params.username,o=this.$route.params.projectname,f=await z(s,o);this.project=f,this.projectid=this.project.id,M({title:this.project.title}),this.author=await W(this.project.authorid)}}},rt={class:"px-4 d-flex ga-2 mb-2"},st={class:"px-4 d-flex ga-2 mb-2"},it={class:"px-4 d-flex ga-2 mb-2"},lt={class:"px-4 d-flex ga-2 mb-2"},nt={class:"px-4 d-flex ga-2 mb-2"},at={class:"px-4"};function ct(s,o,f,w,t,d){const _=R,l=A,I=U,q=E,H=B;return a(),h(Y,null,{default:r(()=>[e(X,null,{default:r(()=>[e(L,{xs:"12",sm:"12",md:"8",lg:"8",xl:"8",xxl:"8",cols:"12"},{default:r(()=>[e(_,{type:t.project.type,id:t.project.id},null,8,["type","id"])]),_:1}),e(L,{xs:"12",sm:"12",md:"4",lg:"4",xl:"4",xxl:"8",cols:"12"},{default:r(()=>[e(x,{hover:"",border:""},{default:r(()=>[e(C,null,{default:r(()=>[e(S,null,{default:r(()=>[i(n(t.project.title),1)]),_:1}),e(N,null,{default:r(()=>[i(n(t.project.description),1)]),_:1})]),_:1}),c("div",rt,[e(u,{pill:""},{default:r(()=>[e(T,{start:""},{default:r(()=>[e(D,{src:"https://s4-1.wuyuan.1r.ink/user/"+t.author.images},null,8,["src"])]),_:1}),i(n(t.author.display_name),1)]),_:1})]),c("div",st,[e(u,{pill:"","prepend-icon":"mdi-eye"},{default:r(()=>[i(n(t.project.view_count)+"浏览",1)]),_:1}),e(u,{pill:"","prepend-icon":"mdi-clock"},{default:r(()=>[e(l,{date:t.project.time},null,8,["date"])]),_:1})]),c("div",it,[t.project.state=="public"?(a(),h(u,{key:0,pill:"","prepend-icon":"mdi-xml"},{default:r(()=>o[1]||(o[1]=[i("开源作品")])),_:1})):y("",!0),t.project.state=="private"?(a(),h(u,{key:1,pill:"","prepend-icon":"mdi-xml"},{default:r(()=>o[2]||(o[2]=[i("私密作品")])),_:1})):y("",!0),e(u,{pill:"","prepend-icon":"mdi-application"},{default:r(()=>[i(n(t.project.type),1)]),_:1})]),c("div",lt,[(a(!0),m(g,null,F(t.project.tags,k=>(a(),m("div",null,[e(u,null,{default:r(()=>[i(n(k.name),1)]),_:2},1024)]))),256))]),c("div",nt,[e(I,{projectId:t.project.id},null,8,["projectId"]),e(P,{onClick:o[0]||(o[0]=k=>t.openEditor(t.project.id,t.project.type)),variant:"text"},{default:r(()=>o[3]||(o[3]=[i("打开创造页")])),_:1}),t.project.authorid!=t.localuser.user.id?(a(),h(P,{key:0,to:`${t.project.authorid}/${t.projectid}/fork`,variant:"text"},{default:r(()=>o[4]||(o[4]=[i("改编")])),_:1},8,["to"])):y("",!0)]),c("div",at,[e(x,{hover:"",to:"/"+t.author.username,border:""},{default:r(()=>[e(C,null,{prepend:r(()=>[e(T,null,{default:r(()=>[e(D,{alt:t.author.display_name,src:"https://s4-1.wuyuan.1r.ink/user/"+t.author.images},null,8,["alt","src"])]),_:1})]),default:r(()=>[e(S,{class:"text-white"},{default:r(()=>[i(n(t.author.display_name),1)]),_:1}),e(N,{class:"text-white"},{default:r(()=>[i(n(t.author.motto),1)]),_:1})]),_:1})]),_:1},8,["to"])]),o[5]||(o[5]=c("br",null,null,-1))]),_:1}),o[6]||(o[6]=c("br",null,null,-1)),e(x,{hover:"",border:""},{default:r(()=>[e(q,{projectId:t.project.id},null,8,["projectId"])]),_:1})]),_:1}),e(L,{xxl:"8",xl:"8",lg:"8",md:"8",sm:"12",xs:"12",cols:"12"},{default:r(()=>[e(H,{url:"project-"+t.project.id,name:"项目"},null,8,["url"])]),_:1})]),_:1})]),_:1})}const wt=V(ot,[["render",ct]]);export{wt as default};
