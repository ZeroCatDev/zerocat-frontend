import{au as k,z as i,at as w,y as C,a2 as B,a as N,o as V,f as t,w as l,j as p,t as T,a6 as E,ab as M,af as g,av as b,l as j,k as _,v as x,q as z}from"./index-YEMYjwFY.js";import{V as q,a as h}from"./VRow-BsmdIIG5.js";import{V as F}from"./VForm-lvWg1H5t.js";import{V as R}from"./VAlert-77hIazzu.js";/* empty css              */const S={class:"auth-wrapper d-flex align-center justify-center pa-4"},$={__name:"verify",setup(U){const d=k(),u=i(""),r=i(""),o=i(!1),m=i(""),v=i("success"),c={required:a=>!!a||"此字段为必填项",email:a=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)||"请输入有效的邮箱地址",length:a=>(a==null?void 0:a.length)===6||"验证码必须是6位数字"};w(()=>{const a=d.query.email,e=d.query.token;a&&(u.value=a),e&&(r.value=e),a&&e&&y()});const y=async()=>{var a,e;if(!o.value){if(!u.value||!r.value){n("请输入邮箱和验证码","error");return}if(r.value.length!==6){n("验证码必须是6位数字","error");return}o.value=!0,m.value="";try{const s=await C.post("/account/verify-email",{email:u.value,token:r.value});s.data.state==="success"?n(s.data.message||"邮箱验证成功！","success"):n(s.data.message||"邮箱验证失败！","error")}catch(s){n(((e=(a=s.response)==null?void 0:a.data)==null?void 0:e.message)||"验证失败，请重试","error")}finally{o.value=!1}}},n=(a,e="success")=>{m.value=a,v.value=e};return(a,e)=>{const s=B("v-cardtext");return V(),N("div",S,[t(z,{class:"auth-card pa-4 pt-7","max-width":"448",border:"",rounded:"lg"},{default:l(()=>[t(q,null,{default:l(()=>[t(h,{cols:"12"},{default:l(()=>[t(s,null,{default:l(()=>e[2]||(e[2]=[p("h5",{class:"text-h5 font-weight-semibold mb-1"}," 欢迎来到ZeroCatNext！ 👋🏻 ",-1),p("p",{class:"mb-0"},"验证你的邮箱",-1)])),_:1})]),_:1})]),_:1}),t(s,null,{default:l(()=>[t(q,null,{default:l(()=>[t(h,{cols:"12"},{default:l(()=>[t(F,{onSubmit:M(y,["prevent"])},{default:l(()=>[t(g,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=f=>u.value=f),label:"邮箱地址",type:"email",required:"",rules:[c.required,c.email],placeholder:"请输入邮箱地址",variant:"outlined",disabled:b(d).query.email},null,8,["modelValue","rules","disabled"]),t(g,{modelValue:r.value,"onUpdate:modelValue":e[1]||(e[1]=f=>r.value=f),label:"验证码",type:"text",required:"",rules:[c.required,c.length],maxlength:"6",placeholder:"请输入6位验证码",variant:"outlined",disabled:b(d).query.token},null,8,["modelValue","rules","disabled"]),t(j,{type:"submit",loading:o.value,disabled:o.value,color:"primary",size:"large"},{default:l(()=>[_(x(o.value?"验证中...":"验证"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1}),e[3]||(e[3]=p("br",null,null,-1)),m.value?(V(),T(R,{key:0,type:v.value,variant:"tonal"},{default:l(()=>[_(x(m.value),1)]),_:1},8,["type"])):E("",!0)]),_:1})])}}};export{$ as default};
