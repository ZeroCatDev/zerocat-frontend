import{_ as C,aa as k,Y as f,o as i,N as e,e as t,W as _,a9 as p,L as r,O as V,a3 as h,c as y,$ as g,aB as v,Q as B,F as U,U as w,R as Q,aU as b,X as o,aW as S,Z as P,n as z,f as x,S as u,aE as N,i as A,aA as D}from"./index-DnUjCeK2.js";import{V as F}from"./VSpacer-BFiVag9N.js";const I={name:"ProjectSelector",props:{modelValue:{type:Boolean,default:!1},projects:{type:Array,default:()=>[]}},emits:["update:modelValue","select"],data(){return{searchQuery:"",s3BucketUrl:""}},computed:{dialog:{get(){return this.modelValue},set(s){this.$emit("update:modelValue",s)}},filteredProjects(){if(!this.searchQuery)return this.projects;const s=this.searchQuery.toLowerCase();return this.projects.filter(a=>{var c;return(c=a.title)==null?void 0:c.toLowerCase().includes(s)})}},async created(){try{this.s3BucketUrl=await k("s3.staticurl")}catch(s){console.warn("Failed to get s3.staticurl:",s),this.s3BucketUrl=""}},methods:{selectProject(s){this.$emit("select",s)},closeDialog(){this.dialog=!1,this.searchQuery=""},handleSearchUpdate(s){this.searchQuery=s||""}}},L={class:"d-flex flex-wrap ga-1"},T={key:0,class:"text-center py-8"},j={class:"text-h6 mt-4 text-grey-darken-1"};function E(s,a,c,R,n,d){return i(),f(D,{modelValue:d.dialog,"onUpdate:modelValue":a[1]||(a[1]=l=>d.dialog=l),"max-width":"800",scrollable:""},{default:e(()=>[t(_,null,{default:e(()=>[t(p,{class:"d-flex align-center"},{default:e(()=>[t(V,{class:"mr-2"},{default:e(()=>a[2]||(a[2]=[r("mdi-folder-multiple",-1)])),_:1,__:[2]}),a[3]||(a[3]=r(" 选择项目 ",-1))]),_:1,__:[3]}),t(h,{style:{height:"500px"}},{default:e(()=>[t(v,{modelValue:n.searchQuery,"onUpdate:modelValue":[a[0]||(a[0]=l=>n.searchQuery=l),d.handleSearchUpdate],label:"项目名","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:"","hide-details":"",class:"mb-4"},null,8,["modelValue","onUpdate:modelValue"]),t(B,null,{default:e(()=>[(i(!0),y(U,null,w(d.filteredProjects,l=>(i(),f(Q,{key:l.id,cols:"12",sm:"6",md:"4"},{default:e(()=>[t(_,{class:"project-selector-card",variant:"tonal",border:"",hover:"",onClick:m=>d.selectProject(l)},{default:e(()=>[t(b,null,{prepend:e(()=>[t(P,null,{default:e(()=>{var m;return[t(z,{src:n.s3BucketUrl+"/user/"+((m=l.author)==null?void 0:m.avatar)||""},null,8,["src"])]}),_:2},1024)]),default:e(()=>[t(p,{class:"text-subtitle-1"},{default:e(()=>[r(o(l.title),1)]),_:2},1024),t(S,null,{default:e(()=>[r(o(l.description),1)]),_:2},1024)]),_:2},1024),t(h,null,{default:e(()=>[x("div",L,[t(u,{size:"x-small",variant:"tonal"},{default:e(()=>[r(o(l.type),1)]),_:2},1024),l.state==="private"?(i(),f(u,{key:0,size:"x-small",color:"error",variant:"tonal"},{default:e(()=>a[4]||(a[4]=[r(" 私密 ",-1)])),_:1,__:[4]})):g("",!0),t(u,{size:"x-small",variant:"tonal","prepend-icon":"mdi-eye"},{default:e(()=>[r(o(l.view_count||0),1)]),_:2},1024),t(u,{size:"x-small",variant:"tonal","prepend-icon":"mdi-star"},{default:e(()=>[r(o(l.star_count||0),1)]),_:2},1024)])]),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1}),d.filteredProjects.length===0?(i(),y("div",T,[t(V,{size:"64",color:"grey-lighten-1"},{default:e(()=>a[5]||(a[5]=[r("mdi-folder-outline",-1)])),_:1,__:[5]}),x("p",j,o(n.searchQuery?"未找到匹配的项目":"暂无项目"),1)])):g("",!0)]),_:1}),t(N,null,{default:e(()=>[t(F),t(A,{onClick:d.closeDialog},{default:e(()=>a[6]||(a[6]=[r("取消",-1)])),_:1,__:[6]},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}const O=C(I,[["render",E],["__scopeId","data-v-210e4975"]]);export{O as _};
