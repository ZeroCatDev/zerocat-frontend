import{g as I,a as k,r as S,b as F,l as g,D as x}from"./user-BBNnAO5M.js";import{bS as L,o as a,c as d,w as s,a as t,cD as f,O as l,cr as p,cs as V,cj as c,cB as y,A as U,aZ as h,F as v,cm as b,G as N,bc as o,z as Q,cn as _,cG as C,cH as D}from"./index-B2HYbJQK.js";import{V as w}from"./VForm-CBOOA0K3.js";import{V as B}from"./VAlert-BPnH0psq.js";import{V as T}from"./VContainer-WBUV_8zJ.js";import"./db-yuhU7b6o.js";/* empty css              */const A={data(){return{inputValue:"",users:[],status:"",UserID:0,liveQuerySubscription:null,allUsers:[]}},methods:{async fetchUserInfo(){const u=this.inputValue.split(",").map(n=>Number(n.trim())),e=await Promise.all(u.map(n=>I(n)));this.users=e},async addUser(){const u={id:Number(this.UserID),display_name:"测试用户",motto:"这是一个测试",images:[],regTime:new Date().toISOString(),sex:"未知",username:"testuser"};this.status=await k(u)},async removeUser(){this.status=await S(Number(this.UserID)),this.UserID=0},async refreshUser(){this.status=await F(Number(this.UserID))},startLiveFetch(){const u=this.inputValue.split(",").map(e=>Number(e.trim()));this.liveQuerySubscription&&this.liveQuerySubscription.unsubscribe(),this.liveQuerySubscription=g(u,e=>{this.users=e})},startLiveFetchAll(){this.liveQuerySubscription&&this.liveQuerySubscription.unsubscribe(),this.liveQuerySubscription=x(u=>{this.allUsers=u})}},mounted(){this.startLiveFetch(),this.startLiveFetchAll()},beforeDestroy(){this.liveQuerySubscription&&this.liveQuerySubscription.unsubscribe()}},G={class:"d-flex gap-2"};function O(u,e,n,j,i,m){return a(),d(T,null,{default:s(()=>[t(b,{border:""},{default:s(()=>[t(f,null,{default:s(()=>e[2]||(e[2]=[l("实时获取缓存的用户数据")])),_:1}),t(p,null,{default:s(()=>[t(V,{modelValue:i.inputValue,"onUpdate:modelValue":e[0]||(e[0]=r=>i.inputValue=r),label:"输入用户ID",class:"mb-4"},null,8,["modelValue"]),t(c,{onClick:m.fetchUserInfo,color:"primary",class:"mb-4"},{default:s(()=>e[3]||(e[3]=[l("获取用户信息")])),_:1},8,["onClick"]),t(y,null,{default:s(()=>[(a(!0),U(v,null,h(i.users,r=>(a(),d(_,{key:r.id},{default:s(()=>[t(C,null,{default:s(()=>[l(o(r.display_name||"未缓存"),1)]),_:2},1024),t(D,null,{default:s(()=>[l(o(r.motto||""),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),t(b,{class:"mt-4",border:""},{default:s(()=>[t(f,null,{default:s(()=>e[4]||(e[4]=[l("添加缓存的用户数据")])),_:1}),t(p,null,{default:s(()=>[t(w,null,{default:s(()=>[t(V,{modelValue:i.UserID,"onUpdate:modelValue":e[1]||(e[1]=r=>i.UserID=r),label:"用户ID",type:"number",required:""},null,8,["modelValue"]),N("div",G,[t(c,{onClick:m.addUser,color:"primary"},{default:s(()=>e[5]||(e[5]=[l("添加")])),_:1},8,["onClick"]),t(c,{onClick:m.removeUser,color:"error"},{default:s(()=>e[6]||(e[6]=[l("删除")])),_:1},8,["onClick"]),t(c,{onClick:m.refreshUser,color:"info"},{default:s(()=>e[7]||(e[7]=[l("刷新")])),_:1},8,["onClick"])]),i.status?(a(),d(B,{key:0,type:i.status.includes("成功")?"success":"error",class:"mt-4"},{default:s(()=>[l(o(i.status),1)]),_:1},8,["type"])):Q("",!0)]),_:1})]),_:1})]),_:1}),t(b,{class:"mt-4",border:""},{default:s(()=>[t(f,null,{default:s(()=>e[8]||(e[8]=[l("所有缓存的用户数据")])),_:1}),t(p,null,{default:s(()=>[t(y,null,{default:s(()=>[(a(!0),U(v,null,h(i.allUsers,r=>(a(),d(_,{key:r.id},{default:s(()=>[t(C,null,{default:s(()=>[l(o(r.display_name||"未缓存"),1)]),_:2},1024),t(D,null,{default:s(()=>[l(o(r.motto||""),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})}const K=L(A,[["render",O]]);export{K as default};
