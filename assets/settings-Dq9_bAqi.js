import{_ as b,H as y,G as g,J as c,o as C,c as h,w as r,a as t,a5 as v,a6 as T,L as d,W as p,O as a,a7 as k,N as i,a4 as f,R as D,a1 as w,a8 as I}from"./index-C840rCbu.js";import{f as U}from"./project-D8jPl1wg.js";import{a as n,V as S}from"./VRow-C9ulTvU0.js";import{V as B}from"./VTextarea-Bs9IUwVF.js";import{V}from"./VSelect-DqlI71P_.js";import{V as E,a as N,b as q,c as F,d as H}from"./VExpansionPanels-C7Ko9cyZ.js";import{V as O}from"./VChip-CDrc1Zhr.js";import{V as P}from"./VSpacer-BgDWWE4s.js";import{V as R}from"./VDialog-pCMGnecn.js";import{V as A}from"./VContainer-CPhamQLs.js";import"./db-DQHg44Zu.js";/* empty css              */import"./VCheckboxBtn-BGSJ0WSz.js";import"./VSelectionControl-dmOrAC2P.js";import"./filter-C7_eXSl_.js";const G={data(){return{localuser:y,projectstates:[{state:"私密",abbr:"private"},{state:"开源",abbr:"public"}],currentProjectID:this.$route.params.id,currentProject:{},aboutTags:{items:["动画","故事","音乐","硬核","艺术","水"],chips:[]},confirmDelete:!1}},async created(){this.localuser.islogin==!1&&this.$router.push("/app/account/login"),await this.fetchProject()},setup(){g({title:"项目设置"})},methods:{removetag(o){this.aboutTags.chips.splice(this.aboutTags.chips.indexOf(o),1)},async fetchProject(){try{this.currentProject=await U(this.currentProjectID),this.aboutTags.chips=this.currentProject.tags.map(o=>o.name)}catch(o){console.error(o),this.$toast.add({severity:"error",summary:"错误",detail:"无法获取项目数据",life:3e3})}},async deleteProject(){try{await c.delete(`/project/${this.currentProjectID}`),this.$toast.add({severity:"info",summary:"成功",detail:"项目已删除",life:3e3}),this.$router.push("/explore")}catch(o){console.error(o),this.$toast.add({severity:"error",summary:"错误",detail:"删除项目失败",life:3e3})}},async SaveProjectsInfo(){this.currentProject.tags=this.aboutTags.chips.map(o=>o);try{const o=await c.put(`/project/${this.currentProjectID}`,this.currentProject);this.$toast.add({severity:o.status,summary:o.message,detail:o.message,life:3e3})}catch(o){console.error(o),this.$toast.add({severity:"error",summary:"错误",detail:"保存项目失败",life:3e3})}},cancel(){this.$router.push("/explore/my")}}};function J(o,e,L,W,l,u){return C(),h(A,null,{default:r(()=>[t(S,null,{default:r(()=>[t(n,{cols:"12"},{default:r(()=>[t(v,{label:"标题",required:"",modelValue:l.currentProject.title,"onUpdate:modelValue":e[0]||(e[0]=s=>l.currentProject.title=s),hint:"将会在首页展示"},null,8,["modelValue"])]),_:1}),t(n,{cols:"12"},{default:r(()=>[t(B,{hint:"介绍作品类型，玩法，并向对这个作品有帮助的人致谢！",label:"简介",modelValue:l.currentProject.description,"onUpdate:modelValue":e[1]||(e[1]=s=>l.currentProject.description=s)},null,8,["modelValue"])]),_:1}),t(n,{cols:"12",sm:"6"},{default:r(()=>[t(V,{items:["scratch","python","text"],label:"类型",required:"",hint:"不建议你改",modelValue:l.currentProject.type,"onUpdate:modelValue":e[2]||(e[2]=s=>l.currentProject.type=s)},null,8,["modelValue"])]),_:1}),t(n,{cols:"12",sm:"6"},{default:r(()=>[t(V,{modelValue:l.currentProject.state,"onUpdate:modelValue":e[3]||(e[3]=s=>l.currentProject.state=s),items:l.projectstates,"item-title":"state","item-value":"abbr",label:"项目状态",hint:"我们鼓励开源"},null,8,["modelValue","items"])]),_:1}),t(n,{cols:"12"},{default:r(()=>[t(E,{modelValue:l.aboutTags.chips,"onUpdate:modelValue":e[4]||(e[4]=s=>l.aboutTags.chips=s),items:l.aboutTags.items,label:"标签","prepend-icon":"mdi-tag",variant:"solo",chips:"",multiple:""},{selection:r(({attrs:s,item:m,select:j,selected:x})=>[t(O,T(s,{"model-value":x,closable:"",onClick:j,"onClick:close":z=>u.removetag(m)}),{default:r(()=>[d("strong",null,p(m.name),1),e[8]||(e[8]=a("  ")),e[9]||(e[9]=d("span",null,"(interest)",-1))]),_:2},1040,["model-value","onClick","onClick:close"])]),_:1},8,["modelValue","items"])]),_:1}),t(N,null,{default:r(()=>[t(q,null,{default:r(()=>[t(F,null,{default:r(()=>e[10]||(e[10]=[a("详细数据")])),_:1}),t(H,null,{default:r(()=>[a(p(l.currentProject),1)]),_:1})]),_:1})]),_:1})]),_:1}),t(k),t(f,null,{default:r(()=>[t(i,{color:"error",text:"删除",variant:"tonal",onClick:e[5]||(e[5]=s=>l.confirmDelete=!0)}),t(P),t(i,{text:"取消",variant:"plain",onClick:u.cancel},null,8,["onClick"]),t(i,{color:"primary",text:"保存",variant:"tonal",onClick:u.SaveProjectsInfo},null,8,["onClick"])]),_:1}),t(R,{modelValue:l.confirmDelete,"onUpdate:modelValue":e[7]||(e[7]=s=>l.confirmDelete=s),"max-width":"500px"},{default:r(()=>[t(D,null,{default:r(()=>[t(w,{class:"headline"},{default:r(()=>e[11]||(e[11]=[a("确认删除")])),_:1}),t(I,null,{default:r(()=>e[12]||(e[12]=[a("你确定要删除这个项目吗？此操作无法撤销。")])),_:1}),t(f,null,{default:r(()=>[t(P),t(i,{color:"primary",text:"",onClick:e[6]||(e[6]=s=>l.confirmDelete=!1)},{default:r(()=>e[13]||(e[13]=[a("取消")])),_:1}),t(i,{color:"error",text:"",onClick:u.deleteProject},{default:r(()=>e[14]||(e[14]=[a("删除")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const ie=b(G,[["render",J]]);export{ie as default};
