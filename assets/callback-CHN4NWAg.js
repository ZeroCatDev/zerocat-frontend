import{_ as v,b3 as y,r as o,e as g,Y as k,ai as b,U as w,o as r,N as l,M as t,a as i,h as n,$ as V,O as x,K as u,T as f,j as B}from"./index-DKqePUrh.js";import{_ as N}from"./AuthCard-B8eBVh_O.js";import"./VRow-MTxZhg05.js";/* empty css              */const T={class:"oauth-card"},P={key:0,class:"auth-state auth-loading text-center"},z={key:1,class:"auth-state auth-success text-center"},C={class:"text-body-1"},E={key:2,class:"auth-state auth-error text-center"},I={class:"text-body-1"},M={__name:"callback",setup(S){const d=y(),m=o(!0),c=o(!1),p=o(""),_=o("");g(async()=>{try{const s=new URLSearchParams(window.location.search).get("temp_token");if(!s)throw new Error("未找到临时令牌，请重新登录");const e=(await k.get(`/account/oauth/validate-token/${s}`)).data;if(e.status==="success")await b.setUser(e),_.value=e.display_name||e.username,c.value=!0,setTimeout(()=>{d.push("/app/explore")},2e3);else throw new Error(e.message||"令牌验证失败")}catch(a){console.error("验证临时令牌时出错:",a),p.value=a.message||"登录过程中发生错误，请重试",c.value=!1}finally{m.value=!1}});function h(){d.push("/account/login")}return(a,s)=>(r(),w(N,{subtitle:"登录你的账户"},{default:l(()=>[t("div",T,[m.value?(r(),i("div",P,[n(V,{indeterminate:"",color:"primary",size:"64"}),s[0]||(s[0]=t("h3",{class:"text-h6 mt-4"},"验证中...",-1)),s[1]||(s[1]=t("p",{class:"text-body-1"},"正在处理您的登录请求，请稍候",-1))])):c.value?(r(),i("div",z,[n(x,{color:"success",size:"64",class:"mb-4"},{default:l(()=>s[2]||(s[2]=[u(" mdi-check-circle ")])),_:1}),s[3]||(s[3]=t("h3",{class:"text-h6"},"登录成功",-1)),t("p",C,"欢迎回来，"+f(_.value),1),s[4]||(s[4]=t("p",{class:"text-body-2 text-medium-emphasis"},"正在跳转到控制台...",-1))])):(r(),i("div",E,[n(x,{color:"error",size:"64",class:"mb-4"},{default:l(()=>s[5]||(s[5]=[u(" mdi-alert-circle ")])),_:1}),s[7]||(s[7]=t("h3",{class:"text-h6"},"登录失败",-1)),t("p",I,f(p.value),1),n(B,{color:"primary",variant:"text",onClick:h,class:"mt-4"},{default:l(()=>s[6]||(s[6]=[u(" 返回登录 ")])),_:1})]))])]),_:1}))}},D=v(M,[["__scopeId","data-v-d1b5a07f"]]);export{D as default};
