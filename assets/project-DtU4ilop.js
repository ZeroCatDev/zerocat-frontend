import{f as j,a as y,r as h,b as P,l as C}from"./project-mn2o6brF.js";import{_ as v,o as u,c,w as e,a as r,O as s,Z as p,N as n,aa as D,e as I,T as k,S as _,L as S,U as d,$ as N,R as x,ac as L,ad as w}from"./index-Bs7RMKPc.js";import{c as f,a as V,V as b}from"./VCard-BlF6-DPm.js";import{V as F}from"./VForm-dyMEZDDK.js";import{V as T}from"./VAlert-ByXNeVk4.js";import{V as Q}from"./VContainer-BL-qopN5.js";import"./db-ZbHCtT_p.js";/* empty css              */const g={data(){return{inputValue:"",projects:[],status:"",ProjectID:0,liveQuerySubscription:null}},methods:{async fetchProjects(){const o=this.inputValue.split(",").map(m=>Number(m.trim())),t=await j(o);typeof t=="object"&&!Array.isArray(t)?this.projects=[t]:this.projects=t},async addProject(){const o={id:Number(this.ProjectID),title:"测试项目",description:"这是一个测试项目",authorid:1,type:"text",licence:"MIT",state:"public",view_count:0,time:new Date().toISOString(),tags:[],source:"test"};this.status=await y(o)},async removeProject(){this.status=await h(Number(this.ProjectID)),this.ProjectID=0},async refreshProject(){this.status=await P(Number(this.ProjectID))},startLiveFetch(){const o=this.inputValue.split(",").map(t=>Number(t.trim()));this.liveQuerySubscription&&this.liveQuerySubscription.unsubscribe(),this.liveQuerySubscription=C(o,t=>{this.projects=t})}},mounted(){this.startLiveFetch()},beforeDestroy(){this.liveQuerySubscription&&this.liveQuerySubscription.unsubscribe()}},B={class:"d-flex gap-2"};function A(o,t,m,U,i,a){return u(),c(Q,null,{default:e(()=>[r(b,{border:""},{default:e(()=>[r(f,null,{default:e(()=>t[2]||(t[2]=[s("实时获取项目数据")])),_:1}),r(V,null,{default:e(()=>[r(p,{modelValue:i.inputValue,"onUpdate:modelValue":t[0]||(t[0]=l=>i.inputValue=l),label:"输入项目ID",class:"mb-4"},null,8,["modelValue"]),r(n,{onClick:a.startLiveFetch,color:"primary",class:"mb-4"},{default:e(()=>t[3]||(t[3]=[s("实时获取数据")])),_:1},8,["onClick"]),r(D,null,{default:e(()=>[(u(!0),I(_,null,k(i.projects,l=>(u(),c(x,{key:l.id},{default:e(()=>[r(L,null,{default:e(()=>[s(d(l.title||"未缓存"),1)]),_:2},1024),r(w,null,{default:e(()=>[s(d(l.description||""),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),r(b,{class:"mt-4",border:""},{default:e(()=>[r(f,null,{default:e(()=>t[4]||(t[4]=[s("添加项目数据")])),_:1}),r(V,null,{default:e(()=>[r(F,null,{default:e(()=>[r(p,{modelValue:i.ProjectID,"onUpdate:modelValue":t[1]||(t[1]=l=>i.ProjectID=l),label:"项目ID",type:"number",required:""},null,8,["modelValue"]),S("div",B,[r(n,{onClick:a.addProject,color:"primary"},{default:e(()=>t[5]||(t[5]=[s("添加")])),_:1},8,["onClick"]),r(n,{onClick:a.removeProject,color:"error"},{default:e(()=>t[6]||(t[6]=[s("删除")])),_:1},8,["onClick"]),r(n,{onClick:a.refreshProject,color:"info"},{default:e(()=>t[7]||(t[7]=[s("刷新")])),_:1},8,["onClick"])]),i.status?(u(),c(T,{key:0,type:i.status.includes("成功")?"success":"error",class:"mt-4"},{default:e(()=>[s(d(i.status),1)]),_:1},8,["type"])):N("",!0)]),_:1})]),_:1})]),_:1})]),_:1})}const H=v(g,[["render",A]]);export{H as default};
