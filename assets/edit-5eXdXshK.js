import{_ as z}from"./MonacoEditorComponent-CwBfsLOI.js";import{_ as J,c as w,o as h,e as s,Y as v,N as a,ad as b,F as S,U as D,ae as C,af as M,L as d,X as g,O as j,aJ as H,$ as _,a0 as F,aB as L,i as y,aK as P,az as A,m as R,Q as q,R as x,f as p,S as K,a4 as T,aL as W,W as V,a9 as X,aC as E,a3 as k,aA as I,aD as Q,aM as Y,aN as G,aO as Z,aE as N,aP as $,a1 as f}from"./index-Dz-hN2N-.js";import{V as O}from"./VSelect-0_P7mExN.js";import{V as B}from"./VSpacer-CmE8AOMV.js";import{V as ee}from"./VSheet-COv7RByq.js";import{V as te}from"./VTextarea-DaSo0WVx.js";import"https://static.geetest.com/v4/gt4.js";import"./VCheckboxBtn-BYIbfSha.js";import"./VSelectionControl-D2CrIs_u.js";const se={name:"ProjectEditor",components:{MonacoEditorComponent:z},data(){return{project:null,fileContent:null,fileSha256:null,branches:[],currentBranch:"main",commits:[],accessFileToken:"",loading:!0,loadingMessage:"加载项目信息...",codeChanged:!1,errorMessage:"",showSaveDialog:!1,showHistoryDialog:!1,showHistorySidebar:!1,commitMessage:"",commitDescription:"",loadingHistory:!1,showConfirmDialog:!1,showCommitDetails:!1,committing:!1,editorOptions:{theme:"vs-dark",language:"javascript",fontSize:14,tabSize:2,minimap:{enabled:!0},scrollBeyondLastLine:!1,automaticLayout:!0,wordWrap:"on",lineNumbers:"on",glyphMargin:!0,folding:!0,lineDecorationsWidth:10,lineNumbersMinChars:3},showLanguageDialog:!1,languageSearch:"",availableLanguages:[],searchTimeout:null,monacoInstance:null,editorInstance:null,showSidebar:!0,activeTab:"files",navigationItems:[{icon:"mdi-file-document-outline",title:"文件",value:"files"},{icon:"mdi-source-branch",title:"源代码管理",value:"git"},{icon:"mdi-magnify",title:"搜索",value:"search"},{icon:"mdi-cog",title:"设置",value:"settings"}]}},computed:{projectId(){return this.$route.query.id},projectNamespace(){const o=this.$route.params.username||this.$route.query.username,e=this.$route.params.projectname||this.$route.query.projectname;return o&&e?`${o}/${e}`:null},filteredLanguages(){if(!this.languageSearch||!this.availableLanguages)return this.availableLanguages||[];const o=this.languageSearch.toLowerCase().trim();return this.availableLanguages.filter(e=>{const r=e.id.toLowerCase(),n=e.aliases||[];return r.includes(o)||n.some(t=>t.toLowerCase().includes(o))}).slice(0,50)},sidebarTitle(){switch(this.activeTab){case"files":return"资源管理器";case"git":return"源代码管理";case"search":return"搜索";case"settings":return"设置";default:return""}},sidebarIcon(){switch(this.activeTab){case"files":return"mdi-file-document-outline";case"git":return"mdi-source-branch";case"search":return"mdi-magnify";case"settings":return"mdi-cog";default:return""}}},watch:{currentBranch:async function(){this.showHistorySidebar&&await this.loadCommitHistory()},project:async function(o){o&&o.id&&await this.loadCommitHistory()},showLanguageDialog(o){o?this.$nextTick(()=>{var e;(e=this.$refs.languageSearchInput)==null||e.focus()}):this.languageSearch=""}},mounted(){this.loadProject()},methods:{async loadProject(){var o;try{this.loading=!0,this.loadingMessage="加载项目信息...";let e;if(this.projectId)console.log("通过ID加载项目:",this.projectId),e=await f.get(`/project/id/${this.projectId}`);else if(this.projectNamespace){console.log("通过命名空间加载项目:",this.projectNamespace);const[r,n]=this.projectNamespace.split("/");e=await f.get(`/project/namespace/${r}/${n}`)}else throw new Error("未提供项目ID或命名空间");if(console.log("项目加载响应:",e.data),e.data.status==="success"||e.data.id){if(this.project=e.data.data||e.data,!this.project||!this.project.id)throw new Error("项目数据无效: "+JSON.stringify(this.project));await this.loadBranches(),await this.loadLatestCommit()}else throw new Error(e.data.message||"加载项目失败: 服务器未返回有效数据")}catch(e){console.error("加载项目失败:",e);const r=e.response?`服务器错误 (${e.response.status}): ${((o=e.response.data)==null?void 0:o.message)||"未知错误"}`:e.message||"网络错误或服务器无响应";this.loadingMessage=`加载失败: ${r}`,this.errorMessage=r,this.loading=!1}},async loadBranches(){var o;try{this.loadingMessage="加载分支信息...",console.log("加载分支, 项目ID:",this.project.id);const e=await f.get(`/project/branches?projectid=${this.project.id}`);if(console.log("分支加载响应:",e.data),e.data.status==="success")if(this.branches=e.data.data||[],this.branches.length>0)this.currentBranch=this.branches[0].name;else throw new Error("项目没有任何分支");else throw new Error(e.data.message||"加载分支失败: 服务器未返回有效数据")}catch(e){console.error("加载分支失败:",e);const r=e.response?`服务器错误 (${e.response.status}): ${((o=e.response.data)==null?void 0:o.message)||"未知错误"}`:e.message||"网络错误或服务器无响应";this.loadingMessage=`加载分支失败: ${r}`,this.errorMessage=r,this.loading=!1}},async loadLatestCommit(){var o,e,r,n;try{this.loadingMessage="加载最新代码...",console.log("加载最新提交, 项目ID:",this.project.id,"分支:",this.currentBranch);const t=await f.get(`/project/${this.project.id}/${this.currentBranch}/latest`);if(console.log("最新提交响应:",t.data),t.data.status==="success"){if(!t.data.accessFileToken)throw new Error("服务器未返回文件访问令牌");if(this.accessFileToken=t.data.accessFileToken,!t.data.commit)throw new Error("服务器返回的提交数据无效");const l=t.data.commit.commit_file;if(console.log(`获取提交文件: ${l}`),!l){console.log("没有提交文件，创建新文件"),this.fileContent="",this.loading=!1;return}try{const c=await f.get(`/project/files/${l}?accessFileToken=${this.accessFileToken}&content=true`);if(console.log("提交文件响应:",c),c.status===200){let m=c.data;if(!m)console.log("文件内容为空，创建新文件"),this.fileContent="";else{typeof m=="object"&&(m=JSON.stringify(m,null,2)),console.log("获取到文件内容，长度:",m.length),this.fileContent=m,this.fileSha256=l;const i=this.project.name||"file.js";this.editorOptions.language=this.detectLanguage(m,i)}this.loading=!1}else{const m=((o=c.data)==null?void 0:o.message)||"未知错误";console.error(`获取提交文件失败: ${l}`,c.data),this.fileContent="",this.loading=!1}}catch(c){console.error("获取提交文件请求失败:",c),this.fileContent="",this.loading=!1}}else throw new Error(t.data.message||"加载最新提交失败: 服务器未返回有效数据")}catch(t){console.error("加载最新提交失败:",t);const l=t.response?`服务器错误 (${t.response.status}): ${((e=t.response.data)==null?void 0:e.message)||"未知错误"}`:`${t.message||"网络错误或服务器无响应"} [${((n=(r=t.stack)==null?void 0:r.split(`
`)[1])==null?void 0:n.trim())||"未知位置"}]`;this.loadingMessage=`加载最新提交失败: ${l}`,this.errorMessage=l,this.fileContent="",this.loading=!1}},async saveAndCommitCode(){if(this.fileContent===null){alert("文件内容未加载");return}this.showSaveDialog=!0},showCommitDialog(){this.commitMessage="",this.commitDescription="",this.showCommitDetails=!1,this.showSaveDialog=!0},confirmCommit(){this.commitMessage.trim()&&(this.showSaveDialog=!1,this.showConfirmDialog=!0)},async saveAndSubmitCommit(){var o,e;try{if(this.committing=!0,!this.commitMessage.trim()){alert("请输入提交信息");return}let r=this.fileContent,n=!1;try{JSON.parse(r),n=!0,console.log("内容已经是有效的JSON格式")}catch{console.log("内容不是有效的JSON格式，将直接发送"),n=!1}console.log("准备保存文件，内容长度:",r.length);const t=await f.post("/project/savefile?json=false&source=index",n?r:JSON.stringify({index:this.fileContent}),{headers:{"Content-Type":"application/json","X-Project-ID":this.project.id}});if(console.log("保存文件响应:",t.data),t.data.status!=="success")throw new Error(t.data.message||"保存文件失败");if(this.accessFileToken=t.data.accessFileToken,this.fileSha256=t.data.sha256,!this.fileSha256)throw console.error("服务器未返回文件SHA256"),new Error("服务器未返回文件SHA256，无法完成提交");console.log("文件保存成功，使用SHA256:",this.fileSha256),console.log("准备提交代码，分支:",this.currentBranch);const l={branch:this.currentBranch,projectid:this.project.id,accessFileToken:this.accessFileToken,message:this.commitMessage,commit_description:this.commitDescription,commit_file:this.fileSha256};console.log("提交数据:",l);const c=await f.put(`/project/commit/id/${this.project.id}`,l);if(console.log("提交响应:",c.data),c.data.status==="success")this.commitMessage="",this.commitDescription="",this.codeChanged=!1,await this.loadCommitHistory(),alert("代码保存并提交成功"+(n?"":" (已转换为JSON格式)"));else throw new Error(c.data.message||"提交代码失败");this.showConfirmDialog=!1,this.committing=!1}catch(r){console.error("提交失败:",r),alert("提交失败: "+(((e=(o=r.response)==null?void 0:o.data)==null?void 0:e.message)||r.message||"未知错误")),this.committing=!1}},async loadCommitHistory(){if(!this.project||!this.project.id){console.error("项目未加载，无法获取提交历史");return}try{this.loadingHistory=!0;const o=await f.get(`/project/commits?projectid=${this.project.id}&branch=${this.currentBranch}`);o.data.status==="success"?(this.commits=o.data.data||[],this.commits=this.commits.map(e=>({...e,hash:e.hash||"unknown",message:e.message||"无提交信息",date:e.date||new Date().toISOString(),author:e.author||{username:"未知用户"}}))):console.error("加载提交历史失败:",o.data.message)}catch(o){console.error("加载提交历史失败:",o)}finally{this.loadingHistory=!1}},async showHistory(){try{await this.loadCommitHistory(),this.showHistoryDialog=!0}catch(o){console.error("显示历史对话框失败:",o),alert("加载提交历史失败: "+(o.message||"未知错误"))}},async toggleHistorySidebar(){this.showHistorySidebar=!this.showHistorySidebar,this.showHistorySidebar&&this.commits.length===0&&await this.loadCommitHistory()},formatCommitInfo(o){var n;if(!o)return"未知提交信息";const e=((n=o.author)==null?void 0:n.username)||"未知用户",r=o.date?this.formatDate(o.date):"未知时间";return`${e} · ${r}`},async viewCommit(o){var e,r,n,t;if(!o||!o.hash){alert("无效的提交信息");return}try{this.loading=!0,this.loadingMessage="加载提交详情...";const l=await f.get(`/project/commit?projectid=${this.project.id}&commitid=${o.hash}`);if(l.data.status==="success"){this.accessFileToken=l.data.accessFileToken;const c=l.data.commit.commit_file;if(console.log(`获取提交文件: ${c}`),!c){console.log("没有提交文件，创建空文件"),this.fileContent="",this.showHistoryDialog=!1,this.loading=!1;return}try{const m=await f.get(`/project/files/${c}?accessFileToken=${this.accessFileToken}&content=true`);if(m.status===200){let i=m.data;if(!i)console.log("文件内容为空，创建新文件"),this.fileContent="";else{typeof i=="object"&&(i=JSON.stringify(i,null,2)),console.log("获取到文件内容，长度:",i.length),this.fileContent=i,this.fileSha256=c;const u=this.project.name||"file.js";this.editorOptions.language=this.detectLanguage(i,u)}this.showHistoryDialog=!1,this.loading=!1}else{const i=((e=m.data)==null?void 0:e.message)||"未知错误";console.error(`获取提交文件失败: ${c}`,m.data),this.fileContent="",this.showHistoryDialog=!1,this.loading=!1}}catch(m){console.error("获取提交文件请求失败:",m),this.fileContent="",this.showHistoryDialog=!1,this.loading=!1}}else throw new Error(l.data.message||"加载提交详情失败")}catch(l){console.error("加载提交详情失败:",l);const c=l.response?`服务器错误 (${l.response.status}): ${((r=l.response.data)==null?void 0:r.message)||"未知错误"}`:`${l.message||"网络错误或服务器无响应"} [${((t=(n=l.stack)==null?void 0:n.split(`
`)[1])==null?void 0:t.trim())||"未知位置"}]`;alert("加载提交详情失败: "+c),this.loading=!1}},async restoreCommit(o){var r,n;if(!o||!o.hash){alert("无效的提交信息");return}const e=o.hash.substring(0,7);if(confirm(`确定要恢复到提交 ${e} 的状态吗？`))try{this.loading=!0,this.loadingMessage="恢复提交...",await this.viewCommit(o);const t=await f.put(`/project/commit/id/${this.project.id}`,{branch:this.currentBranch,projectid:this.project.id,accessFileToken:this.accessFileToken,message:`恢复到提交 ${e}`,commit_description:`恢复到提交 ${o.hash}，原提交信息: ${o.message||"无提交信息"}`,commit_file:this.fileSha256});if(t.data.status==="success")alert("代码恢复成功"),await this.loadCommitHistory();else throw new Error(t.data.message||"恢复代码失败")}catch(t){console.error("恢复代码失败:",t),alert("恢复代码失败: "+(((n=(r=t.response)==null?void 0:r.data)==null?void 0:n.message)||t.message||"未知错误"))}finally{this.loading=!1}},async switchBranch(){this.codeChanged?confirm("您有未保存的更改，是否切换分支？")?(await this.loadLatestCommit(),this.codeChanged=!1):this.currentBranch=this.branches.find(o=>o.name===this.currentBranch).name:await this.loadLatestCommit()},goToProjectPage(){this.project&&this.$router.push(`/${this.project.author.username}/${this.project.name}`)},formatDate(o){return new Date(o).toLocaleString()},async retryLoading(){this.errorMessage="",this.loading=!0,this.loadingMessage="重新加载项目...";try{await this.loadProject()}catch(o){this.errorMessage=o.message||"加载失败，请稍后再试"}},handleMonacoReady({monaco:o,editor:e,availableLanguages:r}){var n;if(console.log("Monaco editor ready"),this.monacoInstance=o,this.editorInstance=e,this.availableLanguages=r,(n=this.project)!=null&&n.type){const t=this.project.type.split("-")[0].toLowerCase(),l=this.availableLanguages.find(c=>c.id===t);l&&(console.log("根据项目类型设置语言:",l.id),this.editorOptions.language=l.id,this.editorInstance.getModel()&&this.monacoInstance.editor.setModelLanguage(this.editorInstance.getModel(),l.id))}},detectLanguage(o,e){var r,n;if((r=this.project)!=null&&r.type&&((n=this.availableLanguages)==null?void 0:n.length)>0){const t=this.project.type.split("-")[0].toLowerCase(),l=this.availableLanguages.find(c=>c.id===t);if(l)return l.id}try{return JSON.parse(o),"json"}catch{if(e){const l=e.split(".").pop().toLowerCase();return{js:"javascript",ts:"typescript",html:"html",css:"css",scss:"scss",less:"less",vue:"html",json:"json",md:"markdown",py:"python",java:"java",c:"c",cpp:"cpp",cs:"csharp",go:"go",php:"php",rb:"ruby",rs:"rust",sh:"shell",sql:"sql",xml:"xml",yaml:"yaml",yml:"yaml"}[l]||"plaintext"}}return"plaintext"},debounceSearch(o){this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.languageSearch=o.target.value},300)},selectLanguage(o){this.editorOptions.language=o,this.showLanguageDialog=!1,this.languageSearch=""}}},ae={class:"project-editor"},oe={key:0},ie={class:"text-caption"},le={key:0,style:{height:"100% !important",width:"100% !important"}},re={key:0,class:"pa-4 text-center text-body-2"},ne={class:"d-flex align-center mb-4"},ce={class:"text-h6"},de={key:0,class:"mb-4"},me={class:"d-flex align-center"},ue={class:"text-body-2"},he={class:"d-flex align-center mb-4"},ge={class:"text-body-1 mb-2"},pe={key:0,class:"text-body-2 text-grey"},fe={class:"text-body-1 mt-4"};function ye(o,e,r,n,t,l){var m;const c=z;return h(),w("div",ae,[s(H,{permanent:"",rail:""},{default:a(()=>[s(b,null,{default:a(()=>[(h(!0),w(S,null,D(t.navigationItems,(i,u)=>(h(),v(C,{key:u,value:i.value,active:t.activeTab===i.value,onClick:U=>t.activeTab=i.value},{prepend:a(()=>[s(j,null,{default:a(()=>[d(g(i.icon),1)]),_:2},1024)]),default:a(()=>[s(M,null,{default:a(()=>[d(g(i.title),1)]),_:2},1024)]),_:2},1032,["value","active","onClick"]))),128))]),_:1})]),_:1}),s(H,{permanent:""},{default:a(()=>[s(b,null,{default:a(()=>[s(C,{title:l.sidebarTitle,"prepend-icon":l.sidebarIcon},null,8,["title","prepend-icon"])]),_:1}),s(F),t.activeTab==="files"?(h(),v(b,{key:0},{default:a(()=>[s(C,null,{default:a(()=>[s(L,{density:"compact","hide-details":"",placeholder:"搜索文件...","prepend-inner-icon":"mdi-magnify",variant:"solo-filled"})]),_:1})]),_:1})):_("",!0),t.activeTab==="git"?(h(),v(b,{key:1},{default:a(()=>[s(C,null,{default:a(()=>[s(O,{modelValue:t.currentBranch,"onUpdate:modelValue":[e[0]||(e[0]=i=>t.currentBranch=i),l.switchBranch],items:t.branches.map(i=>i.name),density:"compact","hide-details":"",label:"当前分支","prepend-inner-icon":"mdi-source-branch",variant:"solo-filled"},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),t.codeChanged?(h(),v(C,{key:0,"prepend-icon":"mdi-source-commit",title:"更改",subtitle:"有未保存的更改"},{append:a(()=>[s(y,{color:"primary",size:"small",onClick:l.saveAndCommitCode},{default:a(()=>e[16]||(e[16]=[d(" 提交 ",-1)])),_:1,__:[16]},8,["onClick"])]),_:1})):_("",!0),s(F),s(P,null,{default:a(()=>e[17]||(e[17]=[d("提交历史",-1)])),_:1,__:[17]}),(h(!0),w(S,null,D(t.commits,i=>(h(),v(C,{key:i.hash,subtitle:l.formatCommitInfo(i),title:i.message||"无提交信息",lines:"two"},{prepend:a(()=>[s(j,{size:"small"},{default:a(()=>e[18]||(e[18]=[d("mdi-source-commit",-1)])),_:1,__:[18]})]),append:a(()=>[s(A,{location:"end"},{activator:a(({props:u})=>[s(y,R({icon:"mdi-dots-vertical",size:"small",variant:"text"},{ref_for:!0},u),null,16)]),default:a(()=>[s(b,null,{default:a(()=>[s(C,{onClick:u=>l.viewCommit(i)},{default:a(()=>[s(M,null,{default:a(()=>e[19]||(e[19]=[d("查看",-1)])),_:1,__:[19]})]),_:2},1032,["onClick"]),s(C,{onClick:u=>l.restoreCommit(i)},{default:a(()=>[s(M,null,{default:a(()=>e[20]||(e[20]=[d("恢复",-1)])),_:1,__:[20]})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["subtitle","title"]))),128))]),_:1})):_("",!0)]),_:1}),s(W,{class:"editor-app-bar",density:"compact",flat:""},{default:a(()=>[s(q,{align:"center","no-gutters":""},{default:a(()=>[s(x,{class:"mr-4",cols:"auto"},{default:a(()=>[t.project?(h(),w("div",oe,[s(K,{class:"mr-2",color:"primary",size:"small"},{default:a(()=>[s(j,{size:"small",start:""},{default:a(()=>e[21]||(e[21]=[d("mdi-source-repository",-1)])),_:1,__:[21]}),d(" "+g(t.project.title),1)]),_:1}),p("span",ie,g(t.project.author.username)+"/"+g(t.project.name),1)])):(h(),v(T,{key:1,indeterminate:"",size:"20",width:"2"}))]),_:1}),s(B),s(x,{cols:"auto"},{default:a(()=>[s(O,{modelValue:t.currentBranch,"onUpdate:modelValue":[e[1]||(e[1]=i=>t.currentBranch=i),l.switchBranch],items:t.branches.map(i=>i.name),class:"branch-selector",density:"compact","hide-details":"","prepend-inner-icon":"mdi-source-branch",style:{"max-width":"150px"},variant:"outlined"},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),s(x,{class:"d-flex",cols:"auto"},{default:a(()=>[s(y,{class:"ml-2",color:"info","prepend-icon":"mdi-code-tags",size:"small",variant:"text",onClick:e[2]||(e[2]=i=>t.showLanguageDialog=!0)},{default:a(()=>[d(g(t.editorOptions.language),1)]),_:1}),s(y,{class:"ml-2",color:t.codeChanged?"warning":"success","prepend-icon":"mdi-source-commit",size:"small",variant:"text",onClick:l.showCommitDialog},{default:a(()=>[d(g(t.codeChanged?"有更改待提交":"无更改")+" ",1),s(j,{end:"",size:"small"},{default:a(()=>[d(g(t.codeChanged?"mdi-circle-medium":"mdi-check"),1)]),_:1})]),_:1},8,["color","onClick"]),s(y,{class:"ml-2","prepend-icon":"mdi-arrow-left",size:"small",variant:"text",onClick:l.goToProjectPage},{default:a(()=>e[22]||(e[22]=[d(" 项目页面 ",-1)])),_:1,__:[22]},8,["onClick"])]),_:1})]),_:1})]),_:1}),t.fileContent!==null?(h(),w("div",le,[s(c,{modelValue:t.fileContent,"onUpdate:modelValue":e[3]||(e[3]=i=>t.fileContent=i),language:t.editorOptions.language,options:t.editorOptions,"project-type":((m=t.project)==null?void 0:m.type)||"",onChange:e[4]||(e[4]=i=>t.codeChanged=!0),onMonacoReady:l.handleMonacoReady},null,8,["modelValue","language","options","project-type","onMonacoReady"])])):(h(),v(ee,{key:1,class:"d-flex align-center justify-center"},{default:a(()=>[s(T,{color:"primary",indeterminate:""}),e[23]||(e[23]=p("span",{class:"ml-2"},"加载中...",-1))]),_:1,__:[23]})),s(I,{modelValue:t.showLanguageDialog,"onUpdate:modelValue":e[7]||(e[7]=i=>t.showLanguageDialog=i),"max-width":"400"},{default:a(()=>[s(V,null,{default:a(()=>[s(X,{class:"pa-4"},{default:a(()=>[s(L,{modelValue:t.languageSearch,"onUpdate:modelValue":e[5]||(e[5]=i=>t.languageSearch=i),ref:"languageSearchInput","append-inner-icon":"mdi-magnify",label:"选择编程语言",placeholder:"搜索语言...",variant:"outlined",density:"compact","hide-details":"",onKeydown:e[6]||(e[6]=E(i=>t.showLanguageDialog=!1,["esc"])),onInput:l.debounceSearch},null,8,["modelValue","onInput"])]),_:1}),s(k,{class:"language-list pa-0"},{default:a(()=>[s(b,{density:"compact",nav:""},{default:a(()=>[(h(!0),w(S,null,D(l.filteredLanguages,i=>{var u;return h(),v(C,{key:i.id,active:t.editorOptions.language===i.id,title:((u=i.aliases)==null?void 0:u[0])||i.id,subtitle:i.id,onClick:U=>l.selectLanguage(i.id)},{prepend:a(()=>[s(j,{size:"small"},{default:a(()=>e[24]||(e[24]=[d("mdi-code-braces",-1)])),_:1,__:[24]})]),_:2},1032,["active","title","subtitle","onClick"])}),128))]),_:1}),l.filteredLanguages.length===0?(h(),w("div",re," 未找到匹配的语言 ")):_("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(I,{modelValue:t.showSaveDialog,"onUpdate:modelValue":e[12]||(e[12]=i=>t.showSaveDialog=i),"max-width":"500"},{default:a(()=>[s(V,null,{default:a(()=>[s(k,{class:"pa-4"},{default:a(()=>{var i;return[p("div",ne,[s(j,{color:"primary",class:"mr-2"},{default:a(()=>e[25]||(e[25]=[d("mdi-source-repository",-1)])),_:1,__:[25]}),p("span",ce,g(((i=t.project)==null?void 0:i.title)||"项目"),1)]),t.codeChanged?(h(),w("div",de,[e[27]||(e[27]=p("div",{class:"text-subtitle-2 mb-2"},"更改",-1)),s(V,{variant:"outlined",class:"pa-2"},{default:a(()=>{var u;return[p("div",me,[s(j,{size:"small",color:"warning",class:"mr-2"},{default:a(()=>e[26]||(e[26]=[d("mdi-file-document",-1)])),_:1,__:[26]}),p("span",ue,"已修改: "+g((u=t.project)==null?void 0:u.name),1)])]}),_:1})])):_("",!0),s(L,{modelValue:t.commitMessage,"onUpdate:modelValue":e[8]||(e[8]=u=>t.commitMessage=u),label:"提交信息 (按 Ctrl+Enter 提交)",placeholder:"输入提交信息...",variant:"outlined",density:"comfortable","hide-details":"",class:"mb-2",onKeydown:E(Q(l.confirmCommit,["ctrl"]),["enter"])},null,8,["modelValue","onKeydown"]),s(Y,null,{default:a(()=>[G(p("div",null,[s(te,{modelValue:t.commitDescription,"onUpdate:modelValue":e[9]||(e[9]=u=>t.commitDescription=u),label:"详细描述",placeholder:"输入详细的提交说明（可选）...",variant:"outlined",density:"comfortable",rows:"3","hide-details":"",class:"mt-2"},null,8,["modelValue"])],512),[[Z,t.showCommitDetails]])]),_:1}),s(y,{variant:"text",density:"comfortable",class:"mt-2",onClick:e[10]||(e[10]=u=>t.showCommitDetails=!t.showCommitDetails)},{default:a(()=>[d(g(t.showCommitDetails?"隐藏详细信息":"添加详细信息..."),1)]),_:1})]}),_:1}),s(N,{class:"pa-4 pt-0"},{default:a(()=>[s(B),s(y,{variant:"text",onClick:e[11]||(e[11]=i=>t.showSaveDialog=!1)},{default:a(()=>e[28]||(e[28]=[d(" 取消 ",-1)])),_:1,__:[28]}),s(y,{color:"primary",disabled:!t.commitMessage.trim(),loading:t.committing,onClick:l.confirmCommit},{default:a(()=>e[29]||(e[29]=[d(" 提交更改 ",-1)])),_:1,__:[29]},8,["disabled","loading","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(I,{modelValue:t.showConfirmDialog,"onUpdate:modelValue":e[14]||(e[14]=i=>t.showConfirmDialog=i),"max-width":"400"},{default:a(()=>[s(V,null,{default:a(()=>[s(k,{class:"pa-4"},{default:a(()=>[p("div",he,[s(j,{color:"warning",class:"mr-2"},{default:a(()=>e[30]||(e[30]=[d("mdi-alert",-1)])),_:1,__:[30]}),e[31]||(e[31]=p("span",{class:"text-h6"},"确认提交",-1))]),e[32]||(e[32]=p("p",null,"确定要提交以下更改吗？",-1)),s(V,{variant:"outlined",class:"pa-2 mt-2"},{default:a(()=>[p("p",ge,g(t.commitMessage),1),t.commitDescription?(h(),w("p",pe,g(t.commitDescription),1)):_("",!0)]),_:1})]),_:1,__:[32]}),s(N,{class:"pa-4 pt-0"},{default:a(()=>[s(B),s(y,{variant:"text",onClick:e[13]||(e[13]=i=>t.showConfirmDialog=!1)},{default:a(()=>e[33]||(e[33]=[d(" 取消 ",-1)])),_:1,__:[33]}),s(y,{color:"primary",loading:t.committing,onClick:l.saveAndSubmitCommit},{default:a(()=>e[34]||(e[34]=[d(" 确认提交 ",-1)])),_:1,__:[34]},8,["loading","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s($,{modelValue:t.loading,"onUpdate:modelValue":e[15]||(e[15]=i=>t.loading=i),class:"align-center justify-center",persistent:""},{default:a(()=>[s(V,{width:"300"},{default:a(()=>[s(k,{class:"text-center"},{default:a(()=>[s(T,{color:"primary",indeterminate:"",size:"64"}),p("div",fe,g(t.loadingMessage),1)]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const De=J(se,[["render",ye],["__scopeId","data-v-09d4e72a"]]);export{De as default};
