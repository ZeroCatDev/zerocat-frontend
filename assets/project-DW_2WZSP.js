import{P as y}from"./Projects-ChENF8QP.js";import{_ as C,H as c,I as x,G as w,J as h,o as k,c as U,w as o,a as l,ae as u,M as n,L as m,K as p,P as T,a6 as I,a1 as D,T as g,$ as S,ad as _}from"./index-CHN-pFtd.js";import{a,V as b}from"./VRow-CP2tYKl0.js";import{V as d}from"./VSelect-BgwVjHCW.js";import{V as B}from"./VAutocomplete-C__ldeg0.js";import{V as E}from"./VTextarea-Vii6QgzJ.js";import{V as N,d as q,a as A,b as H,c as L}from"./VExpansionPanels-DFKrX7Z_.js";import{V as F}from"./VChip-B3m7v25f.js";import{V as G}from"./VSpacer-Df9EUCxP.js";import{V as J}from"./VDialog-DDl0Exc4.js";import{V as K}from"./VContainer-W9v2uDDY.js";import"./showProjects-BsrQ4Op1.js";import"./project-BWmgHGXU.js";import"./user-ixg84SQ4.js";import"./43-lazyload-CBkwrR6M.js";import"./VPagination-BdEaSEKB.js";/* empty css              */import"./VCheckboxBtn-BLAQ4H1W.js";import"./VSelectionControl-C11yaYQY.js";import"./filter-BAteePpY.js";const M={components:{Projects:y},data(){return{localuser:c,projectstates:[{state:"私密",abbr:"private"},{state:"公开",abbr:"public"}],projecthistory:[{state:"关闭",abbr:"0"},{state:"开启",abbr:"1"}],searchstates:[{state:"所有",abbr:""},{state:"私密",abbr:"private"},{state:"公开",abbr:"public"}],typeitems:[{name:"所有",type:""},{name:"Scratch",type:"scratch"},{name:"Python",type:"python"}],orderitems:[{name:"观看量升序",type:"view_up"},{name:"观看量降序",type:"view_down"},{name:"时间升序",type:"time_up"},{name:"时间降序",type:"time_down"},{name:"序号升序",type:"id_up"},{name:"序号降序",type:"id_down"}],currentProjectID:0,dialog:!1,currentProject:{},previousProject:{},search:{title:"",type:"",description:"",source:"",order:"view_up",authorid:"",type:"",state:"",tag:""},aboutTags:{items:["动画","故事","音乐","硬核","艺术","水"],chips:x({}),selected:[]},url:""}},async created(){c.isLogin.value===!1&&this.$router.push("/app/account/login"),await this.onPageChange()},setup(){w({title:"我的作品"})},methods:{removetag(s){chips.value.splice(chips.value.indexOf(s),1)},projecttypeProps(s){return{title:s.name,subtitle:s.department}},async onPageChange(s=1){this.url=`/searchapi?search_userid=${c.user.value.id}&search_type=${this.search.type}&search_title=${this.search.title}&search_source=${this.search.source}&search_description=${this.search.description}&search_orderby=${this.search.order}&search_state=${this.search.state}&search_tag=${this.search.tag}`},resetSearch(){this.search={title:"",type:"scratch",description:"",source:"",order:"view_up",authorid:"",state:"public",tag:"",limit:20},this.onPageChange()},openinfo(s,e){this.currentProjectID=s,this.currentProject=e,this.previousProject={...e},this.aboutTags.chips=this.currentProject.tags.map(V=>V.name),this.dialog=!0},async pushproject(s){try{const e=await h.post(`/project/${s}/push`);console.log(e.data),this.$toast.add({severity:"info",summary:"info",detail:e.data.message,life:3e3}),this.onPageChange()}catch(e){console.log(e),this.$toast.add({severity:"error",summary:"失败",detail:"失败",life:3e3})}},async deleteProject(){try{const s=await h.delete(`/project/edit/${this.currentProjectID}`);console.log(s.data),this.$toast.add({severity:"info",summary:"info",detail:s.data.message,life:3e3}),this.onPageChange(),this.dialog=!1}catch(s){console.log(s),this.$toast.add({severity:"error",summary:"error",detail:"删除失败",life:3e3})}},async SaveProjectsInfo(){this.currentProject.tags=this.aboutTags.chips.map(s=>s);try{const s=await h.put(`/project/id/${this.currentProjectID}`,this.currentProject);console.log(s.data),this.$toast.add({severity:"info",summary:"info",detail:s.data.message,life:3e3}),this.dialog=!1,this.onPageChange()}catch(s){console.log(s),this.$toast.add({severity:"error",summary:"error",detail:"修改失败",life:3e3})}}}};function O(s,e,V,R,t,i){const v=y;return k(),U(K,null,{default:o(()=>[l(b,null,{default:o(()=>[l(a,{cols:"6"},{default:o(()=>[l(u,{label:"作品名 包含："+t.search.title,modelValue:t.search.title,"onUpdate:modelValue":e[0]||(e[0]=r=>t.search.title=r)},null,8,["label","modelValue"])]),_:1}),l(a,{cols:"6"},{default:o(()=>[l(u,{label:"作品描述 包含："+t.search.description,modelValue:t.search.description,"onUpdate:modelValue":e[1]||(e[1]=r=>t.search.description=r)},null,8,["label","modelValue"])]),_:1}),l(a,{cols:"6"},{default:o(()=>[l(u,{label:"作品内容 包含："+t.search.source,modelValue:t.search.source,"onUpdate:modelValue":e[2]||(e[2]=r=>t.search.source=r)},null,8,["label","modelValue"])]),_:1}),l(a,{cols:"6"},{default:o(()=>[l(u,{"control-variant":"用户ID",label:"用户ID 为："+t.search.authorid,modelValue:t.localuser.user.id,"onUpdate:modelValue":e[3]||(e[3]=r=>t.localuser.user.id=r),disabled:""},null,8,["label","modelValue"])]),_:1}),l(a,{cols:"3"},{default:o(()=>[l(d,{modelValue:t.search.order,"onUpdate:modelValue":e[4]||(e[4]=r=>t.search.order=r),items:t.orderitems,"item-title":"name","item-value":"type",label:"排序"},null,8,["modelValue","items"])]),_:1}),l(a,{cols:"3"},{default:o(()=>[l(d,{modelValue:t.search.type,"onUpdate:modelValue":e[5]||(e[5]=r=>t.search.type=r),items:t.typeitems,"item-title":"name","item-value":"type",label:"项目类型"},null,8,["modelValue","items"])]),_:1}),l(a,{cols:"3"},{default:o(()=>[l(d,{modelValue:t.search.state,"onUpdate:modelValue":e[6]||(e[6]=r=>t.search.state=r),items:t.searchstates,"item-title":"state","item-value":"abbr",label:"项目状态"},null,8,["modelValue","items"])]),_:1}),l(a,{cols:"3"},{default:o(()=>[l(B,{label:"标签 为："+t.search.tag,items:["","动画","故事","音乐","硬核","艺术","水"],modelValue:t.search.tag,"onUpdate:modelValue":e[7]||(e[7]=r=>t.search.tag=r)},null,8,["label","modelValue"])]),_:1}),l(a,{cols:"12"},{default:o(()=>[l(n,{color:"primary",variant:"flat",rounded:"xl",onClick:e[8]||(e[8]=r=>i.onPageChange()),"append-icon":"mdi-magnify"},{default:o(()=>e[18]||(e[18]=[m("搜索")])),_:1}),l(n,{color:"",variant:"flat",rounded:"xl",onClick:e[9]||(e[9]=r=>{t.search.order="view_up",t.search.type="",t.search.authorid="",t.search.source="",t.search.description="",t.search.title="",t.search.state="public",i.onPageChange()})},{default:o(()=>e[19]||(e[19]=[m("重置")])),_:1})]),_:1})]),_:1}),e[23]||(e[23]=p("br",null,null,-1)),e[24]||(e[24]=p("br",null,null,-1)),l(v,{url:t.url,actions:[{name:"信息",function:i.openinfo},{name:"编辑",function:s.openedit}]},null,8,["url","actions"]),l(J,{modelValue:t.dialog,"onUpdate:modelValue":e[17]||(e[17]=r=>t.dialog=r),"max-width":"70vw",persistent:"",origin:"center center"},{default:o(()=>[l(T,{"prepend-icon":"mdi-xml",title:"作品信息"},{default:o(()=>[l(I,null,{default:o(()=>[l(b,{dense:""},{default:o(()=>[l(a,{cols:"12",md:"12",sm:"12"},{default:o(()=>[l(u,{label:"标题",required:"",modelValue:t.currentProject.title,"onUpdate:modelValue":e[10]||(e[10]=r=>t.currentProject.title=r),hint:"将会在首页展示"},null,8,["modelValue"])]),_:1}),l(a,{cols:"12",md:"12",sm:"12"},{default:o(()=>[l(E,{hint:"介绍作品类型，玩法，并向对这个作品有帮助的人致谢！",label:"简介",modelValue:t.currentProject.description,"onUpdate:modelValue":e[11]||(e[11]=r=>t.currentProject.description=r)},null,8,["modelValue"])]),_:1}),l(a,{cols:"12",sm:"6"},{default:o(()=>[l(d,{items:["scratch","python","text"],label:"类型",required:"",hint:"不建议你改",modelValue:t.currentProject.type,"onUpdate:modelValue":e[12]||(e[12]=r=>t.currentProject.type=r)},null,8,["modelValue"])]),_:1}),l(a,{cols:"12",sm:"6"},{default:o(()=>[l(d,{modelValue:t.currentProject.state,"onUpdate:modelValue":e[13]||(e[13]=r=>t.currentProject.state=r),items:t.projectstates,"item-title":"state","item-value":"abbr",label:"项目状态",hint:"我们鼓励开源"},null,8,["modelValue","items"])]),_:1}),l(a,{cols:"12"},{default:o(()=>[l(N,{modelValue:t.aboutTags.chips,"onUpdate:modelValue":e[14]||(e[14]=r=>t.aboutTags.chips=r),items:t.aboutTags.items,label:"标签","prepend-icon":"mdi-tag",variant:"solo",chips:"",multiple:""},{selection:o(({attrs:r,item:f,select:P,selected:j})=>[l(F,D(r,{"model-value":j,closable:"",onClick:P,"onClick:close":z=>i.removetag(f)}),{default:o(()=>[p("strong",null,g(f.name),1),e[20]||(e[20]=m("  ")),e[21]||(e[21]=p("span",null,"(interest)",-1))]),_:2},1040,["model-value","onClick","onClick:close"])]),_:1},8,["modelValue","items"])]),_:1}),l(q,null,{default:o(()=>[l(A,null,{default:o(()=>[l(H,null,{default:o(()=>e[22]||(e[22]=[m("详细数据")])),_:1}),l(L,null,{default:o(()=>[m(g(t.currentProject),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(S),l(_,null,{default:o(()=>[l(n,{color:"error",text:"删除",variant:"tonal",onClick:i.deleteProject},null,8,["onClick"]),l(n,{color:"text",text:"一键推送",variant:"tonal",onClick:e[15]||(e[15]=r=>i.pushproject(t.currentProject.id))}),l(G),l(n,{text:"取消",variant:"plain",onClick:e[16]||(e[16]=r=>t.dialog=!1)}),l(n,{color:"primary",text:"保存",variant:"tonal",onClick:i.SaveProjectsInfo},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const he=C(M,[["render",O]]);export{he as default};
