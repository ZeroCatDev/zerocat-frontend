import{d as r,l as c}from"./db-Cs7zQz_4.js";import{J as o}from"./index-DSbNGMh9.js";const s=t=>({id:t,cached:!1,title:"未知项目",description:"项目信息未缓存",authorid:0,type:"scratch",licence:"unknow",state:"unknow",view_count:0,time:0,tags:[],source:"unknow"});async function y(t){return Array.isArray(t)||(t=[t]),Promise.all(t.map(e=>r.projects.get(Number(e)).then(a=>a||s(e)))).then(e=>t.length===1?e[0]:e)}async function n(t){if(t.id=Number(t.id),await r.projects.get(t.id))return await r.projects.put(t),`项目 ${t.title} 更新成功.`;{const a=await r.projects.add(t);return`项目 ${t.title} 成功缓存. 获取到id为 ${a}`}}async function h(t){try{return Array.isArray(t)||(t=[t]),(await Promise.all(t.map(n))).join(`
`)}catch(e){return`添加缓存失败: ${e}`}}async function m(t){try{const e=await r.projects.get(Number(t));return e?(await r.projects.delete(Number(t)),`项目 ${e.title} 删除成功.`):`删除 ${t} 失败: Project not found`}catch(e){return`删除 ${t} 失败: ${e}`}}async function j(t){Array.isArray(t)||(t=[t]);try{return(await Promise.all(t.map(async a=>{const i={...await o.get(`/project/${a}`).data};return await n(i)}))).join(`
`)}catch(e){return`刷新失败: ${e}`}}function w(t,e){return Array.isArray(t)||(t=[t]),c(()=>r.projects.where("id").anyOf(t).toArray()).subscribe(e)}function g(t){return c(()=>r.projects.toArray()).subscribe(t)}function p(t){return r.projects.get(Number(t)).then(e=>e||s(t))}async function b(t){const e=(await o.get(`/project/${t}`)).data;console.log(e);const a={...e};return await n(a),a}export{g as D,y as a,h as b,m as c,b as f,p as g,w as l,j as r};
