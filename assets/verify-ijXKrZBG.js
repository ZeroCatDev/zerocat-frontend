import{bl as k,r as d,b as w,a5 as B,ag as C,c as T,o as g,e as l,M as t,f as p,X as M,$ as N,Q as _,R as b,aK as E,aI as R,aG as V,aB as x,i as F,L as h,T as q,aa as I,Y as L}from"./index-3iUuPb_9.js";import"https://static.geetest.com/v4/gt4.js";const S={class:"auth-wrapper d-flex align-center justify-center pa-4"},z={__name:"verify",setup(U){const i=k(),u=d(""),r=d(""),o=d(!1),c=d(""),v=d("success"),m={required:a=>!!a||"此字段为必填项",email:a=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)||"请输入有效的邮箱地址",length:a=>(a==null?void 0:a.length)===6||"验证码必须是6位数字"};w(()=>{const a=i.query.email,e=i.query.token;a&&(u.value=a),e&&(r.value=e),a&&e&&y()});const y=async()=>{var a,e;if(!o.value){if(!u.value||!r.value){n("请输入邮箱和验证码","error");return}if(r.value.length!==6){n("验证码必须是6位数字","error");return}o.value=!0,c.value="";try{const s=await B.post("/account/verify-email",{email:u.value,token:r.value});s.data.state==="success"?n(s.data.message||"邮箱验证成功！","success"):n(s.data.message||"邮箱验证失败！","error")}catch(s){n(((e=(a=s.response)==null?void 0:a.data)==null?void 0:e.message)||"验证失败，请重试","error")}finally{o.value=!1}}},n=(a,e="success")=>{c.value=a,v.value=e};return(a,e)=>{const s=C("v-cardtext");return g(),T("div",S,[l(L,{border:"",class:"auth-card pa-4 pt-7","max-width":"448",rounded:"lg"},{default:t(()=>[l(_,null,{default:t(()=>[l(b,{cols:"12"},{default:t(()=>[l(s,null,{default:t(()=>e[2]||(e[2]=[p("h5",{class:"text-h5 font-weight-semibold mb-1"}," 欢迎来到ZeroCat！ 👋🏻 ",-1),p("p",{class:"mb-0"},"验证你的邮箱",-1)])),_:1,__:[2]})]),_:1})]),_:1}),l(s,null,{default:t(()=>[l(_,null,{default:t(()=>[l(b,{cols:"12"},{default:t(()=>[l(E,{onSubmit:R(y,["prevent"])},{default:t(()=>[l(V,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=f=>u.value=f),disabled:x(i).query.email,rules:[m.required,m.email],label:"邮箱地址",placeholder:"请输入邮箱地址",required:"",type:"email",variant:"outlined"},null,8,["modelValue","disabled","rules"]),l(V,{modelValue:r.value,"onUpdate:modelValue":e[1]||(e[1]=f=>r.value=f),disabled:x(i).query.token,rules:[m.required,m.length],label:"验证码",maxlength:"6",placeholder:"请输入6位验证码",required:"",type:"text",variant:"outlined"},null,8,["modelValue","disabled","rules"]),l(F,{disabled:o.value,loading:o.value,color:"primary",size:"large",type:"submit"},{default:t(()=>[h(q(o.value?"验证中...":"验证"),1)]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1})]),_:1}),e[3]||(e[3]=p("br",null,null,-1)),c.value?(g(),M(I,{key:0,type:v.value,variant:"tonal"},{default:t(()=>[h(q(c.value),1)]),_:1},8,["type"])):N("",!0)]),_:1,__:[3]})])}}};export{z as default};
