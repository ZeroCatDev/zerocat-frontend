import{_ as w}from"./Timeline-C7xeVeog.js";import{_,Y as T,o as h,N as a,e as i,ah as M,ai as d,L as n,a6 as v,a7 as m,W as f,a9 as g,O as u,a3 as c,T as V,a1 as p,M as L}from"./index-CqDYMkg5.js";const y={name:"MyTimeline",components:{Timeline:w},data(){return{tab:"all",timeline:{events:[],pagination:{current:1,size:20,total:0}},followingTimeline:{events:[],pagination:{current:1,size:20,total:0}},isLoadingMore:!1,isLoadingFollowingMore:!1}},created(){L({title:"我的动态 - ZeroCat"}),this.fetchTimeline(),this.fetchFollowingTimeline()},methods:{async fetchTimeline(l=1){try{const e=await p.get("/timeline/me",{params:{page:l,limit:this.timeline.pagination.size}});e.data.status==="success"&&(l===1?this.timeline=e.data.data:(this.timeline.events=[...this.timeline.events,...e.data.data.events],this.timeline.pagination=e.data.data.pagination))}catch(e){console.error("Failed to fetch timeline:",e)}},async fetchFollowingTimeline(l=1){try{const e=await p.get("/timeline/following",{params:{page:l,limit:this.followingTimeline.pagination.size}});e.data.status==="success"&&(l===1?this.followingTimeline=e.data.data:(this.followingTimeline.events=[...this.followingTimeline.events,...e.data.data.events],this.followingTimeline.pagination=e.data.data.pagination))}catch(e){console.error("Failed to fetch following timeline:",e)}},async loadMoreEvents(){if(!this.isLoadingMore)try{this.isLoadingMore=!0,await this.fetchTimeline(this.timeline.pagination.current+1)}finally{this.isLoadingMore=!1}},async loadMoreFollowingEvents(){if(!this.isLoadingFollowingMore)try{this.isLoadingFollowingMore=!0,await this.fetchFollowingTimeline(this.followingTimeline.pagination.current+1)}finally{this.isLoadingFollowingMore=!1}}}};function F(l,e,b,x,t,s){const r=w;return h(),T(V,null,{default:a(()=>[i(M,{align:"center",modelValue:t.tab,"onUpdate:modelValue":e[0]||(e[0]=o=>t.tab=o),"bg-color":"primary"},{default:a(()=>[i(d,{value:"all"},{default:a(()=>e[2]||(e[2]=[n("全部动态")])),_:1,__:[2]}),i(d,{value:"following"},{default:a(()=>e[3]||(e[3]=[n("关注的人")])),_:1,__:[3]})]),_:1},8,["modelValue"]),i(v,{modelValue:t.tab,"onUpdate:modelValue":e[1]||(e[1]=o=>t.tab=o)},{default:a(()=>[i(m,{value:"all"},{default:a(()=>[i(f,{class:"mt-4",variant:"flat"},{default:a(()=>[i(g,{class:"d-flex align-center"},{default:a(()=>[i(u,{icon:"mdi-timeline-clock",color:"primary",class:"mr-2"}),e[4]||(e[4]=n(" 我的动态 "))]),_:1,__:[4]}),i(c,null,{default:a(()=>[i(r,{timeline:t.timeline,"is-loading-more":t.isLoadingMore,onLoadMore:s.loadMoreEvents},null,8,["timeline","is-loading-more","onLoadMore"])]),_:1})]),_:1})]),_:1}),i(m,{value:"following"},{default:a(()=>[i(f,{class:"mt-4",variant:"flat"},{default:a(()=>[i(g,{class:"d-flex align-center"},{default:a(()=>[i(u,{icon:"mdi-account-group",color:"primary",class:"mr-2"}),e[5]||(e[5]=n(" 关注的人的动态 "))]),_:1,__:[5]}),i(c,null,{default:a(()=>[i(r,{timeline:t.followingTimeline,"is-loading-more":t.isLoadingFollowingMore,onLoadMore:s.loadMoreFollowingEvents},null,8,["timeline","is-loading-more","onLoadMore"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const E=_(y,[["render",F],["__scopeId","data-v-a61cd6d2"]]);export{E as default};
