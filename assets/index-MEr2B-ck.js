import{_ as h,a as _}from"./ProjectPlayer-CKHK5lDb.js";import{_ as w,Z as x,o as P,N as e,e as o,R as g,S as p,f as m,aD as b,i as l,m as V,L as s,Y as u,P as d,X as C,a8 as $,U as v,ao as B,ap as f,aM as N,M as k,ar as z,af as M}from"./index-D7ncyS9J.js";import"./UserRelationControls-CZbSAMTH.js";import"./VTextarea-SHNUIxsS.js";import"./projectListService-CSWhTVPY.js";import"./VSelect-Da2a1Axq.js";import"./VCheckboxBtn-BT7bPc39.js";import"./VSelectionControl-CpCL0wMQ.js";import"./TimeAgo-CTsSSuG9.js";import"./openEdit-BX8FwpvB.js";import"./CodeRunTerminal-DGzSV7dQ.js";import"./programming_languages-Aq2ViMcP.js";import"./ProjectSelector-Cjr8xfXD.js";import"./VRadioGroup-BwXqrWS9.js";import"./VSwitch-ITuG5znk.js";import"./VTimeline-DzzIK5v3.js";import"https://static.geetest.com/v4/gt4.js";const D={components:{ProjectPlayer:_,ProjectInfoCard:h},data(){return{project:{},author:{},localuser:M,showplayer:!0,commitInfo:null,initProject:z}},async mounted(){await this.initlizeProject()},methods:{async initlizeProject(){const r=this.$route.params.username,i=this.$route.params.projectname,a=this.$route.params.commitId;if(r==="proxy"){this.$router.replace(`/app${this.$route.path}`);return}const n=await B(r,i);if(n.id===0){f.show404();return}if(this.project=n,this.project.default_branch==null){this.showplayer=!1;return}if(this.commitInfo=await N(this.project.id,a),!this.commitInfo){f.show404();return}k({title:`${this.project.title} at ${this.commitInfo.commit_message}`}),this.author=this.project.author}},watch:{"$route.params.commitId":{handler:async function(r){await this.initlizeProject()},immediate:!0}}},H={class:"mb-2",style:{display:"flex","justify-content":"space-between"}};function R(r,i,a,n,t,S){const j=_,I=h;return P(),x(v,null,{default:e(()=>[o(g,null,{default:e(()=>[o(p,{cols:"12",lg:"8",md:"8",sm:"12",xl:"8",xs:"12",xxl:"8"},{default:e(()=>{var c;return[m("div",H,[m("div",null,[o(b,{"close-on-content-click":!1},{activator:e(({props:y})=>[o(l,V({class:"text-none","prepend-icon":"mdi-source-commit",rounded:"lg"},y,{variant:"tonal"}),{prepend:e(()=>[o(d)]),default:e(()=>[s(" "+u(t.commitInfo?t.commitInfo.commit.branch:"加载中..."),1)]),_:2},1040)]),_:1})]),o(l,{to:`/${r.$route.params.username}/${r.$route.params.projectname}/tree/${((c=t.commitInfo)==null?void 0:c.commit.branch)||"main"}`,class:"text-none","prepend-icon":"mdi-source-branch",rounded:"lg",variant:"tonal"},{prepend:e(()=>[o(d)]),default:e(()=>[i[0]||(i[0]=s(" 返回最新提交 ",-1))]),_:1,__:[0]},8,["to"])]),o(j,{"commit-id":r.$route.params.commitId,"project-id":t.project.id,showplayer:t.showplayer,type:t.project.type},null,8,["commit-id","project-id","showplayer","type"]),i[1]||(i[1]=m("br",null,null,-1)),o(C,{subtitle:t.commitInfo?t.commitInfo.commit.commit_date:"加载中...",title:t.commitInfo?t.commitInfo.commit.commit_message:"加载中...",border:"",hover:""},{default:e(()=>[o($,null,{default:e(()=>[s(u(t.commitInfo?t.commitInfo.commit.commit_description:"加载中..."),1)]),_:1})]),_:1},8,["subtitle","title"]),i[2]||(i[2]=m("br",null,null,-1))]}),_:1,__:[1,2]}),o(p,{cols:"12",lg:"4",md:"4",sm:"12",xl:"4",xs:"12",xxl:"8"},{default:e(()=>[o(I,{author:t.author,project:t.project,projectname:r.$route.params.projectname,username:r.$route.params.username},null,8,["author","project","projectname","username"])]),_:1})]),_:1})]),_:1})}const ot=w(D,[["render",R]]);export{ot as default};
