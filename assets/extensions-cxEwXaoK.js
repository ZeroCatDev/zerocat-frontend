import{_ as M,Y as V,o as p,N as s,e as t,W as v,aU as H,a9 as w,L as n,X as d,aW as X,O as g,i as x,a0 as P,a3 as _,aF as $,ah as ee,ai as Q,V as te,q as L,T as R,Q as I,R as f,aB as E,a5 as z,aE as B,aT as q,m as Z,aA as U,f as a,c as b,F as se,U as le,D as W,es as oe,aQ as k,$ as T,aD as C,S as Y,Z as ie,n as ne,a1 as D}from"./index-DecJVK_g.js";import{V as G}from"./VSelect-B1qTPVBI.js";import{V as ae}from"./VSwitch-pI3lMxFI.js";import{V as N}from"./VSpacer-CGtcHc8x.js";import{_ as J}from"./ProjectSelector-B0HQAWxk.js";import{T as S,d as F,r as re}from"./index-x2f9yEgj.js";import{d as de}from"./debounce-BMmXVQ06.js";import{V as ue}from"./VDataTableServer-CvftVKC4.js";import{V as me}from"./VTextarea-DoaL7CWv.js";import"https://static.geetest.com/v4/gt4.js";import"./VCheckboxBtn-BInP-Xnn.js";import"./VSelectionControl-DuKI3LMV.js";import"./_commonjsHelpers-BosuxZz1.js";import"./VTooltip-DofhNMBM.js";import"./VDataTable-BsggG_Pj.js";import"./VTable-xIOAPBbc.js";import"./filter-C5UXGfRp.js";const ce={name:"ExtensionEditor",props:{modelValue:{type:Boolean,default:!1},extension:{type:Object,default:null}},emits:["update:modelValue","save"],data(){return{tabIndex:0,formValid:!1,saving:!1,extensionData:{id:null,projectid:null,branch:"",commit:"latest",image:"",samples:null,docs:"",status:"developing",project:null,scratchCompatible:!1},statusOptions:[{text:"开发中",value:"developing"},{text:"待审核",value:"pending"},{text:"已批准",value:"verified"},{text:"已拒绝",value:"rejected"}],snackbar:{show:!1,text:"",color:"success",timeout:3e3}}},computed:{isEditing(){var i;return!!((i=this.extension)!=null&&i.id)}},watch:{modelValue(i){i&&this.initializeForm()},extension:{handler(){this.modelValue&&this.initializeForm()},deep:!0}},methods:{initializeForm(){this.extension?this.extensionData={id:this.extension.id,projectid:this.extension.projectid,branch:this.extension.branch||"",commit:this.extension.commit||"latest",image:this.extension.image||"",samples:this.extension.samples,docs:this.extension.docs||"",status:this.extension.status||"developing",project:this.extension.project,scratchCompatible:this.extension.scratchCompatible||!1}:this.extensionData={id:null,projectid:null,branch:"",commit:"latest",image:"",samples:null,docs:"",status:"developing",project:null,scratchCompatible:!1},this.$nextTick(()=>{this.$refs.editForm&&this.$refs.editForm.resetValidation()})},async save(){if(!this.formValid){this.showError("请检查表单信息");return}this.saving=!0;try{const i={projectid:Number(this.extensionData.projectid),branch:this.extensionData.branch||"",commit:this.extensionData.commit||"latest",image:this.extensionData.image||"",samples:this.extensionData.samples?Number(this.extensionData.samples):null,docs:this.extensionData.docs||"",status:this.extensionData.status,scratchCompatible:this.extensionData.scratchCompatible};this.isEditing&&this.extensionData.id&&(i.id=this.extensionData.id),this.$emit("save",i),this.showSuccess(this.isEditing?"扩展更新成功":"扩展创建成功"),this.close()}catch(i){console.error("Error saving extension:",i)}finally{this.saving=!1}},close(){this.$emit("update:modelValue",!1),this.tabIndex=0},showSuccess(i){this.snackbar={show:!0,text:i,color:"success",timeout:3e3}},showError(i){this.snackbar={show:!0,text:i,color:"error",timeout:5e3}}}};function pe(i,e,m,h,l,u){return p(),V(U,{"model-value":m.modelValue,"max-width":"800px",persistent:"","onUpdate:modelValue":e[13]||(e[13]=r=>i.$emit("update:modelValue",r))},{default:s(()=>[t(v,null,{default:s(()=>[t(H,null,{append:s(()=>[t(x,{icon:"",onClick:u.close},{default:s(()=>[t(g,null,{default:s(()=>e[15]||(e[15]=[n("mdi-close",-1)])),_:1,__:[15]})]),_:1},8,["onClick"])]),default:s(()=>[t(w,{class:"headline"},{default:s(()=>[n(d(u.isEditing?"编辑扩展":"创建扩展"),1)]),_:1}),t(X,null,{default:s(()=>{var r;return[t(g,null,{default:s(()=>e[14]||(e[14]=[n("mdi-puzzle",-1)])),_:1,__:[14]}),n(" "+d(((r=l.extensionData.project)==null?void 0:r.title)||"扩展管理"),1)]}),_:1})]),_:1}),t(P),t(_,{class:"pt-4"},{default:s(()=>[t($,{ref:"editForm",modelValue:l.formValid,"onUpdate:modelValue":e[10]||(e[10]=r=>l.formValid=r)},{default:s(()=>[t(ee,{"model-value":l.tabIndex,"onUpdate:modelValue":e[0]||(e[0]=r=>l.tabIndex=r)},{default:s(()=>[t(Q,{value:0},{default:s(()=>e[16]||(e[16]=[n("基本信息",-1)])),_:1,__:[16]}),t(Q,{value:1},{default:s(()=>e[17]||(e[17]=[n("扩展配置",-1)])),_:1,__:[17]})]),_:1},8,["model-value"]),t(_,null,{default:s(()=>[t(te,{"model-value":l.tabIndex,"onUpdate:modelValue":e[9]||(e[9]=r=>l.tabIndex=r)},{default:s(()=>[t(L,{value:0},{default:s(()=>[t(R,null,{default:s(()=>[t(I,null,{default:s(()=>[t(f,{cols:"12",sm:"6"},{default:s(()=>[t(E,{modelValue:l.extensionData.projectid,"onUpdate:modelValue":e[1]||(e[1]=r=>l.extensionData.projectid=r),rules:[r=>!!r||"项目ID不能为空",r=>!isNaN(r)||"项目ID必须是数字"],dense:"",label:"项目ID",outlined:"",type:"number"},null,8,["modelValue","rules"])]),_:1}),t(f,{cols:"12",sm:"6"},{default:s(()=>[t(G,{modelValue:l.extensionData.status,"onUpdate:modelValue":e[2]||(e[2]=r=>l.extensionData.status=r),items:l.statusOptions,dense:"","item-title":"text","item-value":"value",label:"扩展状态",outlined:""},null,8,["modelValue","items"])]),_:1}),t(f,{cols:"12",sm:"6"},{default:s(()=>[t(E,{modelValue:l.extensionData.branch,"onUpdate:modelValue":e[3]||(e[3]=r=>l.extensionData.branch=r),dense:"",label:"分支名称",outlined:"",placeholder:"main"},null,8,["modelValue"])]),_:1}),t(f,{cols:"12",sm:"6"},{default:s(()=>[t(E,{modelValue:l.extensionData.commit,"onUpdate:modelValue":e[4]||(e[4]=r=>l.extensionData.commit=r),dense:"",label:"提交哈希",outlined:"",placeholder:"latest"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(L,{value:1},{default:s(()=>[t(R,null,{default:s(()=>[t(I,null,{default:s(()=>[t(f,{cols:"12"},{default:s(()=>[t(z,{dense:"",text:"",type:"info",class:"mb-4"},{default:s(()=>e[18]||(e[18]=[n(" 扩展配置信息，用于定义扩展的基本属性和行为。 ",-1)])),_:1,__:[18]})]),_:1}),t(f,{cols:"12",sm:"6"},{default:s(()=>[t(E,{modelValue:l.extensionData.samples,"onUpdate:modelValue":e[5]||(e[5]=r=>l.extensionData.samples=r),dense:"",label:"示例项目ID",outlined:"",type:"number",hint:"关联的示例项目ID，用于演示扩展功能","persistent-hint":""},null,8,["modelValue"])]),_:1}),t(f,{cols:"12",sm:"6"},{default:s(()=>[t(E,{modelValue:l.extensionData.docs,"onUpdate:modelValue":e[6]||(e[6]=r=>l.extensionData.docs=r),dense:"",label:"文档URL",outlined:"",hint:"扩展文档的链接地址","persistent-hint":""},null,8,["modelValue"])]),_:1}),t(f,{cols:"12"},{default:s(()=>[t(E,{modelValue:l.extensionData.image,"onUpdate:modelValue":e[7]||(e[7]=r=>l.extensionData.image=r),dense:"",label:"扩展图片URL",outlined:"",hint:"扩展的图标或预览图片链接","persistent-hint":""},null,8,["modelValue"])]),_:1}),t(f,{cols:"12"},{default:s(()=>[t(ae,{modelValue:l.extensionData.scratchCompatible,"onUpdate:modelValue":e[8]||(e[8]=r=>l.extensionData.scratchCompatible=r),label:"兼容原版Scratch",color:"orange","hide-details":"",hint:"选择此扩展是否兼容原版Scratch平台","persistent-hint":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(P),t(B,null,{default:s(()=>[t(N),t(x,{text:"",onClick:u.close},{default:s(()=>e[19]||(e[19]=[n("取消",-1)])),_:1,__:[19]},8,["onClick"]),t(x,{disabled:!l.formValid||l.saving,loading:l.saving,color:"primary",onClick:u.save},{default:s(()=>[n(d(u.isEditing?"更新":"创建"),1)]),_:1},8,["disabled","loading","onClick"])]),_:1})]),_:1}),t(q,{modelValue:l.snackbar.show,"onUpdate:modelValue":e[12]||(e[12]=r=>l.snackbar.show=r),color:l.snackbar.color,timeout:l.snackbar.timeout,top:""},{action:s(({attrs:r})=>[t(x,Z({text:""},r,{onClick:e[11]||(e[11]=A=>l.snackbar.show=!1)}),{default:s(()=>e[20]||(e[20]=[n(" 关闭 ",-1)])),_:2,__:[20]},1040)]),default:s(()=>[n(d(l.snackbar.text)+" ",1)]),_:1},8,["modelValue","color","timeout"])]),_:1},8,["model-value"])}const K=M(ce,[["render",pe],["__scopeId","data-v-cefd0001"]]);F.extend(re);F.locale("zh-cn");const fe={name:"ExtensionsPage",components:{ExtensionEditor:K,ProjectSelector:J},data(){return{extensionStats:[{title:"总扩展数",value:100,type:"total",icon:"mdi-puzzle"},{title:"开发中",value:0,type:"developing",icon:"mdi-code-braces"},{title:"待审核",value:0,type:"pending",icon:"mdi-clock"},{title:"已批准",value:0,type:"verified",icon:"mdi-check-circle"},{title:"已拒绝",value:0,type:"rejected",icon:"mdi-close-circle"}],extensions:[],total:0,loading:!1,refreshing:!1,options:{page:1,itemsPerPage:10,sortBy:["id"],sortDesc:[!1],groupBy:[],groupDesc:[],multiSort:!1},headers:[{title:"ID",value:"id",width:"80px",sortable:!1},{title:"扩展信息",value:"project",width:"250px",sortable:!1},{title:"作者",value:"author",width:"150px",sortable:!1},{title:"状态",value:"status",width:"120px",sortable:!1},{title:"分支/提交",value:"branch",width:"120px",sortable:!1},{title:"Scratch兼容性",value:"scratchCompatible",width:"120px",sortable:!1},{title:"创建时间",value:"created_at",width:"180px",sortable:!1},{title:"更新时间",value:"updated_at",width:"180px",sortable:!1},{title:"操作",value:"actions",sortable:!1,width:"200px",align:"center"}],searchQuery:"",statusFilter:"",projectIdFilter:"",authorIdFilter:"",statusOptions:[{title:"开发中",value:"developing"},{title:"待审核",value:"pending"},{title:"已批准",value:"verified"},{title:"已拒绝",value:"rejected"}],editDialog:!1,viewDialog:!1,rejectDialog:!1,deleteDialog:!1,selectedExtension:null,rejectReason:"",rejecting:!1,deleting:!1,snackbar:{show:!1,text:"",color:"success",timeout:3e3}}},methods:{async loadExtensions(){this.loading=!0;try{const i={page:this.options.page,itemsPerPage:this.options.itemsPerPage,sortBy:this.options.sortBy[0]||"id",sortDesc:this.options.sortDesc[0]||!1};this.searchQuery&&(i.search=this.searchQuery),this.statusFilter&&(i.status=this.statusFilter),this.projectIdFilter&&(i.projectid=this.projectIdFilter),this.authorIdFilter&&(i.authorid=this.authorIdFilter);const{data:e}=await D.get("/admin/extensions",{params:i});this.extensions=e.items.map(m=>({...m,id:m.id,projectid:m.projectid,branch:m.branch||"",commit:m.commit||"latest",image:m.image||"",samples:m.samples,docs:m.docs,status:m.status||"developing",created_at:m.created_at,updated_at:m.updated_at})),this.total=Number(e.total)}catch(i){this.showError("加载扩展列表失败"),console.error("Error loading extensions:",i)}finally{this.loading=!1}},async loadExtensionStats(){try{const i=await D.get("/admin/extensions/stats/overview");this.extensionStats[0].value=i.data.data.total,this.extensionStats[1].value=i.data.data.developing,this.extensionStats[2].value=i.data.data.pending,this.extensionStats[3].value=i.data.data.verified,this.extensionStats[4].value=i.data.data.rejected}catch(i){console.error("Error loading extension stats:",i)}},async refreshData(){if(!(this.refreshing||this.loading)){this.refreshing=!0;try{await Promise.all([this.loadExtensions(),this.loadExtensionStats()]),this.showSuccess("数据已更新")}catch(i){this.showError("刷新数据失败"),console.error("Error refreshing data:",i)}finally{this.refreshing=!1}}},createExtension(){this.selectedExtension=null,this.editDialog=!0},viewExtension(i){this.selectedExtension=i,this.viewDialog=!0},editExtension(i){this.selectedExtension=i,this.editDialog=!0},async saveExtension(i){var e,m;try{if(i.id){const{data:h}=await D.put(`/admin/extensions/${i.id}`,i),l=this.extensions.findIndex(u=>u.id===i.id);l!==-1&&(this.extensions[l]={...this.extensions[l],...h}),this.showSuccess("扩展信息更新成功")}else{const{data:h}=await D.post("/admin/extensions",i);this.extensions.unshift(h),this.showSuccess("扩展创建成功")}this.loadExtensionStats()}catch(h){throw this.showError(((m=(e=h.response)==null?void 0:e.data)==null?void 0:m.error)||"保存扩展信息失败"),console.error("Error saving extension:",h),h}},async approveExtension(i){try{const{data:e}=await D.post(`/admin/extensions/${i.id}/approve`),m=this.extensions.findIndex(h=>h.id===i.id);m!==-1&&(this.extensions[m]={...this.extensions[m],...e}),this.showSuccess("扩展已批准"),this.loadExtensionStats()}catch(e){this.showError("批准扩展失败"),console.error("Error approving extension:",e)}},rejectExtension(i){this.selectedExtension=i,this.rejectReason="",this.rejectDialog=!0},async confirmReject(){this.rejecting=!0;try{const{data:i}=await D.post(`/admin/extensions/${this.selectedExtension.id}/reject`,{reason:this.rejectReason}),e=this.extensions.findIndex(m=>m.id===this.selectedExtension.id);e!==-1&&(this.extensions[e]={...this.extensions[e],...i}),this.showSuccess("扩展已拒绝"),this.loadExtensionStats(),this.rejectDialog=!1}catch(i){this.showError("拒绝扩展失败"),console.error("Error rejecting extension:",i)}finally{this.rejecting=!1}},confirmDelete(i){this.selectedExtension=i,this.deleteDialog=!0},async deleteExtension(){this.deleting=!0;try{await D.delete(`/admin/extensions/${this.selectedExtension.id}`),this.showSuccess("扩展删除成功"),this.loadExtensions(),this.loadExtensionStats(),this.deleteDialog=!1}catch(i){this.showError("删除扩展失败"),console.error("Error deleting extension:",i)}finally{this.deleting=!1}},getStatusText(i){const e=this.statusOptions.find(m=>m.value===i);return e?e.title:i},formatDate(i){return F(i).format("YYYY-MM-DD HH:mm:ss")},formatTimeAgo(i){return F(i).fromNow()},getStatusColor(i){return{developing:"info",pending:"warning",verified:"success",rejected:"error"}[i]||"grey"},getExtensionImage(i){return i?(i.startsWith("http"),i):"/favicon.png"},showSuccess(i){this.snackbar={show:!0,text:i,color:"success",timeout:3e3}},showError(i){this.snackbar={show:!0,text:i,color:"error",timeout:5e3}},debouncedSearch:de(function(){this.loadExtensions()},300)},mounted(){this.loadExtensions(),this.loadExtensionStats()}},xe={class:"extensions-admin"},ge={class:"text-overline mb-2"},he={class:"text-h4"},ve={class:"d-flex align-center"},_e={class:"font-weight-medium"},be={class:"caption grey--text"},Ve={key:0},Ee={class:"font-weight-medium"},De={class:"caption grey--text"},we={key:1,class:"grey--text"},ye={class:"font-weight-medium"},je={class:"caption grey--text"},ke={class:"caption grey--text"},Ce={class:"caption grey--text"},Se={class:"mb-2"},Ie={class:"mb-2"},Ue={class:"mb-2"},Fe={class:"mb-2"},Te={class:"mb-2"},Pe={class:"mb-2"},Re={class:"mb-2"},ze={class:"mb-2"},Be={class:"mb-2"},Ne={class:"mb-2"},Ae=["href"],Oe={key:1,class:"grey--text"},Qe={class:"mb-2"},Le=["href"],We={key:1,class:"grey--text"},Ye={class:"mb-2"},Me={key:0},He={key:1,class:"grey--text"};function Xe(i,e,m,h,l,u){const r=J,A=K;return p(),V(R,null,{default:s(()=>[a("div",xe,[t(I,{class:"mb-4"},{default:s(()=>[(p(!0),b(se,null,le(l.extensionStats,o=>(p(),V(f,{key:o.title,cols:"12",md:"3",sm:"6"},{default:s(()=>[t(v,{class:W(["stat-card",`stat-${o.type}`]),elevation:"2"},{default:s(()=>[t(_,null,{default:s(()=>[a("div",ge,d(o.title),1),a("div",he,d(o.value),1),t(g,{class:"stat-icon",large:""},{default:s(()=>[n(d(o.icon),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["class"])]),_:2},1024))),128))]),_:1}),t(v,{class:"mb-4"},{default:s(()=>[t(_,null,{default:s(()=>[t(I,{align:"center"},{default:s(()=>[t(f,{cols:"12",sm:"3"},{default:s(()=>[t(E,{modelValue:l.searchQuery,"onUpdate:modelValue":e[0]||(e[0]=o=>l.searchQuery=o),clearable:"","hide-details":"",label:"搜索扩展","prepend-icon":"mdi-magnify",onInput:u.debouncedSearch},null,8,["modelValue","onInput"])]),_:1}),t(f,{cols:"12",sm:"2"},{default:s(()=>[t(G,{modelValue:l.statusFilter,"onUpdate:modelValue":e[1]||(e[1]=o=>l.statusFilter=o),items:l.statusOptions,clearable:"","hide-details":"",label:"状态过滤","prepend-icon":"mdi-filter",onChange:u.loadExtensions},null,8,["modelValue","items","onChange"])]),_:1}),t(f,{cols:"12",sm:"2"},{default:s(()=>[t(r,{modelValue:l.projectIdFilter,"onUpdate:modelValue":e[2]||(e[2]=o=>l.projectIdFilter=o),multiple:!1},null,8,["modelValue"]),t(E,{modelValue:l.projectIdFilter,"onUpdate:modelValue":e[3]||(e[3]=o=>l.projectIdFilter=o),clearable:"","hide-details":"",label:"项目ID","prepend-icon":"mdi-folder",type:"number",onInput:u.debouncedSearch},null,8,["modelValue","onInput"])]),_:1}),t(f,{cols:"12",sm:"2"},{default:s(()=>[t(E,{modelValue:l.authorIdFilter,"onUpdate:modelValue":e[4]||(e[4]=o=>l.authorIdFilter=o),clearable:"","hide-details":"",label:"作者ID","prepend-icon":"mdi-account",type:"number",onInput:u.debouncedSearch},null,8,["modelValue","onInput"])]),_:1}),t(f,{class:"d-flex justify-end",cols:"12",sm:"3"},{default:s(()=>[t(x,{disabled:l.loading,loading:l.refreshing,color:"primary",onClick:u.refreshData},{default:s(()=>[t(g,{class:W({rotate:l.refreshing}),left:""},{default:s(()=>e[17]||(e[17]=[n("mdi-refresh",-1)])),_:1,__:[17]},8,["class"]),e[18]||(e[18]=n(" 刷新 ",-1))]),_:1,__:[18]},8,["disabled","loading","onClick"]),t(x,{class:"ml-2",color:"success",onClick:u.createExtension},{default:s(()=>[t(g,{left:""},{default:s(()=>e[19]||(e[19]=[n("mdi-plus",-1)])),_:1,__:[19]}),e[20]||(e[20]=n(" 新建扩展 ",-1))]),_:1,__:[20]},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1}),t(v,null,{default:s(()=>[t(ue,{"items-per-page":l.options.itemsPerPage,"onUpdate:itemsPerPage":e[5]||(e[5]=o=>l.options.itemsPerPage=o),page:l.options.page,"onUpdate:page":e[6]||(e[6]=o=>l.options.page=o),headers:l.headers,items:l.extensions,"items-length":l.total,loading:l.loading,"loading-text":"加载中...","no-data-text":"暂无数据","no-results-text":"未找到匹配的数据","onUpdate:options":u.loadExtensions},{"item.project":s(({item:o})=>{var c,y;return[a("div",ve,[t(ie,{class:"mr-2",size:"32"},{default:s(()=>{var j;return[t(ne,{alt:((j=o.project)==null?void 0:j.title)||"扩展",src:u.getExtensionImage(o.image)},null,8,["alt","src"])]}),_:2},1024),a("div",null,[a("div",_e,d(((c=o.project)==null?void 0:c.title)||"未知扩展"),1),a("div",be,d(((y=o.project)==null?void 0:y.name)||"未知名称"),1)])])]}),"item.author":s(({item:o})=>{var c;return[(c=o.project)!=null&&c.author?(p(),b("div",Ve,[a("div",Ee,d(o.project.author.display_name),1),a("div",De,"@"+d(o.project.author.username),1)])):(p(),b("div",we,"未知作者"))]}),"item.status":s(({item:o})=>[t(Y,{color:u.getStatusColor(o.status),class:"status-chip",small:""},{default:s(()=>[n(d(u.getStatusText(o.status)),1)]),_:2},1032,["color"])]),"item.branch":s(({item:o})=>[a("div",null,[a("div",ye,d(o.branch||"main"),1),a("div",je,d(o.commit||"latest"),1)])]),"item.created_at":s(({item:o})=>[a("div",null,d(u.formatDate(o.created_at)),1),a("div",ke,d(u.formatTimeAgo(o.created_at)),1)]),"item.updated_at":s(({item:o})=>[a("div",null,d(u.formatDate(o.updated_at)),1),a("div",Ce,d(u.formatTimeAgo(o.updated_at)),1)]),"item.actions":s(({item:o})=>[t(oe,{group:""},{default:s(()=>[k((p(),V(x,{class:"action-btn",icon:"",small:"",onClick:C(c=>u.viewExtension(o),["stop"])},{default:s(()=>[t(g,null,{default:s(()=>e[21]||(e[21]=[n("mdi-eye",-1)])),_:1,__:[21]})]),_:2},1032,["onClick"])),[[S,"查看详情"]]),k((p(),V(x,{class:"action-btn",icon:"",small:"",onClick:C(c=>u.editExtension(o),["stop"])},{default:s(()=>[t(g,null,{default:s(()=>e[22]||(e[22]=[n("mdi-pencil",-1)])),_:1,__:[22]})]),_:2},1032,["onClick"])),[[S,"编辑扩展"]]),o.status==="pending"?k((p(),V(x,{key:0,class:"action-btn",color:"success",icon:"",small:"",onClick:C(c=>u.approveExtension(o),["stop"])},{default:s(()=>[t(g,null,{default:s(()=>e[23]||(e[23]=[n("mdi-check",-1)])),_:1,__:[23]})]),_:2},1032,["onClick"])),[[S,"批准扩展"]]):T("",!0),o.status==="pending"?k((p(),V(x,{key:1,class:"action-btn",color:"error",icon:"",small:"",onClick:C(c=>u.rejectExtension(o),["stop"])},{default:s(()=>[t(g,null,{default:s(()=>e[24]||(e[24]=[n("mdi-close",-1)])),_:1,__:[24]})]),_:2},1032,["onClick"])),[[S,"拒绝扩展"]]):T("",!0),k((p(),V(x,{class:"action-btn",color:"error",icon:"",small:"",onClick:C(c=>u.confirmDelete(o),["stop"])},{default:s(()=>[t(g,null,{default:s(()=>e[25]||(e[25]=[n("mdi-delete",-1)])),_:1,__:[25]})]),_:2},1032,["onClick"])),[[S,"删除扩展"]])]),_:2},1024)]),_:1},8,["items-per-page","page","headers","items","items-length","loading","onUpdate:options"])]),_:1}),t(A,{modelValue:l.editDialog,"onUpdate:modelValue":e[7]||(e[7]=o=>l.editDialog=o),extension:l.selectedExtension,onSave:u.saveExtension},null,8,["modelValue","extension","onSave"]),t(U,{modelValue:l.viewDialog,"onUpdate:modelValue":e[9]||(e[9]=o=>l.viewDialog=o),"max-width":"800px",transition:"dialog-bottom-transition"},{default:s(()=>[t(v,null,{default:s(()=>[t(H,null,{append:s(()=>[t(x,{icon:"",onClick:e[8]||(e[8]=o=>l.viewDialog=!1)},{default:s(()=>[t(g,null,{default:s(()=>e[28]||(e[28]=[n("mdi-close",-1)])),_:1,__:[28]})]),_:1})]),default:s(()=>[t(w,{class:"headline"},{default:s(()=>e[26]||(e[26]=[n(" 扩展详情 ",-1)])),_:1,__:[26]}),t(X,null,{default:s(()=>{var o,c;return[t(g,null,{default:s(()=>e[27]||(e[27]=[n("mdi-puzzle",-1)])),_:1,__:[27]}),n(" "+d(((c=(o=l.selectedExtension)==null?void 0:o.project)==null?void 0:c.title)||"扩展详情"),1)]}),_:1})]),_:1}),t(P),l.selectedExtension?(p(),V(_,{key:0,class:"pt-4"},{default:s(()=>[t(I,null,{default:s(()=>[t(f,{cols:"12",sm:"6"},{default:s(()=>[t(v,{outlined:""},{default:s(()=>[t(w,{class:"subtitle-1"},{default:s(()=>e[29]||(e[29]=[n("基本信息",-1)])),_:1,__:[29]}),t(_,null,{default:s(()=>[a("div",Se,[e[30]||(e[30]=a("strong",null,"扩展ID:",-1)),n(" "+d(l.selectedExtension.id),1)]),a("div",Ie,[e[31]||(e[31]=a("strong",null,"项目ID:",-1)),n(" "+d(l.selectedExtension.projectid),1)]),a("div",Ue,[e[32]||(e[32]=a("strong",null,"分支:",-1)),n(" "+d(l.selectedExtension.branch||"main"),1)]),a("div",Fe,[e[33]||(e[33]=a("strong",null,"提交:",-1)),n(" "+d(l.selectedExtension.commit||"latest"),1)]),a("div",Te,[e[34]||(e[34]=a("strong",null,"状态:",-1)),t(Y,{color:u.getStatusColor(l.selectedExtension.status),small:""},{default:s(()=>[n(d(u.getStatusText(l.selectedExtension.status)),1)]),_:1},8,["color"])])]),_:1})]),_:1})]),_:1}),t(f,{cols:"12",sm:"6"},{default:s(()=>[t(v,{outlined:""},{default:s(()=>[t(w,{class:"subtitle-1"},{default:s(()=>e[35]||(e[35]=[n("项目信息",-1)])),_:1,__:[35]}),t(_,null,{default:s(()=>{var o,c,y,j,O;return[a("div",Pe,[e[36]||(e[36]=a("strong",null,"项目名称:",-1)),n(" "+d((o=l.selectedExtension.project)==null?void 0:o.title),1)]),a("div",Re,[e[37]||(e[37]=a("strong",null,"项目标识:",-1)),n(" "+d((c=l.selectedExtension.project)==null?void 0:c.name),1)]),a("div",ze,[e[38]||(e[38]=a("strong",null,"描述:",-1)),n(" "+d((y=l.selectedExtension.project)==null?void 0:y.description),1)]),a("div",Be,[e[39]||(e[39]=a("strong",null,"作者:",-1)),n(" "+d((O=(j=l.selectedExtension.project)==null?void 0:j.author)==null?void 0:O.display_name),1)])]}),_:1})]),_:1})]),_:1}),t(f,{cols:"12"},{default:s(()=>[t(v,{outlined:""},{default:s(()=>[t(w,{class:"subtitle-1"},{default:s(()=>e[40]||(e[40]=[n("扩展资源",-1)])),_:1,__:[40]}),t(_,null,{default:s(()=>{var o;return[a("div",Ne,[e[41]||(e[41]=a("strong",null,"图片URL:",-1)),l.selectedExtension.image?(p(),b("a",{key:0,href:l.selectedExtension.image,target:"_blank"},d(l.selectedExtension.image),9,Ae)):(p(),b("span",Oe,"未设置"))]),a("div",Qe,[e[42]||(e[42]=a("strong",null,"文档URL:",-1)),l.selectedExtension.docs?(p(),b("a",{key:0,href:l.selectedExtension.docs,target:"_blank"},d(l.selectedExtension.docs),9,Le)):(p(),b("span",We,"未设置"))]),a("div",Ye,[e[43]||(e[43]=a("strong",null,"示例项目:",-1)),l.selectedExtension.samples?(p(),b("span",Me,d(((o=l.selectedExtension.sample_project)==null?void 0:o.title)||l.selectedExtension.samples),1)):(p(),b("span",He,"未设置"))])]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):T("",!0)]),_:1})]),_:1},8,["modelValue"]),t(U,{modelValue:l.rejectDialog,"onUpdate:modelValue":e[12]||(e[12]=o=>l.rejectDialog=o),"max-width":"500px",transition:"dialog-bottom-transition"},{default:s(()=>[t(v,null,{default:s(()=>[t(w,{class:"headline error--text"},{default:s(()=>e[44]||(e[44]=[n("拒绝扩展",-1)])),_:1,__:[44]}),t(_,{class:"pt-4"},{default:s(()=>[t(z,{dense:"",text:"",type:"warning"},{default:s(()=>{var o,c;return[e[45]||(e[45]=n(" 您即将拒绝扩展 ",-1)),a("strong",null,d((c=(o=l.selectedExtension)==null?void 0:o.project)==null?void 0:c.title),1),e[46]||(e[46]=n("，请提供拒绝原因。 ",-1))]}),_:1,__:[45,46]}),t(me,{modelValue:l.rejectReason,"onUpdate:modelValue":e[10]||(e[10]=o=>l.rejectReason=o),rules:[o=>!!o||"拒绝原因不能为空"],class:"mt-4",label:"拒绝原因",outlined:"",rows:"3"},null,8,["modelValue","rules"])]),_:1}),t(B,null,{default:s(()=>[t(N),t(x,{text:"",onClick:e[11]||(e[11]=o=>l.rejectDialog=!1)},{default:s(()=>e[47]||(e[47]=[n("取消",-1)])),_:1,__:[47]}),t(x,{disabled:!l.rejectReason,loading:l.rejecting,color:"error",text:"",onClick:u.confirmReject},{default:s(()=>e[48]||(e[48]=[n(" 确认拒绝 ",-1)])),_:1,__:[48]},8,["disabled","loading","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(U,{modelValue:l.deleteDialog,"onUpdate:modelValue":e[14]||(e[14]=o=>l.deleteDialog=o),"max-width":"400px",transition:"dialog-bottom-transition"},{default:s(()=>[t(v,null,{default:s(()=>[t(w,{class:"headline error--text"},{default:s(()=>e[49]||(e[49]=[n("确认删除",-1)])),_:1,__:[49]}),t(_,{class:"pt-4"},{default:s(()=>[t(z,{dense:"",text:"",type:"warning"},{default:s(()=>{var o,c;return[e[50]||(e[50]=n(" 此操作将永久删除扩展 ",-1)),a("strong",null,d((c=(o=l.selectedExtension)==null?void 0:o.project)==null?void 0:c.title),1),e[51]||(e[51]=n(" ，此操作不可撤销。 ",-1))]}),_:1,__:[50,51]})]),_:1}),t(B,null,{default:s(()=>[t(N),t(x,{text:"",onClick:e[13]||(e[13]=o=>l.deleteDialog=!1)},{default:s(()=>e[52]||(e[52]=[n("取消",-1)])),_:1,__:[52]}),t(x,{loading:l.deleting,color:"error",text:"",onClick:u.deleteExtension},{default:s(()=>e[53]||(e[53]=[n(" 确认删除 ",-1)])),_:1,__:[53]},8,["loading","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(q,{modelValue:l.snackbar.show,"onUpdate:modelValue":e[16]||(e[16]=o=>l.snackbar.show=o),color:l.snackbar.color,timeout:l.snackbar.timeout,top:""},{action:s(({attrs:o})=>[t(x,Z({text:""},o,{onClick:e[15]||(e[15]=c=>l.snackbar.show=!1)}),{default:s(()=>e[54]||(e[54]=[n(" 关闭 ",-1)])),_:2,__:[54]},1040)]),default:s(()=>[n(d(l.snackbar.text)+" ",1)]),_:1},8,["modelValue","color","timeout"])])]),_:1})}const mt=M(fe,[["render",Xe],["__scopeId","data-v-62f6d3d6"]]);export{mt as default};
