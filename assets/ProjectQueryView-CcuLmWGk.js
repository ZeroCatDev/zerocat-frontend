import{_ as g}from"./ProjectCard-f5jzzeUY.js";import{_,ey as m,Y as o,o as a,N as t,e,$ as f,Q as i,R as c,W as y,aQ as P,a9 as V,f as j,X as h,S as k,L as d,aS as x,a4 as C,a5 as w,c as S,F as N,U as T,bA as b,T as v}from"./index-Dz-hN2N-.js";const B={name:"ProjectQueryView",components:{ProjectCard:g},props:{type:{type:String,required:!0,validator:s=>["fork","tag","author","search"].includes(s)},target:{type:String,required:!0}},data(){return{projects:[],total:0,limit:20,currentPage:1,loading:!0}},computed:{offset(){return(this.currentPage-1)*this.limit},getTitle(){switch(this.type){case"fork":return"分叉项目";case"tag":return`标签: ${this.target}`;case"author":return"作者项目";case"search":return`搜索: ${this.target}`;default:return"项目列表"}},getDescription(){switch(this.type){case"fork":return"从原项目分叉的所有项目";case"tag":return`包含 "${this.target}" 标签的所有项目`;case"author":return"该作者的所有项目";case"search":return`包含 "${this.target}" 的搜索结果`;default:return""}}},watch:{currentPage(){this.fetchProjects()},type(){this.resetPagination(),this.fetchProjects()},target(){this.resetPagination(),this.fetchProjects()}},methods:{resetPagination(){this.currentPage=1,this.total=0},async fetchProjects(){this.loading=!0;try{const s=await m(this.type,this.target,this.limit,this.offset);s.status==="success"?(this.projects=s.data.projects,this.total=s.data.total):(console.error("Failed to fetch projects:",s.message),this.projects=[],this.total=0)}catch(s){console.error("Error fetching projects:",s),this.projects=[],this.total=0}finally{this.loading=!1}}},created(){this.fetchProjects()}};function D(s,n,q,F,r,u){const p=g;return a(),o(v,null,{default:t(()=>[e(i,null,{default:t(()=>[e(c,{cols:"12"},{default:t(()=>[e(y,{class:"mb-4"},{default:t(()=>[e(P,null,{default:t(()=>[e(V,{class:"d-flex align-center"},{default:t(()=>[j("span",null,h(u.getTitle),1),e(k,{class:"ml-2",color:"primary",size:"small"},{default:t(()=>[d(h(r.total)+" 个项目 ",1)]),_:1})]),_:1}),u.getDescription?(a(),o(x,{key:0},{default:t(()=>[d(h(u.getDescription),1)]),_:1})):f("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),r.loading?(a(),o(i,{key:0},{default:t(()=>[e(c,{class:"text-center",cols:"12"},{default:t(()=>[e(C,{color:"primary",indeterminate:""})]),_:1})]),_:1})):r.projects.length===0?(a(),o(i,{key:1},{default:t(()=>[e(c,{cols:"12"},{default:t(()=>[e(w,{type:"info",variant:"tonal"},{default:t(()=>n[1]||(n[1]=[d(" 暂无项目 ",-1)])),_:1,__:[1]})]),_:1})]),_:1})):(a(),o(i,{key:2},{default:t(()=>[(a(!0),S(N,null,T(r.projects,l=>(a(),o(c,{key:l.id,cols:"12",lg:"3",md:"4",sm:"6",xl:"2",xs:"12",xxl:"2"},{default:t(()=>[e(p,{author:l.author,project:l,"show-author":!0},null,8,["author","project"])]),_:2},1024))),128))]),_:1})),r.total>r.limit?(a(),o(i,{key:3},{default:t(()=>[e(c,{class:"text-center",cols:"12"},{default:t(()=>[e(b,{modelValue:r.currentPage,"onUpdate:modelValue":n[0]||(n[0]=l=>r.currentPage=l),length:Math.ceil(r.total/r.limit),"total-visible":7,rounded:"lg"},null,8,["modelValue","length"])]),_:1})]),_:1})):f("",!0)]),_:1})}const E=_(B,[["render",D],["__scopeId","data-v-92f17c25"]]);export{E as _};
