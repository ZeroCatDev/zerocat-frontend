import{d as t,l as i}from"./db-zGpD-re4.js";import{J as c}from"./index-B38-HsvM.js";async function o(e){if(e.id=Number(e.id),await t.users.get(e.id))return await t.users.put(e),`用户 ${e.display_name} 更新成功.`;{const a=await t.users.add(e);return`用户 ${e.display_name} 成功缓存. 获取到id为 ${a}`}}async function f(e){try{return Array.isArray(e)||(e=[e]),(await Promise.all(e.map(async a=>await o(a)))).join(`
`)}catch(r){return`添加缓存失败: ${r}`}}async function y(e){try{const r=await t.users.get(Number(e));return r?(await t.users.delete(Number(e)),`用户 ${r.display_name} 删除成功.`):`删除 ${e} 失败: User not found`}catch(r){return`删除 ${e} 失败: ${r}`}}async function n(e){Array.isArray(e)||(e=[e]);try{return(await Promise.all(e.map(async a=>{const s=await c.get(`/api/getuserinfo?id=${a}`);if(console.log(s),s.status==="ok"){const u={id:s.info.user.id,display_name:s.info.user.display_name,motto:s.info.user.motto,images:s.info.user.images,regTime:s.info.user.regTime,sex:s.info.user.sex,username:s.info.user.username};return await o(u)}else return`刷新 ${a} 失败: ${s.status}`}))).join(`
`)}catch(r){return`刷新 ${e} 失败: ${r}`}}function g(e,r){return Array.isArray(e)||(e=[e]),i(()=>t.users.where("id").anyOf(e).toArray()).subscribe(r)}function d(e){return i(()=>t.users.toArray()).subscribe(e)}async function p(e){const r=await t.users.get(Number(e));if(r)return n(e),r;{const a={id:e,display_name:"示例用户",motto:"这是一个示例",images:"default.png",regTime:"0000-00-00T00:00:00.000Z",sex:"未知",username:"exampleuser"};return n(e),a}}export{d as D,f as a,n as b,p as g,g as l,y as r};
