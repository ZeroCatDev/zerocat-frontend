import{_ as y,r as w,w as d,b as _,au as k,c as C,o as E}from"./index-BtdOAlf3.js";const S={name:"MonacoEditorComponent",props:{modelValue:{type:String,default:""},language:{type:String,default:"javascript"},options:{type:Object,default:()=>({})},locale:{type:String,default:"zh-cn"},projectType:{type:String,default:""}},emits:["update:modelValue","change","monaco-ready"],setup(t,{emit:c}){const i=w(null);let o=null,r=null,s=null,n=null,l=[];const p=()=>{if(l.forEach(e=>e==null?void 0:e.dispose()),l=[],o){try{const e=o.getModel();e&&e.dispose(),o.dispose()}catch(e){console.error("Error disposing editor:",e)}o=null}if(s){try{s.disconnect()}catch(e){console.error("Error disconnecting resize observer:",e)}s=null}if(r){try{r.dispose()}catch(e){console.error("Error disposing content change listener:",e)}r=null}n=null,i.value&&(i.value.innerHTML="")},m=()=>{window.require.config({paths:{vs:"/monaco-editor/min/vs"},"vs/nls":{availableLanguages:{"*":t.locale}}}),window.require(["vs/editor/editor.main"],function(e){n=e,n.editor.defineTheme("monokai",{base:"vs-dark",inherit:!0,rules:[{token:"comment",foreground:"88846f",fontStyle:"italic"},{token:"keyword",foreground:"f92672"},{token:"string",foreground:"e6db74"},{token:"number",foreground:"ae81ff"}],colors:{"editor.background":"#272822","editor.foreground":"#f8f8f2","editorLineNumber.foreground":"#90908a","editor.selectionBackground":"#49483e","editor.lineHighlightBackground":"#3e3d32"}}),h(),c("monaco-ready",{monaco:n,editor:o,availableLanguages:n.languages.getLanguages()})})},h=()=>{if(!i.value||!n)return;let e=t.language;if(t.projectType){const f=t.projectType.split("-")[0].toLowerCase(),b=n.languages.getLanguages().find(L=>L.id===f);b&&(e=b.id)}const v={...{value:t.modelValue,language:e,theme:"monokai",fontSize:14,tabSize:2,minimap:{enabled:!0},scrollBeyondLastLine:!1,automaticLayout:!0,wordWrap:"on",lineNumbers:"on",formatOnPaste:!0,formatOnType:!0,autoIndent:"full",suggestOnTriggerCharacters:!0,acceptSuggestionOnEnter:"on",quickSuggestions:!0,snippetSuggestions:"top",renderControlCharacters:!0,renderWhitespace:"selection",bracketPairColorization:{enabled:!0}},...t.options};o=n.editor.create(i.value,v),r=o.onDidChangeModelContent(()=>{const f=o.getValue();c("update:modelValue",f),c("change",f)}),l.push(r),s=new ResizeObserver(()=>{o&&o.layout()}),s.observe(i.value),setTimeout(()=>{o&&o.layout()},100);const g=o.onDidFocusEditorText(()=>{o.layout()});l.push(g);const u=o.onDidChangeConfiguration(()=>{o.layout()});l.push(u)};return d(()=>t.modelValue,e=>{o&&e!==o.getValue()&&o.setValue(e)}),d(()=>t.language,e=>{if(o&&n){const a=o.getModel();a&&n.editor.setModelLanguage(a,e)}}),d(()=>t.options,e=>{o&&o.updateOptions(e)},{deep:!0}),d(()=>t.locale,e=>{p(),window.require.config({"vs/nls":{availableLanguages:{"*":e}}}),window.require(["vs/editor/editor.main"],function(a){n=a,h()})}),d(()=>t.projectType,e=>{if(o&&n&&e){const a=e.split("-")[0].toLowerCase(),g=n.languages.getLanguages().find(u=>u.id===a);if(g){const u=o.getModel();u&&n.editor.setModelLanguage(u,g.id)}}}),_(()=>{if(window.require)m();else{const a=document.createElement("script");a.src="/monaco-editor/min/vs/loader.js",a.onload=m,document.head.appendChild(a)}const e=()=>{o&&o.layout()};window.addEventListener("resize",e),l.push({dispose:()=>window.removeEventListener("resize",e)})}),k(()=>{p()}),{editorContainer:i}}},z={ref:"editorContainer",style:{height:"100%",width:"100%"}};function M(t,c,i,o,r,s){return E(),C("div",z,null,512)}const T=y(S,[["render",M]]);export{T as _};
