import{_ as h,X as _,o as u,M as a,e as s,i as o,L as l,O as V,Q as g,c as C,F as x,W as $,R as k,aF as v,Y as y,a8 as p,aG as O,aJ as P,N as L,m as b,ae as N,f as w,T,b0 as B,U as D,a5 as m,a6 as F}from"./index-BpIYSfoU.js";import"https://static.geetest.com/v4/gt4.js";const R={data(){return{totpList:[],loading:!1,renameDialog:!1,deleteDialog:!1,selectedTOTPId:null,newName:"",renameError:"",nameRules:[t=>t?!0:"Name is required.",t=>(t==null?void 0:t.length)<=100?!0:"Name must be less than 10 characters."]}},setup(){F({title:"验证器"})},methods:{async fetchTOTPList(){this.loading=!0;try{const t=await m.get("/account/totp/list").data;t.status==="success"?this.totpList=t.data.list:this.$toast.add({severity:"error",summary:"错误",detail:t.message,life:3e3})}catch(t){this.$toast.add({severity:"error",summary:"错误",detail:t.message,life:3e3})}finally{this.loading=!1}},async renameTOTP(t,e){if(e==""){this.renameError="名称不能为空";return}try{const i=await m.post("/account/totp/rename",{totp_id:t,name:e}).data;i.status==="success"?(this.fetchTOTPList(),this.$toast.add({severity:"success",summary:"成功",detail:"验证器重命名成功",life:3e3})):this.$toast.add({severity:"error",summary:"错误",detail:i.message,life:3e3})}catch(i){this.$toast.add({severity:"error",summary:"错误",detail:i.message,life:3e3})}},async deleteTOTP(t){try{const e=await m.post("/account/totp/delete",{totp_id:t}).data;e.status==="success"?(this.fetchTOTPList(),this.$toast.add({severity:"success",summary:"成功",detail:"验证器删除成功",life:3e3})):this.$toast.add({severity:"error",summary:"错误",detail:e.message,life:3e3})}catch(e){this.$toast.add({severity:"error",summary:"错误",detail:e.message,life:3e3})}}},mounted(){this.fetchTOTPList()}},E={class:"headline"};function I(t,e,i,S,c,f){return u(),_(D,null,{default:a(()=>[s(o,{class:"mb-4",color:"primary",to:"./totp/add"},{default:a(()=>[s(V,{left:""},{default:a(()=>e[0]||(e[0]=[l("mdi-plus",-1)])),_:1,__:[0]}),e[1]||(e[1]=l(" 新的验证器 ",-1))]),_:1,__:[1]}),s(g,null,{default:a(()=>[(u(!0),C(x,null,$(c.totpList,r=>(u(),_(k,{key:r.id,cols:"12",md:"4"},{default:a(()=>[s(v,{"max-width":"500"},{activator:a(({props:n})=>[s(y,b({border:""},{ref_for:!0},n),{default:a(()=>[s(N,null,{default:a(()=>[w("span",E,T(r.name),1)]),_:2},1024),s(B,null,{default:a(()=>[l(T(r.status),1)]),_:2},1024),s(p,null,{default:a(()=>e[2]||(e[2]=[l(" 点击打开管理",-1)])),_:1,__:[2]})]),_:2},1040)]),default:a(({isActive:n})=>[s(y,{title:r.name,border:""},{default:a(()=>[s(p,null,{default:a(()=>[s(O,{modelValue:r.name,"onUpdate:modelValue":d=>r.name=d,counter:100,rules:c.nameRules,label:"验证器名称",required:""},null,8,["modelValue","onUpdate:modelValue","rules"]),s(o,{color:"primary",onClick:d=>f.renameTOTP(r.id,r.name)},{default:a(()=>e[3]||(e[3]=[l("重命名 ",-1)])),_:2,__:[3]},1032,["onClick"])]),_:2},1024),s(P,null,{default:a(()=>[s(o,{border:"",color:"error",variant:"text",onClick:d=>f.deleteTOTP(r.id)},{default:a(()=>e[4]||(e[4]=[l("删除 ",-1)])),_:2,__:[4]},1032,["onClick"]),s(L),s(o,{text:"关闭",onClick:d=>n.value=!1},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["title"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})}const A=h(R,[["render",I]]);export{A as default};
