import{_ as y,r as w,w as d,b as S,au as k,c as C,o as z}from"./index-DJjZltn0.js";const _={name:"MonacoEditorComponent",props:{modelValue:{type:String,default:""},language:{type:String,default:"javascript"},options:{type:Object,default:()=>({})},locale:{type:String,default:"zh-cn"},projectType:{type:String,default:""}},emits:["update:modelValue","change","monaco-ready"],setup(n,{emit:c}){const a=w(null);let o=null,i=null,s=null,t=null,l=[];const m=()=>{if(l.forEach(e=>e==null?void 0:e.dispose()),l=[],o){try{const e=o.getModel();e&&e.dispose(),o.dispose()}catch(e){console.error("Error disposing editor:",e)}o=null}if(s){try{s.disconnect()}catch(e){console.error("Error disconnecting resize observer:",e)}s=null}if(i){try{i.dispose()}catch(e){console.error("Error disposing content change listener:",e)}i=null}t=null,a.value&&(a.value.innerHTML="")},p=()=>{window.require.config({paths:{vs:"/monaco-editor/min/vs"},"vs/nls":{availableLanguages:{"*":n.locale}}}),window.require(["vs/editor/editor.main"],function(e){t=e,t.editor.defineTheme("monokai",{base:"vs-dark",inherit:!0,rules:[{token:"comment",foreground:"88846f",fontStyle:"italic"},{token:"keyword",foreground:"f92672"},{token:"string",foreground:"e6db74"},{token:"number",foreground:"ae81ff"}],colors:{"editor.background":"#272822","editor.foreground":"#f8f8f2","editorLineNumber.foreground":"#90908a","editor.selectionBackground":"#49483e","editor.lineHighlightBackground":"#3e3d32"}}),h(),c("monaco-ready",{monaco:t,editor:o,availableLanguages:t.languages.getLanguages()})})},h=()=>{if(!a.value||!t)return;let e=n.language;if(n.projectType){const f=n.projectType.split("-")[0].toLowerCase(),b=t.languages.getLanguages().find(L=>L.id===f);b&&(e=b.id)}const v={...{value:n.modelValue,language:e,theme:"vs-dark",fontSize:14,tabSize:2,minimap:{enabled:!0,scale:2,showSlider:"mouseover"},scrollBeyondLastLine:!1,automaticLayout:!0,wordWrap:"on",lineNumbers:"on",renderLineHighlight:"all",formatOnPaste:!0,formatOnType:!0,autoIndent:"full",suggestOnTriggerCharacters:!0,acceptSuggestionOnEnter:"on",quickSuggestions:{other:!0,comments:!0,strings:!0},snippetSuggestions:"top",renderControlCharacters:!0,renderWhitespace:"selection",bracketPairColorization:{enabled:!0,independentColorPoolPerBracketType:!0},guides:{bracketPairs:!0,indentation:!0,highlightActiveIndentation:!0,bracketPairsHorizontal:!0},cursorBlinking:"smooth",cursorSmoothCaretAnimation:"on",smoothScrolling:!0,mouseWheelZoom:!0,padding:{top:5,bottom:5},folding:!0,foldingHighlight:!0,unfoldOnClickAfterEndOfLine:!0,links:!0,contextmenu:!0,mouseWheelScrollSensitivity:1,roundedSelection:!0,scrollbar:{verticalScrollbarSize:12,horizontalScrollbarSize:12,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,arrowSize:0}},...n.options};o=t.editor.create(a.value,v),i=o.onDidChangeModelContent(()=>{const f=o.getValue();c("update:modelValue",f),c("change",f)}),l.push(i),s=new ResizeObserver(()=>{o&&o.layout()}),s.observe(a.value),setTimeout(()=>{o&&o.layout()},100);const g=o.onDidFocusEditorText(()=>{o.layout()});l.push(g);const u=o.onDidChangeConfiguration(()=>{o.layout()});l.push(u)};return d(()=>n.modelValue,e=>{o&&e!==o.getValue()&&o.setValue(e)}),d(()=>n.language,e=>{if(t){const r=t.editor.getModels();r.length>0&&t.editor.setModelLanguage(r[0],e)}}),d(()=>n.options,e=>{o&&o.updateOptions(e)},{deep:!0}),d(()=>n.locale,e=>{m(),window.require.config({"vs/nls":{availableLanguages:{"*":e}}}),window.require(["vs/editor/editor.main"],function(r){t=r,h()})}),d(()=>n.projectType,e=>{if(o&&t&&e){const r=e.split("-")[0].toLowerCase(),g=t.languages.getLanguages().find(u=>u.id===r);if(g){const u=o.getModel();u&&t.editor.setModelLanguage(u,g.id)}}}),S(()=>{if(window.require)p();else{const r=document.createElement("script");r.src="/monaco-editor/min/vs/loader.js",r.onload=p,document.head.appendChild(r)}const e=()=>{o&&o.layout()};window.addEventListener("resize",e),l.push({dispose:()=>window.removeEventListener("resize",e)})}),k(()=>{m()}),{editorContainer:a}}},E={ref:"editorContainer",style:{height:"100%",width:"100%"}};function O(n,c,a,o,i,s){return z(),C("div",E,null,512)}const j=y(_,[["render",O]]);export{j as _};
