import{_ as g,Y as k,o as b,N as a,e as d,W as h,a3 as m,L as u,f as s,X as p,T as w,ab as y,M as c}from"./index-CqDYMkg5.js";class l extends Error{}l.prototype.name="InvalidTokenError";function I(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,r)=>{let o=r.charCodeAt(0).toString(16).toUpperCase();return o.length<2&&(o="0"+o),"%"+o}))}function $(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return I(e)}catch{return atob(e)}}function f(t,e){if(typeof t!="string")throw new l("Invalid token specified: must be a string");e||(e={});const r=e.header===!0?0:1,o=t.split(".")[r];if(typeof o!="string")throw new l(`Invalid token specified: missing part #${r+1}`);let n;try{n=$(o)}catch(i){throw new l(`Invalid token specified: invalid base64 for part #${r+1} (${i.message})`)}try{return JSON.parse(n)}catch(i){throw new l(`Invalid token specified: invalid json for part #${r+1} (${i.message})`)}}const C={data(){return{token:this.$route.query.token||"无",user:{},BASE_API:"https://zerocat-api.houlangs.com"}},setup(){c({title:"ZeroCat - 确认账户登录"})},async created(){if(this.$route.query.token)try{this.user=f(this.token),localStorage.setItem("token",this.token),this.user=f(localStorage.getItem("token")),console.log(this.user),await y.loadUser(),this.$router.push({path:"/"})}catch(t){this.user=t}else c({title:"ZeroCat - 账户登录失败"}),console.log("无token")}};function v(t,e,r,o,n,i){return b(),k(w,null,{default:a(()=>[d(h,{class:"mx-auto",rel:"noopener",target:"_blank",border:""},{title:a(()=>e[0]||(e[0]=[s("span",null,"您正在登录一个账户",-1)])),subtitle:a(()=>e[1]||(e[1]=[s("span",null,"其他页面传来了一个登录请求，正常情况下它会被自动处理",-1)])),default:a(()=>[d(m,{class:"bg-surface-light pt-4"},{default:a(()=>[e[2]||(e[2]=u("传入的token是：")),e[3]||(e[3]=s("br",null,null,-1)),u(" "+p(n.token)+" ",1),e[4]||(e[4]=s("br",null,null,-1)),e[5]||(e[5]=s("br",null,null,-1)),e[6]||(e[6]=u("处理后的数据是：")),e[7]||(e[7]=s("br",null,null,-1)),u(" "+p(n.user),1)]),_:1,__:[2,3,4,5,6,7]})]),_:1})]),_:1})}const S=g(C,[["render",v]]);export{S as default};
