import{g as D,a as j}from"./projectService-D54mBBJq.js";import{_ as g,J as B,o as l,c as f,w as r,a as t,P as m,ac as b,L as c,a2 as V,e as y,S as C,R as _,T as v,a6 as w,ae as x,af as p,ag as k,a8 as I,M as d,Q as u,a0 as P,a1 as T}from"./index-BCCQ0H2E.js";import{a as L,V as N}from"./VRow-DEZ83P-X.js";import{V as S}from"./VSpacer-G6GFRpEX.js";import{V as F}from"./VDialog-zTtyYV-K.js";import{V as K}from"./VContainer-fbKdjcW-.js";/* empty css              */const M={data(){return{projectbranchs:[],project:{},branchDescription:{branch:"",dialog:!1,description:""}}},async mounted(){await this.fetchProjectInfo(),this.fetchBranches()},methods:{async fetchProjectInfo(){const n=this.$route.params.username,e=this.$route.params.projectname,s=await D(n,e);this.project=s},async fetchBranches(){const n=this.project.id,e=await j(n);this.projectbranchs=e.data},async editBranchDescription(n){this.branchDescription.branch=n,this.branchDescription.description=this.projectbranchs.find(e=>e.name===n).description,this.branchDescription.dialog=!0},async saveBranchDescription(){const n=this.project.id,e=this.branchDescription.branch,s=this.branchDescription.description;await B.post(`/project/branches/description/?branch=${e}&projectid=${n}`,{description:s}),this.branchDescription.dialog=!1,this.fetchBranches()}}};function J(n,e,s,R,i,o){return l(),f(K,null,{default:r(()=>[t(N,null,{default:r(()=>[t(L,{cols:"12"},{default:r(()=>[t(m,{hover:"",border:""},{default:r(()=>[t(b,null,{default:r(()=>e[4]||(e[4]=[c("分支列表")])),_:1}),t(V,{dense:""},{default:r(()=>[(l(!0),y(_,null,C(i.projectbranchs,a=>(l(),f(u,{key:a.name,title:a.name,subtitle:JSON.stringify(a)},{append:r(()=>[t(P,null,{activator:r(({props:h})=>[t(d,T({variant:"text",icon:"mdi-dots-horizontal",ref_for:!0},h),null,16)]),default:r(()=>[t(V,null,{default:r(()=>[t(u,{"prepend-icon":"mdi-pencil",title:"设置分支简介",subtitle:"设置此分支的简介",onClick:h=>o.editBranchDescription(a.name)},null,8,["onClick"]),t(u,{"prepend-icon":"mdi-delete",title:"删除此分支",subtitle:"将永久删除掉此分支所有数据，难以恢复",disabled:""})]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","subtitle"]))),128))]),_:1})]),_:1})]),_:1})]),_:1}),t(F,{modelValue:i.branchDescription.dialog,"onUpdate:modelValue":e[3]||(e[3]=a=>i.branchDescription.dialog=a),"max-width":"500"},{default:r(()=>[t(m,null,{default:r(()=>[t(b,null,{default:r(()=>[c("设置分支 "+v(i.branchDescription.branch)+" 的简介",1)]),_:1}),t(w,null,{default:r(()=>[t(x,{modelValue:i.branchDescription.description,"onUpdate:modelValue":e[0]||(e[0]=a=>i.branchDescription.description=a),label:"分支简介",variant:"outlined",hint:"设置此分支的简介",onKeyup:[p(o.saveBranchDescription,["enter"]),e[1]||(e[1]=p(a=>i.branchDescription.dialog=!1,["esc"])),p(k(o.saveBranchDescription,["ctrl"]),["s"])],counter:"100"},null,8,["modelValue","onKeyup"])]),_:1}),t(I,null,{default:r(()=>[t(S),t(d,{onClick:e[2]||(e[2]=a=>i.branchDescription.dialog=!1)},{default:r(()=>e[5]||(e[5]=[c("取消")])),_:1}),t(d,{color:"primary",onClick:o.saveBranchDescription},{default:r(()=>e[6]||(e[6]=[c("保存")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const G=g(M,[["render",J]]);export{G as default};
