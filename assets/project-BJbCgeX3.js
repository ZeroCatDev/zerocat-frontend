import{_ as y}from"./Projects-CWLRtAPc.js";import{_ as C,Y as x,o as _,N as s,e as l,f as p,Q as g,R as a,aB as u,i as n,L as m,aA as w,W as k,a3 as U,S as T,m as D,X as b,a0 as I,aE as S,T as B,a1 as c,ab as h,M as E,r as N}from"./index-CqDYMkg5.js";import{V as d}from"./VSelect-ByyaaPA0.js";import{V as A}from"./VAutocomplete-CMwxdzQD.js";import{V as q}from"./VTextarea-BMQ0gWum.js";import{V as L}from"./VCombobox-CCJdL5BB.js";import{V as R,a as F,b as H,c as M}from"./VExpansionPanels-TbU22qXq.js";import{V as O}from"./VSpacer-BmIOKXlY.js";import"./ProjectCard-BYWSBxv8.js";import"./VCheckboxBtn-8mXxa5va.js";import"./VSelectionControl-DLr9dD2N.js";import"./filter-COFDuoWJ.js";const Q={components:{Projects:y},data(){return{localuser:h,projectstates:[{state:"私密",abbr:"private"},{state:"公开",abbr:"public"}],projecthistory:[{state:"关闭",abbr:"0"},{state:"开启",abbr:"1"}],searchstates:[{state:"所有",abbr:""},{state:"私密",abbr:"private"},{state:"公开",abbr:"public"}],typeitems:[{name:"所有",type:""},{name:"Scratch",type:"scratch"},{name:"Python",type:"python"}],orderitems:[{name:"观看量升序",type:"view_up"},{name:"观看量降序",type:"view_down"},{name:"时间升序",type:"time_up"},{name:"时间降序",type:"time_down"},{name:"序号升序",type:"id_up"},{name:"序号降序",type:"id_down"}],currentProjectID:0,dialog:!1,currentProject:{},previousProject:{},search:{title:"",type:"",description:"",source:"",order:"view_up",authorid:"",type:"",state:"",tag:""},aboutTags:{items:["动画","故事","音乐","硬核","艺术","水"],chips:N({}),selected:[]},url:""}},async created(){h.isLogin.value===!1&&this.$router.push("/app/account/login"),await this.onPageChange()},setup(){E({title:"我的作品"})},methods:{removetag(o){chips.value.splice(chips.value.indexOf(o),1)},projecttypeProps(o){return{title:o.name,subtitle:o.department}},async onPageChange(o=1){this.url=`/searchapi?search_userid=${h.user.value.id}&search_type=${this.search.type}&search_title=${this.search.title}&search_source=${this.search.source}&search_description=${this.search.description}&search_orderby=${this.search.order}&search_state=${this.search.state}&search_tag=${this.search.tag}`},resetSearch(){this.search={title:"",type:"scratch",description:"",source:"",order:"view_up",authorid:"",state:"public",tag:"",limit:20},this.onPageChange()},openinfo(o,e){this.currentProjectID=o,this.currentProject=e,this.previousProject={...e},this.aboutTags.chips=this.currentProject.tags.map(V=>V.name),this.dialog=!0},async pushproject(o){try{const e=await c.post(`/project/${o}/push`);console.log(e.data),this.$toast.add({severity:"info",summary:"info",detail:e.data.message,life:3e3}),this.onPageChange()}catch(e){console.log(e),this.$toast.add({severity:"error",summary:"失败",detail:"失败",life:3e3})}},async deleteProject(){try{const o=await c.delete(`/project/edit/${this.currentProjectID}`);console.log(o.data),this.$toast.add({severity:"info",summary:"info",detail:o.data.message,life:3e3}),this.onPageChange(),this.dialog=!1}catch(o){console.log(o),this.$toast.add({severity:"error",summary:"error",detail:"删除失败",life:3e3})}},async SaveProjectsInfo(){this.currentProject.tags=this.aboutTags.chips.map(o=>o);try{const o=await c.put(`/project/id/${this.currentProjectID}`,this.currentProject);console.log(o.data),this.$toast.add({severity:"info",summary:"info",detail:o.data.message,life:3e3}),this.dialog=!1,this.onPageChange()}catch(o){console.log(o),this.$toast.add({severity:"error",summary:"error",detail:"修改失败",life:3e3})}}}};function W(o,e,V,X,t,i){const v=y;return _(),x(B,null,{default:s(()=>[l(g,null,{default:s(()=>[l(a,{cols:"6"},{default:s(()=>[l(u,{label:"作品名 包含："+t.search.title,modelValue:t.search.title,"onUpdate:modelValue":e[0]||(e[0]=r=>t.search.title=r)},null,8,["label","modelValue"])]),_:1}),l(a,{cols:"6"},{default:s(()=>[l(u,{label:"作品描述 包含："+t.search.description,modelValue:t.search.description,"onUpdate:modelValue":e[1]||(e[1]=r=>t.search.description=r)},null,8,["label","modelValue"])]),_:1}),l(a,{cols:"6"},{default:s(()=>[l(u,{label:"作品内容 包含："+t.search.source,modelValue:t.search.source,"onUpdate:modelValue":e[2]||(e[2]=r=>t.search.source=r)},null,8,["label","modelValue"])]),_:1}),l(a,{cols:"6"},{default:s(()=>[l(u,{"control-variant":"用户ID",label:"用户ID 为："+t.search.authorid,modelValue:t.localuser.user.id,"onUpdate:modelValue":e[3]||(e[3]=r=>t.localuser.user.id=r),disabled:""},null,8,["label","modelValue"])]),_:1}),l(a,{cols:"3"},{default:s(()=>[l(d,{modelValue:t.search.order,"onUpdate:modelValue":e[4]||(e[4]=r=>t.search.order=r),items:t.orderitems,"item-title":"name","item-value":"type",label:"排序"},null,8,["modelValue","items"])]),_:1}),l(a,{cols:"3"},{default:s(()=>[l(d,{modelValue:t.search.type,"onUpdate:modelValue":e[5]||(e[5]=r=>t.search.type=r),items:t.typeitems,"item-title":"name","item-value":"type",label:"项目类型"},null,8,["modelValue","items"])]),_:1}),l(a,{cols:"3"},{default:s(()=>[l(d,{modelValue:t.search.state,"onUpdate:modelValue":e[6]||(e[6]=r=>t.search.state=r),items:t.searchstates,"item-title":"state","item-value":"abbr",label:"项目状态"},null,8,["modelValue","items"])]),_:1}),l(a,{cols:"3"},{default:s(()=>[l(A,{label:"标签 为："+t.search.tag,items:["","动画","故事","音乐","硬核","艺术","水"],modelValue:t.search.tag,"onUpdate:modelValue":e[7]||(e[7]=r=>t.search.tag=r)},null,8,["label","modelValue"])]),_:1}),l(a,{cols:"12"},{default:s(()=>[l(n,{color:"primary",variant:"flat",rounded:"xl",onClick:e[8]||(e[8]=r=>i.onPageChange()),"append-icon":"mdi-magnify"},{default:s(()=>e[18]||(e[18]=[m("搜索")])),_:1,__:[18]}),l(n,{color:"",variant:"flat",rounded:"xl",onClick:e[9]||(e[9]=r=>{t.search.order="view_up",t.search.type="",t.search.authorid="",t.search.source="",t.search.description="",t.search.title="",t.search.state="public",i.onPageChange()})},{default:s(()=>e[19]||(e[19]=[m("重置")])),_:1,__:[19]})]),_:1})]),_:1}),e[23]||(e[23]=p("br",null,null,-1)),e[24]||(e[24]=p("br",null,null,-1)),l(v,{url:t.url},null,8,["url"]),l(w,{modelValue:t.dialog,"onUpdate:modelValue":e[17]||(e[17]=r=>t.dialog=r),"max-width":"70vw",persistent:"",origin:"center center"},{default:s(()=>[l(k,{"prepend-icon":"mdi-xml",title:"作品信息"},{default:s(()=>[l(U,null,{default:s(()=>[l(g,{dense:""},{default:s(()=>[l(a,{cols:"12",md:"12",sm:"12"},{default:s(()=>[l(u,{label:"标题",required:"",modelValue:t.currentProject.title,"onUpdate:modelValue":e[10]||(e[10]=r=>t.currentProject.title=r),hint:"将会在首页展示"},null,8,["modelValue"])]),_:1}),l(a,{cols:"12",md:"12",sm:"12"},{default:s(()=>[l(q,{hint:"介绍作品类型，玩法，并向对这个作品有帮助的人致谢！",label:"简介",modelValue:t.currentProject.description,"onUpdate:modelValue":e[11]||(e[11]=r=>t.currentProject.description=r)},null,8,["modelValue"])]),_:1}),l(a,{cols:"12",sm:"6"},{default:s(()=>[l(d,{items:["scratch","python","text"],label:"类型",required:"",hint:"不建议你改",modelValue:t.currentProject.type,"onUpdate:modelValue":e[12]||(e[12]=r=>t.currentProject.type=r)},null,8,["modelValue"])]),_:1}),l(a,{cols:"12",sm:"6"},{default:s(()=>[l(d,{modelValue:t.currentProject.state,"onUpdate:modelValue":e[13]||(e[13]=r=>t.currentProject.state=r),items:t.projectstates,"item-title":"state","item-value":"abbr",label:"项目状态",hint:"我们鼓励开源"},null,8,["modelValue","items"])]),_:1}),l(a,{cols:"12"},{default:s(()=>[l(L,{modelValue:t.aboutTags.chips,"onUpdate:modelValue":e[14]||(e[14]=r=>t.aboutTags.chips=r),items:t.aboutTags.items,label:"标签","prepend-icon":"mdi-tag",variant:"solo",chips:"",multiple:""},{selection:s(({attrs:r,item:f,select:P,selected:j})=>[l(T,D(r,{"model-value":j,closable:"",onClick:P,"onClick:close":Y=>i.removetag(f)}),{default:s(()=>[p("strong",null,b(f.name),1),e[20]||(e[20]=m("  ")),e[21]||(e[21]=p("span",null,"(interest)",-1))]),_:2,__:[20,21]},1040,["model-value","onClick","onClick:close"])]),_:1},8,["modelValue","items"])]),_:1}),l(R,null,{default:s(()=>[l(F,null,{default:s(()=>[l(H,null,{default:s(()=>e[22]||(e[22]=[m("详细数据")])),_:1,__:[22]}),l(M,null,{default:s(()=>[m(b(t.currentProject),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(I),l(S,null,{default:s(()=>[l(n,{color:"error",text:"删除",variant:"tonal",onClick:i.deleteProject},null,8,["onClick"]),l(n,{color:"text",text:"一键推送",variant:"tonal",onClick:e[15]||(e[15]=r=>i.pushproject(t.currentProject.id))}),l(O),l(n,{text:"取消",variant:"plain",onClick:e[16]||(e[16]=r=>t.dialog=!1)}),l(n,{color:"primary",text:"保存",variant:"tonal",onClick:i.SaveProjectsInfo},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1,__:[23,24]})}const ae=C(Q,[["render",W]]);export{ae as default};
