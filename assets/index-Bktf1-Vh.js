import{_ as z}from"./LoadingDialog-Bb1q8UG4.js";import{_ as B}from"./AuthCard-C-x1QPuY.js";import{_ as E}from"./Recaptcha-BARNAuAE.js";import{_ as I,a as L,o as M,h as o,P as l,U as W,a1 as Z,i as n,N as i,m as x,ap as A,k as u,as as H,b4 as j,r as d,al as G,O as J}from"./index-CgnhFUSh.js";import{A as S}from"./authService-BaPQc0mb.js";import{V as K}from"./VForm-D4aSCKkg.js";import{V as Q,a as g}from"./VRow-AYG8h_Q1.js";import{V as R}from"./VTextField-WUANx533.js";import{V as X}from"./VDialog-DldvZv1o.js";import{V as T}from"./VTooltip-Csw9-7_x.js";import{V as b}from"./VCheckbox-COUZo9cD.js";import{V as Y}from"./VAlert-jafP2gQJ.js";import{V as $}from"./VSpacer-CJT8cHsI.js";import"https://static.geetest.com/v4/gt4.js";import"./VInput-DPc1474M.js";/* empty css              *//* empty css                   */import"./VField-B9329J6g.js";import"./VCheckboxBtn-CP1Ng23m.js";import"./VSelectionControl-CqfFqHDr.js";const ee={components:{LoadingDialog:z,Recaptcha:E,AuthCard:B},setup(){const f=j(),e=d(null),c=d(""),a=d(""),k=d(""),v=d(!1),_=d(!1),w=d(null),p=d({privacy:!1,terms:!1,rules:!1,datadelete:!1}),s=[t=>!!t||"必须填写邮箱",t=>/.+@.+\..+/.test(t)||"不符合格式"],r=[t=>!!t||"必须填写用户名",t=>t.length>=3||"用户名至少需要3个字符",t=>t.length<=20||"用户名最多20个字符"],F=[t=>!!t||"必须填写密码",t=>t.length>=8||"密码至少需要8个字符",t=>/[A-Za-z]/.test(t)&&/[0-9]/.test(t)||"密码必须包含字母和数字"];G.isLogin.value===!0&&f.push("/app/explore"),J({title:"注册"});const N=()=>{p.value={privacy:!1,terms:!1,rules:!1,datadelete:!1}},O=()=>{for(const t in p.value)if(p.value[t]===!1)return V("请先阅读并同意相关协议"),!1;return!0},q=async()=>{var t,P,U;try{if(!O())return;v.value=!0;const y=((t=w.value)==null?void 0:t.getResponse())||null,C={email:c.value,username:a.value,password:k.value,captcha:y,skipPassword:!1},m=await S.register(C);m.status==="success"?m.needVerify?(localStorage.setItem("verificationEmail",c.value),m.temporaryToken&&localStorage.setItem("verificationToken",m.temporaryToken),f.push("/app/account/register/verify")):(h(m.message||"注册成功"),m.needPassword?f.push("/app/account/register/setup-password"):f.push("/app/dashboard")):V(m.message||"注册失败")}catch(y){console.error(y);const C=((U=(P=y.response)==null?void 0:P.data)==null?void 0:U.message)||"注册失败，请稍后再试";V(C)}finally{v.value=!1}},D=t=>{window.location.href=S.oauthRedirect(t)},h=t=>{window.$toast?window.$toast.add({severity:"success",summary:"成功",detail:t,life:3e3}):window.$notify?window.$notify({title:"成功",message:t,type:"success"}):(console.log("Success:",t),alert(t))},V=t=>{window.$toast?window.$toast.add({severity:"error",summary:"错误",detail:t,life:3e3}):window.$notify?window.$notify({title:"错误",message:t,type:"error"}):(console.error("Error:",t),alert(t))};return{email:c,username:a,password:k,loading:v,showPassword:_,agreement:p,emailRules:s,usernameRules:r,passwordRules:F,recaptcha:w,registerForm:e,register:q,resetAgreement:N,registerWithOAuth:D,showSuccessToast:h,showErrorToast:V}}},te={class:"mb-4"},oe={class:"mb-4"},ae={class:"mb-4"},le={class:"d-flex flex-wrap gap-2 justify-start mt-4"};function re(f,e,c,a,k,v){const _=E,w=B,p=z;return M(),L("div",null,[o(w,{subtitle:"创建你的账户"},{default:l(()=>[o(K,{ref:"registerForm"},{default:l(()=>[o(Q,null,{default:l(()=>[o(g,{cols:"12"},{default:l(()=>[o(R,{label:"邮箱",type:"email",modelValue:a.email,"onUpdate:modelValue":e[0]||(e[0]=s=>a.email=s),variant:"outlined",required:"",rules:a.emailRules},null,8,["modelValue","rules"]),o(R,{label:"用户名",type:"text",modelValue:a.username,"onUpdate:modelValue":e[1]||(e[1]=s=>a.username=s),variant:"outlined",required:"",rules:a.usernameRules},null,8,["modelValue","rules"]),o(R,{label:"密码",modelValue:a.password,"onUpdate:modelValue":e[2]||(e[2]=s=>a.password=s),variant:"outlined",required:"",rules:a.passwordRules,"append-icon":a.showPassword?"mdi-eye":"mdi-eye-off",type:a.showPassword?"text":"password","onClick:append":e[3]||(e[3]=s=>a.showPassword=!a.showPassword)},null,8,["modelValue","rules","append-icon","type"])]),_:1}),o(g,{cols:"12"},{default:l(()=>[o(_,{ref:"recaptcha",recaptchaId:"recaptcha-div"},null,512)]),_:1}),o(g,{cols:"12"},{default:l(()=>[o(X,{persistent:""},{activator:l(({props:s})=>[o(u,x(s,{class:"text-none",color:"primary",rounded:"xl",text:"注册",variant:"flat",size:"large","append-icon":"mdi-arrow-right",loading:a.loading}),null,16,["loading"])]),default:l(({isActive:s})=>[o(W,{title:"您正在使用由厚浪(及孙悟元)提供的服务"},{default:l(()=>[o(Z,null,{default:l(()=>[n("div",te,[e[14]||(e[14]=i(" 我们可能会收集您的个人信息,具体参见 ")),o(T,{location:"bottom"},{activator:l(({props:r})=>[n("a",x({href:"https://wuyuan.dev/privacy-policy/privacy-policy.html",target:"_blank"},r,{onClick:e[4]||(e[4]=A(()=>{},["stop"]))})," 隐私策略 ",16)]),default:l(()=>[e[13]||(e[13]=i(" 孙悟元网站与服务隐私策略 "))]),_:1,__:[13]})]),o(b,{modelValue:a.agreement.privacy,"onUpdate:modelValue":e[5]||(e[5]=r=>a.agreement.privacy=r)},{label:l(()=>e[15]||(e[15]=[n("div",null,"我已阅读并同意隐私策略",-1)])),_:1},8,["modelValue"]),e[24]||(e[24]=n("div",{class:"mb-4"}," 我们将在中国大陆安全的存储您的数据，我们暂不提供自助删除您的个人数据，如果您希望删除您的数据，您需要优先选择联系我们 ",-1)),o(b,{modelValue:a.agreement.datadelete,"onUpdate:modelValue":e[6]||(e[6]=r=>a.agreement.datadelete=r)},{label:l(()=>e[16]||(e[16]=[n("div",null," 我理解并同意我无法自助删除我的个人数据，在需要时我会主动联系管理员删除 ",-1)])),_:1},8,["modelValue"]),n("div",oe,[e[18]||(e[18]=i(" 在 ZeroCat 上，你需要遵守 ")),o(T,{location:"bottom"},{activator:l(({props:r})=>[n("a",x({href:"https://scratch.mit.edu/community_guidelines",target:"_blank"},r,{onClick:e[7]||(e[7]=A(()=>{},["stop"]))})," 社区行为准则(第三方站点) ",16)]),default:l(()=>[e[17]||(e[17]=i(" 你的当前地区可能无法访问此网站 "))]),_:1,__:[17]})]),o(b,{modelValue:a.agreement.rules,"onUpdate:modelValue":e[8]||(e[8]=r=>a.agreement.rules=r)},{label:l(()=>e[19]||(e[19]=[n("div",null,"我已阅读并同意将会遵守社区行为准则",-1)])),_:1},8,["modelValue"]),n("div",ae,[e[21]||(e[21]=i(" 你需要同意 ")),o(T,{location:"bottom"},{activator:l(({props:r})=>[n("a",x({href:"https://wuyuan.dev/privacy-policy/terms-of-service.html",target:"_blank"},r,{onClick:e[9]||(e[9]=A(()=>{},["stop"]))})," 用户协议 ",16)]),default:l(()=>[e[20]||(e[20]=i(" 孙悟元网站与服务用户协议 "))]),_:1,__:[20]})]),o(b,{modelValue:a.agreement.terms,"onUpdate:modelValue":e[10]||(e[10]=r=>a.agreement.terms=r)},{label:l(()=>e[22]||(e[22]=[n("div",null,"我已阅读并同意用户协议",-1)])),_:1},8,["modelValue"]),o(u,{class:"text-none mt-4",color:"primary",rounded:"xl",text:"注册",variant:"flat",size:"large",onClick:a.register,"append-icon":"mdi-arrow-right",loading:a.loading},null,8,["onClick","loading"]),o(Y,{class:"mt-4",type:"warning",variant:"tonal",border:"start",density:"comfortable"},{default:l(()=>e[23]||(e[23]=[i(' 对于技术手段绕过此页面的行为视为对 ZeroCat 的基础设施进行攻击，涉嫌非法入侵计算机系统，我们将保留追究法律责任的权利，违规获得的账户不被授权访问网站，账户将不受保护，如果您同意以上内容，请点击"复选框"以完成注册流程。 ')])),_:1,__:[23]})]),_:1,__:[24]}),o(H,null,{default:l(()=>[o($),o(u,{text:"取消",onClick:r=>{s.value=!1,a.resetAgreement()}},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1})]),_:1}),o(g,{cols:"12"},{default:l(()=>[o(u,{class:"text-none",color:"white",rounded:"xl",text:"登录",variant:"text",size:"large","append-icon":"mdi-arrow-right",to:"/app/account/login"}),o(u,{class:"text-none",color:"white",rounded:"xl",text:"找回密码",variant:"text",size:"large","append-icon":"mdi-arrow-right",to:"/app/account/retrieve"})]),_:1}),o(g,{cols:"12"},{default:l(()=>[n("div",le,[o(u,{onClick:e[11]||(e[11]=s=>a.registerWithOAuth("microsoft")),color:"blue","prepend-icon":"mdi-microsoft",variant:"flat"},{default:l(()=>e[25]||(e[25]=[i(" Microsoft ")])),_:1,__:[25]}),o(u,{onClick:e[12]||(e[12]=s=>a.registerWithOAuth("github")),color:"black","prepend-icon":"mdi-github",variant:"flat"},{default:l(()=>e[26]||(e[26]=[i(" GitHub ")])),_:1,__:[26]})])]),_:1})]),_:1})]),_:1},512)]),_:1}),o(p,{show:a.loading,text:"正在注册"},null,8,["show"])])}const Re=I(ee,[["render",re]]);export{Re as default};
