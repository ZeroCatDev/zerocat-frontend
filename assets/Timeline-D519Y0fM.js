import{g as w,p as B,bA as ie,aW as Z,bn as se,bm as le,d as N,f as i,C as b,D as C,e as o,O as D,h as ae,bq as J,H as X,bo as Y,K as E,I as Q,bj as oe,A as ne,r as de,w as ce,k as P,G as ee,bk as re,v as me,b3 as ue,bB as _e,b2 as ve,aR as h,x as G,E as ye,J as fe,bs as pe,_ as he,ac as ge,c as p,o as c,N as a,F as z,U as H,Y as x,$ as I,X as s,S as g,L as y,W as S,a3 as V,Z as be,i as xe}from"./index-CEHpVphu.js";const Ce=B({dotColor:String,fillDot:Boolean,hideDot:Boolean,icon:Q,iconColor:String,lineColor:String,...E(),...Y(),...X(),...J()},"VTimelineDivider"),ke=w()({name:"VTimelineDivider",props:Ce(),setup(e,l){let{slots:r}=l;const{sizeClasses:k,sizeStyles:m}=ie(e,"v-timeline-divider__dot"),{backgroundColorStyles:_,backgroundColorClasses:v}=Z(()=>e.dotColor),{roundedClasses:t}=se(e,"v-timeline-divider__dot"),{elevationClasses:f}=le(e),{backgroundColorClasses:j,backgroundColorStyles:T}=Z(()=>e.lineColor);return N(()=>i("div",{class:C(["v-timeline-divider",{"v-timeline-divider--fill-dot":e.fillDot},e.class]),style:b(e.style)},[i("div",{class:C(["v-timeline-divider__before",j.value]),style:b(T.value)},null),!e.hideDot&&i("div",{key:"dot",class:C(["v-timeline-divider__dot",f.value,t.value,k.value]),style:b(m.value)},[i("div",{class:C(["v-timeline-divider__inner-dot",v.value,t.value]),style:b(_.value)},[r.default?o(ae,{key:"icon-defaults",disabled:!e.icon,defaults:{VIcon:{color:e.iconColor,icon:e.icon,size:e.size}}},r.default):o(D,{key:"icon",color:e.iconColor,icon:e.icon,size:e.size},null)])]),i("div",{class:C(["v-timeline-divider__after",j.value]),style:b(T.value)},null)])),{}}}),te=B({density:String,dotColor:String,fillDot:Boolean,hideDot:Boolean,hideOpposite:{type:Boolean,default:void 0},icon:Q,iconColor:String,lineInset:[Number,String],side:{type:String,validator:e=>e==null||["start","end"].includes(e)},...E(),...re(),...J(),...Y(),...X(),...ee()},"VTimelineItem"),je=w()({name:"VTimelineItem",props:te(),setup(e,l){let{slots:r}=l;const{dimensionStyles:k}=oe(e),m=ne(0),_=de();return ce(_,v=>{var t;v&&(m.value=((t=v.$el.querySelector(".v-timeline-divider__dot"))==null?void 0:t.getBoundingClientRect().width)??0)},{flush:"post"}),N(()=>{var v,t;return i("div",{class:C(["v-timeline-item",{"v-timeline-item--fill-dot":e.fillDot,"v-timeline-item--side-start":e.side==="start","v-timeline-item--side-end":e.side==="end"},e.class]),style:b([{"--v-timeline-dot-size":P(m.value),"--v-timeline-line-inset":e.lineInset?`calc(var(--v-timeline-dot-size) / 2 + ${P(e.lineInset)})`:P(0)},e.style])},[i("div",{class:"v-timeline-item__body",style:b(k.value)},[(v=r.default)==null?void 0:v.call(r)]),o(ke,{ref:_,hideDot:e.hideDot,icon:e.icon,iconColor:e.iconColor,size:e.size,elevation:e.elevation,dotColor:e.dotColor,fillDot:e.fillDot,rounded:e.rounded},{default:r.icon}),e.density!=="compact"&&i("div",{class:"v-timeline-item__opposite"},[!e.hideOpposite&&((t=r.opposite)==null?void 0:t.call(r))])])}),{}}}),Te=B({align:{type:String,default:"center",validator:e=>["center","start"].includes(e)},direction:{type:String,default:"vertical",validator:e=>["vertical","horizontal"].includes(e)},justify:{type:String,default:"auto",validator:e=>["auto","center"].includes(e)},side:{type:String,validator:e=>e==null||["start","end"].includes(e)},lineThickness:{type:[String,Number],default:2},lineColor:String,truncateLine:{type:String,validator:e=>["start","end","both"].includes(e)},...pe(te({lineInset:0}),["dotColor","fillDot","hideOpposite","iconColor","lineInset","size"]),...E(),...fe(),...ee(),...ye()},"VTimeline"),De=w()({name:"VTimeline",props:Te(),setup(e,l){let{slots:r}=l;const{themeClasses:k}=me(e),{densityClasses:m}=ue(e),{rtlClasses:_}=_e();ve({VTimelineDivider:{lineColor:h(()=>e.lineColor)},VTimelineItem:{density:h(()=>e.density),dotColor:h(()=>e.dotColor),fillDot:h(()=>e.fillDot),hideOpposite:h(()=>e.hideOpposite),iconColor:h(()=>e.iconColor),lineColor:h(()=>e.lineColor),lineInset:h(()=>e.lineInset),size:h(()=>e.size)}});const v=G(()=>{const f=e.side?e.side:e.density!=="default"?"end":null;return f&&`v-timeline--side-${f}`}),t=G(()=>{const f=["v-timeline--truncate-line-start","v-timeline--truncate-line-end"];switch(e.truncateLine){case"both":return f;case"start":return f[0];case"end":return f[1];default:return null}});return N(()=>o(e.tag,{class:C(["v-timeline",`v-timeline--${e.direction}`,`v-timeline--align-${e.align}`,`v-timeline--justify-${e.justify}`,t.value,{"v-timeline--inset-line":!!e.lineInset},k.value,m.value,v.value,_.value,e.class]),style:b([{"--v-timeline-line-thickness":P(e.lineThickness)},e.style])},r)),{}}}),ze={name:"Timeline",props:{timeline:{type:Object,required:!0,default:()=>({events:[],pagination:{current:1,size:20,total:0}})},isLoadingMore:{type:Boolean,default:!1}},data(){return{VITE_APP_S3_BUCKET:"https://zerocat-bitiful.houlangs.com",eventTypes:{project_create:{text:"创建了新项目",label:"新建",color:"success",isProject:!0},project_publish:{text:"更新了项目",label:"更新",color:"info",isProject:!0},project_fork:{text:"复刻了项目",label:"复刻",color:"warning",isProject:!0},project_delete:{text:"删除了项目",label:"删除",color:"error",isProject:!0},user_profile_update:{text:"更新了个人资料",label:"更新",color:"info"},user_register:{text:"加入了 ZeroCat",label:"注册",color:"primary"},project_commit:{text:"提交了项目更新",label:"提交",color:"info",isProject:!0},project_rename:{text:"重命名了项目",label:"重命名",color:"warning",isProject:!0},project_info_update:{text:"更新了项目信息",label:"更新信息",color:"info",isProject:!0}},fieldDisplayNames:{display_name:"昵称",motto:"个性签名",sex:"性别",birthday:"生日",avatar:"头像",background:"背景图片",email:"邮箱",phone:"手机号",website:"个人网站",bio:"个人简介",social_links:"社交链接",preferences:"偏好设置",visibility:"可见性设置",language:"语言设置"}}},computed:{hasMoreEvents(){return this.timeline.events.length<this.timeline.pagination.total}},methods:{loadMore(){this.$emit("load-more")},getUpdatedFields(e){return e!=null&&e.length?e.map(l=>this.fieldDisplayNames[l]||l).join("、"):""},getTargetContent(e,l){if(!e)return"";switch(e.type){case"project":return e.title||`项目 #${e.id}`;case"user":return e.display_name||`用户 #${e.id}`;case"projectlist":return`项目列表 #${e.id}`;default:return`${e.type} #${e.id}`}},getFieldDisplayName(e){return{title:"标题",description:"描述",type:"类型",state:"状态",visibility:"可见性",tags:"标签",category:"分类"}[e]||e}}},Se={class:"timeline-item-content"},Ve={class:"event-header"},Pe={class:"text-h6"},Ie={class:"project-info"},we={class:"font-weight-medium"},Be={class:"mt-2 text-caption text-medium-emphasis"},Ne={class:"d-flex align-center mb-2"},Ee={class:"font-weight-medium"},Re={class:"rename-details text-body-2"},$e={class:"d-flex align-center"},Fe={class:"d-flex align-center mt-1"},Le={class:"project-meta text-caption text-medium-emphasis mt-2"},Oe={class:"d-flex align-center mb-2"},Me={class:"font-weight-medium"},Ue={class:"commit-message text-body-2"},Ae={class:"commit-hash text-caption text-medium-emphasis mt-1"},qe={class:"d-flex align-center mb-2"},Ke={class:"font-weight-medium"},We={class:"info-updates text-body-2"},Ze={class:"d-flex align-center"},Ge={class:"d-flex flex-column mt-1 field-changes"},He={class:"old-value"},Je={class:"ml-2"},Xe={class:"new-value"},Ye={class:"ml-2 text-info"},Qe={class:"project-meta text-caption text-medium-emphasis mt-2"},et={key:3,class:"event-content pa-2"},tt={key:0,class:"text-body-2"},it={key:1,class:"text-body-2"},st={key:2,class:"text-body-2 text-medium-emphasis"},lt={class:"d-flex justify-center mt-4 mb-4"},at={key:1,class:"text-medium-emphasis"};function ot(e,l,r,k,m,_){const v=ge("router-link");return c(),p(z,null,[o(De,{side:"end",align:"start",class:"mt-4"},{default:a(()=>[(c(!0),p(z,null,H(r.timeline.events,t=>(c(),x(je,{key:t.id,size:"small","dot-color":"primary"},{opposite:a(()=>[y(s(new Date(t.created_at).toLocaleString()),1)]),icon:a(()=>[o(be,{image:m.VITE_APP_S3_BUCKET+"/user/"+t.actor.images},null,8,["image"])]),default:a(()=>{var f,j,T,R,$,F,L,O,M,U,A,q;return[i("div",Se,[i("div",Ve,[i("h3",Pe,s(t.actor.display_name)+" "+s(((f=m.eventTypes[t.type])==null?void 0:f.text)||"进行了操作"),1),o(g,{size:"x-small",color:((j=m.eventTypes[t.type])==null?void 0:j.color)||"primary",class:"ml-2"},{default:a(()=>{var n;return[y(s(((n=m.eventTypes[t.type])==null?void 0:n.label)||t.type),1)]}),_:2},1032,["color"])]),(T=m.eventTypes[t.type])!=null&&T.isProject?(c(),x(v,{key:0,to:`/app/link/project?id=${(R=t.target)==null?void 0:R.id}`,class:"text-decoration-none"},{default:a(()=>{var n;return[y(s((n=t.event_data)==null?void 0:n.project_title),1)]}),_:2},1032,["to"])):I("",!0),l[4]||(l[4]=i("div",{class:"mb-2"},null,-1)),($=m.eventTypes[t.type])!=null&&$.isProject&&!["project_rename","project_commit"].includes(t.type)?(c(),x(S,{key:1,class:"mb-3 project-event",to:`/app/link/project?id=${(F=t.target)==null?void 0:F.id}`},{default:a(()=>[o(V,null,{default:a(()=>{var n,d;return[i("div",Ie,[o(D,{icon:"mdi-source-repository",color:"primary",class:"mr-2"}),i("span",we,s(((n=t.event_data)==null?void 0:n.project_name)||"未命名项目"),1),i("div",Be,s((d=t.event_data)==null?void 0:d.project_description),1)])]}),_:2},1024)]),_:2},1032,["to"])):["project_rename","project_commit","project_info_update"].includes(t.type)?(c(),p(z,{key:2},[t.type==="project_rename"?(c(),x(S,{key:0,class:"rename-card mb-3",to:`/app/link/project?id=${(L=t.target)==null?void 0:L.id}`},{default:a(()=>[o(V,null,{default:a(()=>{var n;return[i("div",Ne,[o(D,{icon:"mdi-rename-box",color:"warning",class:"mr-2"}),i("span",Ee,s((n=t.event_data)==null?void 0:n.project_title),1)]),i("div",Re,[i("div",$e,[l[0]||(l[0]=i("span",{class:"text-medium-emphasis"},"从",-1)),o(g,{size:"small",class:"mx-2",color:"surface-variant"},{default:a(()=>{var d;return[y(s((d=t.event_data)==null?void 0:d.old_name),1)]}),_:2},1024)]),i("div",Fe,[l[1]||(l[1]=i("span",{class:"text-medium-emphasis"},"到",-1)),o(g,{size:"small",class:"mx-2",color:"warning"},{default:a(()=>{var d;return[y(s((d=t.event_data)==null?void 0:d.new_name),1)]}),_:2},1024)])]),i("div",Le,[o(g,{size:"x-small",class:"mr-1"},{default:a(()=>{var d;return[y(s((d=t.event_data)==null?void 0:d.project_type),1)]}),_:2},1024),o(g,{size:"x-small"},{default:a(()=>{var d;return[y(s((d=t.event_data)==null?void 0:d.project_state),1)]}),_:2},1024)])]}),_:2},1024)]),_:2},1032,["to"])):t.type==="project_commit"?(c(),x(S,{key:1,class:"commit-card mb-3",to:`/app/link/project?id=${(O=t.target)==null?void 0:O.id}`},{default:a(()=>[o(V,null,{default:a(()=>{var n,d,u;return[i("div",Oe,[o(D,{icon:"mdi-source-commit",color:"info",class:"mr-2"}),i("span",Me,"分支: "+s((n=t.event_data)==null?void 0:n.branch),1)]),i("div",Ue,s((d=t.event_data)==null?void 0:d.commit_message),1),i("div",Ae," 提交ID: "+s((u=t.event_data)==null?void 0:u.commit_id.substring(0,7)),1)]}),_:2},1024)]),_:2},1032,["to"])):t.type==="project_info_update"?(c(),x(S,{key:2,class:"info-update-card mb-3",to:`/app/link/project?id=${(M=t.target)==null?void 0:M.id}`},{default:a(()=>[o(V,null,{default:a(()=>{var n,d;return[i("div",qe,[o(D,{icon:"mdi-file-document-edit",color:"info",class:"mr-2"}),i("span",Ke,s((n=t.event_data)==null?void 0:n.project_title),1)]),i("div",We,[(c(!0),p(z,null,H((d=t.event_data)==null?void 0:d.updated_fields,u=>{var K,W;return c(),p("div",{key:u,class:"update-item mb-2"},[i("div",Ze,[o(g,{size:"x-small",color:"info",class:"mr-2"},{default:a(()=>[y(s(_.getFieldDisplayName(u)),1)]),_:2},1024)]),i("div",Ge,[i("div",He,[l[2]||(l[2]=i("span",{class:"text-medium-emphasis"},"从：",-1)),i("span",Je,s((K=t.event_data)==null?void 0:K.old_values[u]),1)]),i("div",Xe,[l[3]||(l[3]=i("span",{class:"text-medium-emphasis"},"到：",-1)),i("span",Ye,s((W=t.event_data)==null?void 0:W.new_values[u]),1)])])])}),128))]),i("div",Qe,[o(g,{size:"x-small",class:"mr-1"},{default:a(()=>{var u;return[y(s((u=t.event_data)==null?void 0:u.project_type),1)]}),_:2},1024),o(g,{size:"x-small"},{default:a(()=>{var u;return[y(s((u=t.event_data)==null?void 0:u.project_state),1)]}),_:2},1024)])]}),_:2},1024)]),_:2},1032,["to"])):I("",!0)],64)):(c(),p("div",et,[t.type==="user_profile_update"?(c(),p("div",tt," 更新了："+s(_.getUpdatedFields((U=t.event_data)==null?void 0:U.updated_fields)),1)):((A=t.target)==null?void 0:A.type)==="project"?(c(),p("div",it,[i("span",null,s(((q=m.eventTypes[t.type])==null?void 0:q.text)||"操作了"),1),o(v,{to:`/app/link/project?id=${t.target.id}`,class:"text-decoration-none ml-1"},{default:a(()=>{var n;return[y(s(((n=t.event_data)==null?void 0:n.project_name)||t.target.title||`项目 #${t.target.id}`),1)]}),_:2},1032,["to"])])):(c(),p("div",st,s(_.getTargetContent(t.target,t.type)),1))]))])]}),_:2},1024))),128))]),_:1}),i("div",lt,[_.hasMoreEvents?(c(),x(xe,{key:0,loading:r.isLoadingMore,variant:"tonal",onClick:_.loadMore},{default:a(()=>l[5]||(l[5]=[y(" 加载更多 ")])),_:1,__:[5]},8,["loading","onClick"])):r.timeline.events.length>0?(c(),p("div",at," 没有更多内容了 ")):I("",!0)])],64)}const dt=he(ze,[["render",ot],["__scopeId","data-v-ca64bb38"]]);export{dt as _};
