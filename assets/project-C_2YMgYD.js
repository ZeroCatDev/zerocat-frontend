import{f as _,a as v,r as k,b as I,l as x,D as F}from"./project-D59TWirU.js";import{bS as N,o as u,c as n,w as e,a as s,cD as m,O as l,cr as f,cs as j,cj as d,cB as V,A as P,aZ as h,F as y,cm as p,G as w,bc as a,z as L,cn as D,cG as C,cH as S}from"./index-B2HYbJQK.js";import{V as g}from"./VForm-CBOOA0K3.js";import{V as B}from"./VAlert-BPnH0psq.js";import{V as Q}from"./VContainer-WBUV_8zJ.js";import"./db-yuhU7b6o.js";/* empty css              */const T={data(){return{inputValue:"",projects:[],allProjects:[],status:"",ProjectID:0,liveQuerySubscription:null,allProjectsSubscription:null}},methods:{async fetchProjects(){const o=this.inputValue.split(",").map(b=>Number(b.trim())),t=await _(o);typeof t=="object"&&!Array.isArray(t)?this.projects=[t]:this.projects=t},async addProject(){const o={id:Number(this.ProjectID),title:"测试项目",description:"这是一个测试项目",authorid:1,type:"text",licence:"MIT",state:"public",view_count:0,time:new Date().toISOString(),tags:[],source:"test"};this.status=await v(o)},async removeProject(){this.status=await k(Number(this.ProjectID)),this.ProjectID=0},async refreshProject(){this.status=await I(Number(this.ProjectID))},startLiveFetch(){const o=this.inputValue.split(",").map(t=>Number(t.trim()));this.liveQuerySubscription&&this.liveQuerySubscription.unsubscribe(),this.liveQuerySubscription=x(o,t=>{this.projects=t}),this.allProjectsSubscription&&this.allProjectsSubscription.unsubscribe(),this.allProjectsSubscription=F(t=>{this.allProjects=t})}},mounted(){this.startLiveFetch()},beforeDestroy(){this.liveQuerySubscription&&this.liveQuerySubscription.unsubscribe(),this.allProjectsSubscription&&this.allProjectsSubscription.unsubscribe()}},A={class:"d-flex gap-2"};function G(o,t,b,O,i,c){return u(),n(Q,null,{default:e(()=>[s(p,{border:""},{default:e(()=>[s(m,null,{default:e(()=>t[2]||(t[2]=[l("实时获取缓存的项目数据")])),_:1}),s(f,null,{default:e(()=>[s(j,{modelValue:i.inputValue,"onUpdate:modelValue":t[0]||(t[0]=r=>i.inputValue=r),label:"输入项目ID",class:"mb-4"},null,8,["modelValue"]),s(d,{onClick:c.startLiveFetch,color:"primary",class:"mb-4"},{default:e(()=>t[3]||(t[3]=[l("实时获取数据")])),_:1},8,["onClick"]),s(V,null,{default:e(()=>[(u(!0),P(y,null,h(i.projects,r=>(u(),n(D,{key:r.id},{default:e(()=>[s(C,null,{default:e(()=>[l(a(r.title||"未缓存"),1)]),_:2},1024),s(S,null,{default:e(()=>[l(a(r.description||""),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),s(p,{class:"mt-4",border:""},{default:e(()=>[s(m,null,{default:e(()=>t[4]||(t[4]=[l("添加缓存的项目数据")])),_:1}),s(f,null,{default:e(()=>[s(g,null,{default:e(()=>[s(j,{modelValue:i.ProjectID,"onUpdate:modelValue":t[1]||(t[1]=r=>i.ProjectID=r),label:"项目ID",type:"number",required:""},null,8,["modelValue"]),w("div",A,[s(d,{onClick:c.addProject,color:"primary"},{default:e(()=>t[5]||(t[5]=[l("添加")])),_:1},8,["onClick"]),s(d,{onClick:c.removeProject,color:"error"},{default:e(()=>t[6]||(t[6]=[l("删除")])),_:1},8,["onClick"]),s(d,{onClick:c.refreshProject,color:"info"},{default:e(()=>t[7]||(t[7]=[l("刷新")])),_:1},8,["onClick"])]),i.status?(u(),n(B,{key:0,type:i.status.includes("成功")?"success":"error",class:"mt-4"},{default:e(()=>[l(a(i.status),1)]),_:1},8,["type"])):L("",!0)]),_:1})]),_:1})]),_:1}),s(p,{class:"mt-4",border:""},{default:e(()=>[s(m,null,{default:e(()=>t[8]||(t[8]=[l("所有缓存的项目数据")])),_:1}),s(f,null,{default:e(()=>[s(V,null,{default:e(()=>[(u(!0),P(y,null,h(i.allProjects,r=>(u(),n(D,{key:r.id},{default:e(()=>[s(C,null,{default:e(()=>[l(a(r.title||"未缓存"),1)]),_:2},1024),s(S,null,{default:e(()=>[l(a(r.description||""),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})}const J=N(T,[["render",G]]);export{J as default};
