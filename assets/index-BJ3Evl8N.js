import{a as S,_ as D}from"./Comment-C211LHrv.js";import{_ as N}from"./NewProjectList-4GjXu8oh.js";import{_ as T,H as y,J as d,o as n,c as m,w as o,a as t,M as f,Y as G,L as i,T as a,$ as H,a0 as M,a1 as q,a2 as z,e as j,R as B,S as A,Q as P,a3 as J,a4 as K,a5 as O,G as Q,P as L,a6 as w,a7 as k,a8 as I,K as c,U as b,O as C,a9 as g}from"./index-McIR37H2.js";import{V as Y}from"./VDialog-DA6NVbOG.js";import{P as F}from"./ProjectRunner-BO-rQ9qN.js";import{o as W}from"./openEdit-AJJkPSPH.js";import{g as X}from"./project-RPQnsqkQ.js";import{a as Z}from"./user-EltLbxNK.js";import{a as x,V as $}from"./VRow-C5BVDfSN.js";import{V as u}from"./VChip-CldXOKXt.js";import{V as tt}from"./VContainer-BDwi8ZAh.js";import"./VForm-DEv4oXnD.js";import"./VTextarea-CLO8Q9uU.js";import"./VSpacer-CAKtwwcK.js";/* empty css              */const et={components:{NewProjectList:N},name:"ProjectStar",props:{projectId:{type:Number,required:!0}},data(){return{localuser:y,userinfo:y.user,newProjectListDialog:!1,star:!1,starinfo:{},projectLists:[]}},watch:{projectId:{immediate:!0,handler(s){this.getStarStatus(s),this.getProjectList(s)}}},methods:{getStarStatus(s){d({url:`/projectlist/checkstar?projectid=${s}`,method:"get"}).then(r=>{this.star=r.data.star,this.starinfo=r.data})},ToggleStarProject(){this.star==0?d({url:"/projectlist/star",method:"post",data:{projectid:this.projectId}}).then(s=>{this.star=s.data.star,this.starinfo.count=Number(this.starinfo.count)+1}):d({url:"/projectlist/unstar",method:"post",data:{projectid:this.projectId}}).then(s=>{this.star=s.data.star,this.starinfo.count=Number(this.starinfo.count)-1})},async getProjectList(s){this.projectLists=(await d({url:"/projectlist/check?projectid="+s,method:"get"})).data.data},async addProjectToList(s){await d({url:"/projectlist/add",data:{userid:this.userinfo.id,projectid:this.projectId,listid:s},method:"post"}).then(r=>{this.$toast.add({severity:"info",summary:"info",detail:r.data.message,life:3e3}),this.getProjectList(this.projectId)})},async removeProjectFromList(s){await d({url:"/projectlist/remove",data:{projectid:this.projectId,listid:s},method:"post"}).then(r=>{this.$toast.add({severity:"info",summary:"info",detail:r.data.message,life:3e3}),this.getProjectList(this.projectId)})}}};function ot(s,r,_,E,e,p){const h=N;return n(),m(O,{border:"",density:"compact",rounded:"lg",size:"x-small"},{default:o(()=>[t(f,{onClick:r[0]||(r[0]=l=>p.ToggleStarProject()),variant:"tonal",class:"text-none",text:"Star"},{prepend:o(()=>[t(G,{icon:e.star?"mdi-star":"mdi-star-outline",color:e.star?"yellow":""},null,8,["icon","color"])]),default:o(()=>[i(a(e.star?"Starred":"Star")+" "+a(e.starinfo.count),1)]),_:1}),r[4]||(r[4]=i()),t(H,{color:"surface-light",vertical:""}),t(M,{"close-on-content-click":!1},{activator:o(({props:l})=>[t(f,q({class:"px-5",icon:"mdi-menu-down"},l),null,16)]),default:o(()=>[t(z,null,{default:o(()=>[(n(!0),j(B,null,A(e.projectLists,l=>(n(),j("div",{key:l.id},[t(P,{"append-icon":l.include==!0?"mdi-minus-circle":"mdi-plus-circle",active:l.include==!0,color:"primary",onClick:v=>l.include==!0?p.removeProjectFromList(l.id):p.addProjectToList(l.id)},{default:o(()=>[t(J,null,{default:o(()=>[i(a(l.title),1)]),_:2},1024),t(K,null,{default:o(()=>[i(a(l.description),1)]),_:2},1024)]),_:2},1032,["append-icon","active","onClick"])]))),128)),t(P,{onClick:r[1]||(r[1]=l=>e.newProjectListDialog=!0)},{default:o(()=>r[3]||(r[3]=[i("新建列表")])),_:1})]),_:1}),t(Y,{modelValue:e.newProjectListDialog,"onUpdate:modelValue":r[2]||(r[2]=l=>e.newProjectListDialog=l)},{default:o(()=>[t(h,{listid:s.editlistid,close:()=>e.newProjectListDialog=!1,callback:p.getProjectList},null,8,["listid","close","callback"])]),_:1},8,["modelValue"])]),_:1})]),_:1})}const R=T(et,[["render",ot]]),rt={components:{ProjectRunner:F,TimeAgo:S,Comment:D,ProjectStar:R},data(){return{projectid:this.$route.params.id,project:{},author:{},openEditor:W,localuser:y}},async mounted(){this.fetchProjectAndAuthorDetails()},methods:{async fetchProjectAndAuthorDetails(){const s=this.$route.params.username,r=this.$route.params.projectname,_=await X(s,r);this.project=_,this.projectid=this.project.id,Q({title:this.project.title}),this.author=await Z(this.project.authorid)}}},st={class:"px-4 d-flex ga-2 mb-2"},it={class:"px-4 d-flex ga-2 mb-2"},lt={class:"px-4 d-flex ga-2 mb-2"},at={class:"px-4 d-flex ga-2 mb-2"},nt={class:"px-4 d-flex ga-2 mb-2"},ct={class:"px-4"};function ut(s,r,_,E,e,p){const h=F,l=S,v=R,U=D;return n(),m(tt,null,{default:o(()=>[t($,null,{default:o(()=>[t(x,{xs:"12",sm:"12",md:"8",lg:"8",xl:"8",xxl:"8",cols:"12"},{default:o(()=>[t(h,{type:e.project.type,id:e.project.id},null,8,["type","id"])]),_:1}),t(x,{xs:"12",sm:"12",md:"4",lg:"4",xl:"4",xxl:"8",cols:"12"},{default:o(()=>[t(L,{hover:"",border:""},{default:o(()=>[t(w,null,{default:o(()=>[t(k,null,{default:o(()=>[i(a(e.project.title),1)]),_:1}),t(I,null,{default:o(()=>[i(a(e.project.description),1)]),_:1})]),_:1}),c("div",st,[t(u,{pill:""},{default:o(()=>[t(b,{start:""},{default:o(()=>[t(C,{src:"https://s4-1.wuyuan.1r.ink/user/"+e.author.images},null,8,["src"])]),_:1}),i(a(e.author.display_name),1)]),_:1})]),c("div",it,[t(u,{pill:"","prepend-icon":"mdi-eye"},{default:o(()=>[i(a(e.project.view_count)+"浏览",1)]),_:1}),t(u,{pill:"","prepend-icon":"mdi-clock"},{default:o(()=>[t(l,{date:e.project.time},null,8,["date"])]),_:1})]),c("div",lt,[e.project.state=="public"?(n(),m(u,{key:0,pill:"","prepend-icon":"mdi-xml"},{default:o(()=>r[1]||(r[1]=[i("开源作品")])),_:1})):g("",!0),e.project.state=="private"?(n(),m(u,{key:1,pill:"","prepend-icon":"mdi-xml"},{default:o(()=>r[2]||(r[2]=[i("私密作品")])),_:1})):g("",!0),t(u,{pill:"","prepend-icon":"mdi-application"},{default:o(()=>[i(a(e.project.type),1)]),_:1})]),c("div",at,[(n(!0),j(B,null,A(e.project.tags,V=>(n(),j("div",null,[t(u,null,{default:o(()=>[i(a(V.name),1)]),_:2},1024)]))),256))]),c("div",nt,[t(v,{projectId:e.project.id},null,8,["projectId"]),t(f,{onClick:r[0]||(r[0]=V=>e.openEditor(e.project.id,e.project.type)),variant:"text"},{default:o(()=>r[3]||(r[3]=[i("打开创造页")])),_:1}),e.project.authorid!=e.localuser.user.id?(n(),m(f,{key:0,to:`${e.project.authorid}/${e.projectid}/fork`,variant:"text"},{default:o(()=>r[4]||(r[4]=[i("改编")])),_:1},8,["to"])):g("",!0)]),c("div",ct,[t(L,{hover:"",to:"/"+e.author.username,border:""},{default:o(()=>[t(w,null,{prepend:o(()=>[t(b,null,{default:o(()=>[t(C,{alt:e.author.display_name,src:"https://s4-1.wuyuan.1r.ink/user/"+e.author.images},null,8,["alt","src"])]),_:1})]),default:o(()=>[t(k,{class:"text-white"},{default:o(()=>[i(a(e.author.display_name),1)]),_:1}),t(I,{class:"text-white"},{default:o(()=>[i(a(e.author.motto),1)]),_:1})]),_:1})]),_:1},8,["to"])]),r[5]||(r[5]=c("br",null,null,-1))]),_:1})]),_:1}),t(x,{xxl:"8",xl:"8",lg:"8",md:"8",sm:"12",xs:"12",cols:"12"},{default:o(()=>[t(U,{url:"project-"+e.project.id,name:"项目"},null,8,["url"])]),_:1})]),_:1})]),_:1})}const kt=T(rt,[["render",ut]]);export{kt as default};
