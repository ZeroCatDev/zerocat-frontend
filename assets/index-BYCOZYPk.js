import{a as I,_ as B}from"./Comment-Cosp12om.js";import{_ as v}from"./NewProjectList-CfczT0nz.js";import{_ as w,H as f,J as p,o as n,e as m,a as t,w as o,T as j,U,S as b,Y as J,O as s,W as a,Z as M,$ as O,N as P,G as D,c as h,R as g,a0 as S,a1 as T,a2 as A,L as u,M as N,Q as F,a3 as x}from"./index-BCTby3dE.js";import{V as Q}from"./VDialog-CKXZOjWH.js";import{P as R}from"./ProjectRunner-DNOUsXfH.js";import{o as W}from"./openEdit-AJJkPSPH.js";import{g as Y,f as $,r as q}from"./project-BO7IzGRL.js";import{g as z,f as K,r as X}from"./user-DBAHe5vT.js";import{a as y,V as tt}from"./VRow-DZNmoO6E.js";import{V as c}from"./VChip-DrWAr2l_.js";import{V as et}from"./VContainer-CBmaW0B1.js";import"./VForm-ptU1Z9xO.js";import"./VTextarea-BQ6YTVjw.js";import"./VSpacer-CjYI8-lE.js";/* empty css              */import"./db-DpJXrf9B.js";const ot={components:{NewProjectList:v},name:"addtolist",data(){return{localuser:f,userinfo:f.user,newProjectListDialog:!1,projectLists:[]}},methods:{async getProjectList(){this.projectLists=(await p({url:"/projectlist/check?projectid="+this.$route.params.id,method:"get"})).data},async addProjectToList(i){await p({url:"/projectlist/add",data:{userid:this.userinfo.id,projectid:this.$route.params.id,listid:i},method:"post"}).then(r=>{this.$toast.add({severity:"info",summary:"info",detail:r.message,life:3e3}),this.getProjectList()})},async removeProjectFromList(i){await p({url:"/projectlist/remove",data:{projectid:this.$route.params.id,listid:i},method:"post"}).then(r=>{this.$toast.add({severity:"info",summary:"info",detail:r.message,life:3e3}),this.getProjectList()})}},mounted(){this.getProjectList()}};function rt(i,r,L,V,e,d){const _=v;return n(),m(j,null,[t(O,null,{default:o(()=>[(n(!0),m(j,null,U(e.projectLists,l=>(n(),m("div",{key:l.id},[t(b,{"append-icon":l.include==!0?"mdi-minus-circle":"mdi-plus-circle",active:l.include==!0,color:"primary",onClick:C=>l.include==!0?d.removeProjectFromList(l.id):d.addProjectToList(l.id)},{default:o(()=>[t(J,null,{default:o(()=>[s(a(l.title),1)]),_:2},1024),t(M,null,{default:o(()=>[s(a(l.description),1)]),_:2},1024)]),_:2},1032,["append-icon","active","onClick"])]))),128)),t(b,{onClick:r[0]||(r[0]=l=>e.newProjectListDialog=!0)},{default:o(()=>r[2]||(r[2]=[s("新建列表")])),_:1})]),_:1}),t(Q,{modelValue:e.newProjectListDialog,"onUpdate:modelValue":r[1]||(r[1]=l=>e.newProjectListDialog=l)},{default:o(()=>[t(_,{listid:i.editlistid,close:()=>e.newProjectListDialog=!1,callback:d.getProjectList},null,8,["listid","close","callback"])]),_:1},8,["modelValue"])],64)}const E=w(ot,[["render",rt]]),st={components:{NewProjectList:v},name:"addtolist",data(){return{localuser:f,userinfo:f.user,newProjectListDialog:!1,projectLists:"",star:!1}},methods:{getStarStatus(){p({url:`/projectlist/checkstar?projectid=${this.$route.params.id}`,method:"get"}).then(i=>{this.star=i.star})},ToggleStarProject(){this.star==0?p({url:"/projectlist/star",method:"post",data:{projectid:this.$route.params.id}}).then(i=>{this.star=i.star}):p({url:"/projectlist/unstar",method:"post",data:{projectid:this.$route.params.id}}).then(i=>{this.star=i.star})}},mounted(){this.getStarStatus()}};function it(i,r,L,V,e,d){return n(),m(j,null,[t(P,{onClick:r[0]||(r[0]=_=>d.ToggleStarProject()),color:e.star?"yellow":"","prepend-icon":"mdi-star",variant:"tonal"},{default:o(()=>r[1]||(r[1]=[s("Star")])),_:1},8,["color"]),s(a(e.projectLists),1)],64)}const H=w(st,[["render",it]]),lt={components:{ProjectRunner:R,TimeAgo:I,Comment:B,AddTolist:E,ProjectStar:H},data(){return{projectid:this.$route.params.id,project:{id:1,authorid:1,time:"2000-01-01T00:00:00.000Z",view_count:0,like_count:0,type:"text",favo_count:0,title:"",state:"public",description:"",license:"",tags:"",likeid:"",favoid:""},author:{id:1,display_name:"",motto:"",images:""},communityinfo:{stars:""},openEditor:W,localuser:f}},async mounted(){await this.refreshProject(),this.fetchProjectAndAuthorDetails()},methods:{async fetchProjectAndAuthorDetails(){const i=Number(this.$route.params.id);this.project=await Y(i),D({title:this.project.title}),this.author=await z(this.project.authorid);const r=await $(i);this.project=r,D({title:this.project.title}),this.author=await K(this.project.authorid)},async refreshProject(){await q(this.$route.params.id),await this.refreshAuthor()},async refreshAuthor(){await X(this.project.authorid)}}},at={class:"px-4 d-flex ga-2 mb-2"},nt={class:"px-4 d-flex ga-2 mb-2"},ut={class:"px-4 d-flex ga-2 mb-2"},ct={class:"px-4 d-flex ga-2 mb-2"},dt={class:"px-4 d-flex ga-2 mb-2"},pt={class:"px-4"};function mt(i,r,L,V,e,d){const _=R,l=I,C=H,Z=E,G=B;return n(),h(et,null,{default:o(()=>[t(tt,null,{default:o(()=>[t(y,{xs:"12",sm:"12",md:"8",lg:"8",xl:"8",xxl:"8",cols:"12"},{default:o(()=>[t(_,{type:e.project.type,id:e.project.id},null,8,["type","id"])]),_:1}),t(y,{xs:"12",sm:"12",md:"4",lg:"4",xl:"4",xxl:"8",cols:"12"},{default:o(()=>[t(g,{hover:"",border:""},{default:o(()=>[t(S,null,{default:o(()=>[t(T,null,{default:o(()=>[s(a(e.project.title),1)]),_:1}),t(A,null,{default:o(()=>[s(a(e.project.description),1)]),_:1})]),_:1}),u("div",at,[t(c,{pill:""},{default:o(()=>[t(N,{start:""},{default:o(()=>[t(F,{src:"https://s4-1.wuyuan.1r.ink/user/"+e.author.images},null,8,["src"])]),_:1}),s(a(e.author.display_name),1)]),_:1})]),u("div",nt,[t(c,{pill:"","prepend-icon":"mdi-eye"},{default:o(()=>[s(a(e.project.view_count)+"浏览",1)]),_:1}),t(c,{pill:"","prepend-icon":"mdi-star"},{default:o(()=>[s(a(e.communityinfo.stars)+" Star",1)]),_:1}),t(c,{pill:"","prepend-icon":"mdi-clock"},{default:o(()=>[t(l,{date:e.project.time},null,8,["date"])]),_:1})]),u("div",ut,[e.project.state=="public"?(n(),h(c,{key:0,pill:"","prepend-icon":"mdi-xml"},{default:o(()=>r[1]||(r[1]=[s("开源作品")])),_:1})):x("",!0),e.project.state=="private"?(n(),h(c,{key:1,pill:"","prepend-icon":"mdi-xml"},{default:o(()=>r[2]||(r[2]=[s("私密作品")])),_:1})):x("",!0),t(c,{pill:"","prepend-icon":"mdi-application"},{default:o(()=>[s(a(e.project.type),1)]),_:1})]),u("div",ct,[(n(!0),m(j,null,U(e.project.tags,k=>(n(),m("div",null,[t(c,null,{default:o(()=>[s(a(k.name),1)]),_:2},1024)]))),256))]),u("div",dt,[t(C),t(P,{onClick:r[0]||(r[0]=k=>e.openEditor(e.project.id,e.project.type)),variant:"text"},{default:o(()=>r[3]||(r[3]=[s("打开创造页")])),_:1}),e.project.authorid!=e.localuser.user.id?(n(),h(P,{key:0,to:`${e.project.authorid}/${e.projectid}/fork`,variant:"text"},{default:o(()=>r[4]||(r[4]=[s("改编")])),_:1},8,["to"])):x("",!0)]),u("div",pt,[t(g,{hover:"",to:"/"+e.project.authorid,border:""},{default:o(()=>[t(S,null,{prepend:o(()=>[t(N,null,{default:o(()=>[t(F,{alt:e.author.display_name,src:"https://s4-1.wuyuan.1r.ink/user/"+e.author.images},null,8,["alt","src"])]),_:1})]),default:o(()=>[t(T,{class:"text-white"},{default:o(()=>[s(a(e.author.display_name),1)]),_:1}),t(A,{class:"text-white"},{default:o(()=>[s(a(e.author.motto),1)]),_:1})]),_:1})]),_:1},8,["to"])]),r[5]||(r[5]=u("br",null,null,-1))]),_:1}),r[6]||(r[6]=u("br",null,null,-1)),t(g,{hover:"",border:""},{default:o(()=>[t(Z)]),_:1})]),_:1}),t(y,{xxl:"8",xl:"8",lg:"8",md:"8",sm:"12",xs:"12",cols:"12"},{default:o(()=>[t(G,{url:"project-"+i.$route.params.id,name:"项目"},null,8,["url"])]),_:1})]),_:1})]),_:1})}const St=w(lt,[["render",mt]]);export{St as default};
