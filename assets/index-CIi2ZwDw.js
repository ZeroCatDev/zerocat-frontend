import{a as I,_ as B}from"./Comment-BfNHbsOU.js";import{_ as v}from"./NewProjectList-sDhMRbul.js";import{_ as w,H as f,J as p,o as n,e as m,a as t,w as o,R as j,S as U,Q as b,X as J,L as s,T as l,Y as K,Z as M,M as P,G as D,c as h,P as g,$ as S,a0 as T,a1 as A,K as u,U as F,O as N,a2 as x}from"./index-DYKdaqCf.js";import{V as O}from"./VDialog-BUdJTBxv.js";import{P as R}from"./ProjectRunner-DFqmPJhj.js";import{o as Q}from"./openEdit-AJJkPSPH.js";import{g as X,f as Y,r as $}from"./project-iyR4pEb4.js";import{g as q,f as z,r as W}from"./user-Wl8jqrSe.js";import{a as y,V as tt}from"./VRow-2dIRckCl.js";import{V as d}from"./VChip-BMYOdONF.js";import{V as et}from"./VContainer-BKu9Q8Wt.js";import"./VForm-DbmWM3RE.js";import"./VTextarea-BkhIz5Of.js";import"./VSpacer-B1NaiRLv.js";/* empty css              */import"./db-MR73Nnh-.js";const ot={components:{NewProjectList:v},name:"addtolist",data(){return{localuser:f,userinfo:f.user,newProjectListDialog:!1,projectLists:[]}},methods:{async getProjectList(){this.projectLists=(await p({url:"/projectlist/check?projectid="+this.$route.params.id,method:"get"})).data.data},async addProjectToList(i){await p({url:"/projectlist/add",data:{userid:this.userinfo.id,projectid:this.$route.params.id,listid:i},method:"post"}).then(r=>{this.$toast.add({severity:"info",summary:"info",detail:r.data.message,life:3e3}),this.getProjectList()})},async removeProjectFromList(i){await p({url:"/projectlist/remove",data:{projectid:this.$route.params.id,listid:i},method:"post"}).then(r=>{this.$toast.add({severity:"info",summary:"info",detail:r.data.message,life:3e3}),this.getProjectList()})}},mounted(){this.getProjectList()}};function rt(i,r,L,V,e,c){const _=v;return n(),m(j,null,[t(M,null,{default:o(()=>[(n(!0),m(j,null,U(e.projectLists,a=>(n(),m("div",{key:a.id},[t(b,{"append-icon":a.include==!0?"mdi-minus-circle":"mdi-plus-circle",active:a.include==!0,color:"primary",onClick:C=>a.include==!0?c.removeProjectFromList(a.id):c.addProjectToList(a.id)},{default:o(()=>[t(J,null,{default:o(()=>[s(l(a.title),1)]),_:2},1024),t(K,null,{default:o(()=>[s(l(a.description),1)]),_:2},1024)]),_:2},1032,["append-icon","active","onClick"])]))),128)),t(b,{onClick:r[0]||(r[0]=a=>e.newProjectListDialog=!0)},{default:o(()=>r[2]||(r[2]=[s("新建列表")])),_:1})]),_:1}),t(O,{modelValue:e.newProjectListDialog,"onUpdate:modelValue":r[1]||(r[1]=a=>e.newProjectListDialog=a)},{default:o(()=>[t(_,{listid:i.editlistid,close:()=>e.newProjectListDialog=!1,callback:c.getProjectList},null,8,["listid","close","callback"])]),_:1},8,["modelValue"])],64)}const E=w(ot,[["render",rt]]),st={components:{NewProjectList:v},name:"addtolist",data(){return{localuser:f,userinfo:f.user,newProjectListDialog:!1,projectLists:"",star:!1}},methods:{getStarStatus(){p({url:`/projectlist/checkstar?projectid=${this.$route.params.id}`,method:"get"}).then(i=>{this.star=i.data.star})},ToggleStarProject(){this.star==0?p({url:"/projectlist/star",method:"post",data:{projectid:this.$route.params.id}}).then(i=>{this.star=i.data.star}):p({url:"/projectlist/unstar",method:"post",data:{projectid:this.$route.params.id}}).then(i=>{this.star=i.data.star})}},mounted(){this.getStarStatus()}};function it(i,r,L,V,e,c){return n(),m(j,null,[t(P,{onClick:r[0]||(r[0]=_=>c.ToggleStarProject()),color:e.star?"yellow":"","prepend-icon":"mdi-star",variant:"tonal"},{default:o(()=>r[1]||(r[1]=[s("Star")])),_:1},8,["color"]),s(l(e.projectLists),1)],64)}const H=w(st,[["render",it]]),at={components:{ProjectRunner:R,TimeAgo:I,Comment:B,AddTolist:E,ProjectStar:H},data(){return{projectid:this.$route.params.id,project:{id:1,authorid:1,time:"2000-01-01T00:00:00.000Z",view_count:0,like_count:0,type:"text",favo_count:0,title:"",state:"public",description:"",license:"",tags:"",likeid:"",favoid:""},author:{id:1,display_name:"",motto:"",images:""},communityinfo:{stars:""},openEditor:Q,localuser:f}},async mounted(){await this.refreshProject(),this.fetchProjectAndAuthorDetails()},methods:{async fetchProjectAndAuthorDetails(){const i=Number(this.$route.params.id);this.project=await X(i),D({title:this.project.title}),this.author=await q(this.project.authorid);const r=await Y(i);this.project=r,D({title:this.project.title}),this.author=await z(this.project.authorid)},async refreshProject(){await $(this.$route.params.id),await this.refreshAuthor()},async refreshAuthor(){await W(this.project.authorid)}}},lt={class:"px-4 d-flex ga-2 mb-2"},nt={class:"px-4 d-flex ga-2 mb-2"},ut={class:"px-4 d-flex ga-2 mb-2"},dt={class:"px-4 d-flex ga-2 mb-2"},ct={class:"px-4 d-flex ga-2 mb-2"},pt={class:"px-4"};function mt(i,r,L,V,e,c){const _=R,a=I,C=H,Z=E,G=B;return n(),h(et,null,{default:o(()=>[t(tt,null,{default:o(()=>[t(y,{xs:"12",sm:"12",md:"8",lg:"8",xl:"8",xxl:"8",cols:"12"},{default:o(()=>[t(_,{type:e.project.type,id:e.project.id},null,8,["type","id"])]),_:1}),t(y,{xs:"12",sm:"12",md:"4",lg:"4",xl:"4",xxl:"8",cols:"12"},{default:o(()=>[t(g,{hover:"",border:""},{default:o(()=>[t(S,null,{default:o(()=>[t(T,null,{default:o(()=>[s(l(e.project.title),1)]),_:1}),t(A,null,{default:o(()=>[s(l(e.project.description),1)]),_:1})]),_:1}),u("div",lt,[t(d,{pill:""},{default:o(()=>[t(F,{start:""},{default:o(()=>[t(N,{src:"https://s4-1.wuyuan.1r.ink/user/"+e.author.images},null,8,["src"])]),_:1}),s(l(e.author.display_name),1)]),_:1})]),u("div",nt,[t(d,{pill:"","prepend-icon":"mdi-eye"},{default:o(()=>[s(l(e.project.view_count)+"浏览",1)]),_:1}),t(d,{pill:"","prepend-icon":"mdi-star"},{default:o(()=>[s(l(e.communityinfo.stars)+" Star",1)]),_:1}),t(d,{pill:"","prepend-icon":"mdi-clock"},{default:o(()=>[t(a,{date:e.project.time},null,8,["date"])]),_:1})]),u("div",ut,[e.project.state=="public"?(n(),h(d,{key:0,pill:"","prepend-icon":"mdi-xml"},{default:o(()=>r[1]||(r[1]=[s("开源作品")])),_:1})):x("",!0),e.project.state=="private"?(n(),h(d,{key:1,pill:"","prepend-icon":"mdi-xml"},{default:o(()=>r[2]||(r[2]=[s("私密作品")])),_:1})):x("",!0),t(d,{pill:"","prepend-icon":"mdi-application"},{default:o(()=>[s(l(e.project.type),1)]),_:1})]),u("div",dt,[(n(!0),m(j,null,U(e.project.tags,k=>(n(),m("div",null,[t(d,null,{default:o(()=>[s(l(k.name),1)]),_:2},1024)]))),256))]),u("div",ct,[t(C),t(P,{onClick:r[0]||(r[0]=k=>e.openEditor(e.project.id,e.project.type)),variant:"text"},{default:o(()=>r[3]||(r[3]=[s("打开创造页")])),_:1}),e.project.authorid!=e.localuser.user.id?(n(),h(P,{key:0,to:`${e.project.authorid}/${e.projectid}/fork`,variant:"text"},{default:o(()=>r[4]||(r[4]=[s("改编")])),_:1},8,["to"])):x("",!0)]),u("div",pt,[t(g,{hover:"",to:"/"+e.project.authorid,border:""},{default:o(()=>[t(S,null,{prepend:o(()=>[t(F,null,{default:o(()=>[t(N,{alt:e.author.display_name,src:"https://s4-1.wuyuan.1r.ink/user/"+e.author.images},null,8,["alt","src"])]),_:1})]),default:o(()=>[t(T,{class:"text-white"},{default:o(()=>[s(l(e.author.display_name),1)]),_:1}),t(A,{class:"text-white"},{default:o(()=>[s(l(e.author.motto),1)]),_:1})]),_:1})]),_:1},8,["to"])]),r[5]||(r[5]=u("br",null,null,-1))]),_:1}),r[6]||(r[6]=u("br",null,null,-1)),t(g,{hover:"",border:""},{default:o(()=>[t(Z)]),_:1})]),_:1}),t(y,{xxl:"8",xl:"8",lg:"8",md:"8",sm:"12",xs:"12",cols:"12"},{default:o(()=>[t(G,{url:"project-"+i.$route.params.id,name:"项目"},null,8,["url"])]),_:1})]),_:1})]),_:1})}const St=w(at,[["render",mt]]);export{St as default};
