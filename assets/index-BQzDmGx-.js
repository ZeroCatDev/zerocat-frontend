import{_ as h,a as _}from"./ProjectPlayer-DaUZWjgF.js";import{_ as y,Y as x,o as g,N as e,e as o,Q as P,R as l,f as s,aB as b,i as p,m as V,L as m,X as u,O as d,W as C,a3 as $,T as v,aw as B,ax as f,aK as N,M as z,az as k,ao as T}from"./index-CSzZWmxC.js";import"./UserRelationControls-Csug_rBp.js";import"./VTextarea-D5bPKdWc.js";import"./VSpacer-DQEjKUok.js";import"./projectListService-CfbF9sfD.js";import"./VSelect-BlpDaiBu.js";import"./VCheckboxBtn-CCF6t_zf.js";import"./VSelectionControl-BHdotmZa.js";import"./TimeAgo-BB12odjR.js";import"./openEdit-AJJkPSPH.js";const H={components:{ProjectPlayer:_,ProjectInfoCard:h},data(){return{project:{},author:{},localuser:T,showplayer:!0,commitInfo:null,initProject:k}},async mounted(){await this.initlizeProject()},methods:{async initlizeProject(){const r=this.$route.params.username,n=this.$route.params.projectname,a=this.$route.params.commitId;if(r==="proxy"){this.$router.replace(`/app${this.$route.path}`);return}const i=await B(r,n);if(i.id===0){f.show404();return}if(this.project=i,this.project.default_branch==null){this.showplayer=!1;return}if(this.commitInfo=await N(this.project.id,a),!this.commitInfo){f.show404();return}z({title:`${this.project.title} at ${this.commitInfo.commit_message}`}),this.author=this.project.author}},watch:{"$route.params.commitId":{handler:async function(r){await this.initlizeProject()},immediate:!0}}},M={style:{display:"flex","justify-content":"space-between"},class:"mb-2"};function R(r,n,a,i,t,D){const j=_,I=h;return g(),x(v,null,{default:e(()=>[o(P,null,{default:e(()=>[o(l,{xs:"12",sm:"12",md:"8",lg:"8",xl:"8",xxl:"8",cols:"12"},{default:e(()=>{var c;return[s("div",M,[s("div",null,[o(b,{"close-on-content-click":!1},{activator:e(({props:w})=>[o(p,V({rounded:"lg",variant:"tonal",class:"text-none","prepend-icon":"mdi-source-commit"},w),{prepend:e(()=>[o(d)]),default:e(()=>[m(u(t.commitInfo?t.commitInfo.commit.branch:"加载中..."),1)]),_:2},1040)]),_:1})]),o(p,{variant:"tonal",class:"text-none","prepend-icon":"mdi-source-branch",rounded:"lg",to:`/${r.$route.params.username}/${r.$route.params.projectname}/tree/${((c=t.commitInfo)==null?void 0:c.commit.branch)||"main"}`},{prepend:e(()=>[o(d)]),default:e(()=>[n[0]||(n[0]=m("返回最新提交"))]),_:1,__:[0]},8,["to"])]),o(j,{"project-id":t.project.id,"commit-id":r.$route.params.commitId,showplayer:t.showplayer},null,8,["project-id","commit-id","showplayer"]),n[1]||(n[1]=s("br",null,null,-1)),o(C,{hover:"",border:"",title:t.commitInfo?t.commitInfo.commit.commit_message:"加载中...",subtitle:t.commitInfo?t.commitInfo.commit.commit_date:"加载中..."},{default:e(()=>[o($,null,{default:e(()=>[m(u(t.commitInfo?t.commitInfo.commit.commit_description:"加载中..."),1)]),_:1})]),_:1},8,["title","subtitle"]),n[2]||(n[2]=s("br",null,null,-1))]}),_:1,__:[1,2]}),o(l,{xs:"12",sm:"12",md:"4",lg:"4",xl:"4",xxl:"8",cols:"12"},{default:e(()=>[o(I,{project:t.project,author:t.author,username:r.$route.params.username,projectname:r.$route.params.projectname},null,8,["project","author","username","projectname"])]),_:1})]),_:1})]),_:1})}const E=y(H,[["render",R]]);export{E as default};
