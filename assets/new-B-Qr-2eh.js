import{_ as x,Y as g,o as p,N as r,e as t,Q as h,R as f,f as o,i as n,L as i,W as _,aF as w,aD as U,a3 as V,c as b,aB as c,F as k,U as v,a0 as R,aE as A,a9 as C,a5 as y,bJ as L,X as S,T,a1 as B}from"./index-CqDYMkg5.js";import{V as F}from"./VTextarea-BMQ0gWum.js";import{V as N}from"./VSpacer-BmIOKXlY.js";const O={name:"NewOAuthApplication",data(){return{form:{name:"",description:"",homepage_url:"",redirect_uris:[""],scopes:["profile"]},loading:!1,snackbar:{show:!1,text:"",color:"success"}}},methods:{async saveApplication(){this.loading=!0;try{const a=await B.post("/oauth/applications",{name:this.form.name,description:this.form.description,homepage_url:this.form.homepage_url,redirect_uris:this.form.redirect_uris.filter(e=>e.trim()),type:"oauth",scopes:this.form.scopes});this.showSuccess("应用创建成功"),this.$router.push("/app/oauth/applications/"+a.data.client_id)}catch(a){this.showError("创建应用失败"),console.error("Failed to create application:",a)}this.loading=!1},addRedirectUri(){this.form.redirect_uris||(this.form.redirect_uris=[]),this.form.redirect_uris.push("")},removeRedirectUri(a){this.form.redirect_uris&&this.form.redirect_uris.length>1&&this.form.redirect_uris.splice(a,1)},showSuccess(a){this.snackbar={show:!0,text:a,color:"success"}},showError(a){this.snackbar={show:!0,text:a,color:"error"}}}},D={class:"d-flex align-center"};function E(a,e,I,q,s,m){return p(),g(T,{fluid:""},{default:r(()=>[t(h,{class:"mb-4"},{default:r(()=>[t(f,null,{default:r(()=>[o("div",D,[t(n,{variant:"text",to:"/app/oauth/applications","prepend-icon":"mdi-arrow-left",class:"mr-4"},{default:r(()=>e[4]||(e[4]=[i(" 返回应用列表 ")])),_:1,__:[4]}),e[5]||(e[5]=o("h1",{class:"text-h4"},"创建 OAuth 应用",-1))])]),_:1})]),_:1}),t(h,null,{default:r(()=>[t(f,{cols:"12",md:"8"},{default:r(()=>[t(_,null,{default:r(()=>[t(w,{onSubmit:U(m.saveApplication,["prevent"]),ref:"form"},{default:r(()=>[t(V,null,{default:r(()=>[e[7]||(e[7]=o("h2",{class:"text-h6 mb-4"},"基本信息",-1)),t(c,{modelValue:s.form.name,"onUpdate:modelValue":e[0]||(e[0]=l=>s.form.name=l),label:"应用名称",rules:[l=>!!l||"应用名称是必填的"],required:"",class:"mb-4"},null,8,["modelValue","rules"]),t(F,{modelValue:s.form.description,"onUpdate:modelValue":e[1]||(e[1]=l=>s.form.description=l),label:"应用描述",hint:"简要描述你的应用，帮助用户了解应用的用途",rows:"3",class:"mb-4"},null,8,["modelValue"]),t(c,{modelValue:s.form.homepage_url,"onUpdate:modelValue":e[2]||(e[2]=l=>s.form.homepage_url=l),label:"应用主页",hint:"你的应用的完整URL",rules:[l=>!l||/^https?:\/\/.+/.test(l)||"请输入有效的URL（以http://或https://开头）"],class:"mb-4"},null,8,["modelValue","rules"]),e[8]||(e[8]=o("h2",{class:"text-h6 mb-4 mt-6"},"回调设置",-1)),(p(!0),b(k,null,v(s.form.redirect_uris,(l,d)=>(p(),b("div",{key:d,class:"d-flex mb-2"},[t(c,{modelValue:s.form.redirect_uris[d],"onUpdate:modelValue":u=>s.form.redirect_uris[d]=u,label:"授权回调URL",rules:[u=>!!u||"回调URL是必填的",u=>/^https?:\/\/.+/.test(u)||"请输入有效的URL（以http://或https://开头）"],required:"",class:"mr-2"},null,8,["modelValue","onUpdate:modelValue","rules"]),t(n,{icon:"mdi-delete",variant:"text",color:"error",onClick:u=>m.removeRedirectUri(d),disabled:s.form.redirect_uris.length===1},null,8,["onClick","disabled"])]))),128)),t(n,{"prepend-icon":"mdi-plus",variant:"text",class:"mt-2",onClick:m.addRedirectUri},{default:r(()=>e[6]||(e[6]=[i(" 添加回调URL ")])),_:1,__:[6]},8,["onClick"])]),_:1,__:[7,8]}),t(R),t(A,{class:"pa-4"},{default:r(()=>[t(N),t(n,{variant:"outlined",class:"mr-2",to:"/app/oauth/applications"},{default:r(()=>e[9]||(e[9]=[i(" 取消 ")])),_:1,__:[9]}),t(n,{color:"primary",type:"submit",loading:s.loading},{default:r(()=>e[10]||(e[10]=[i(" 创建应用 ")])),_:1,__:[10]},8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1}),t(f,{cols:"12",md:"4"},{default:r(()=>[t(_,null,{default:r(()=>[t(C,{class:"text-h6"},{default:r(()=>e[11]||(e[11]=[i(" 创建说明 ")])),_:1,__:[11]}),t(V,null,{default:r(()=>[e[13]||(e[13]=o("p",{class:"text-body-2 mb-4"}," OAuth应用允许其他应用通过OAuth2.0协议访问你的API。创建应用后，你将获得客户端ID和密钥。 ",-1)),t(y,{type:"info",variant:"tonal",class:"mb-4"},{default:r(()=>e[12]||(e[12]=[o("h4",{class:"text-subtitle-1 font-weight-bold mb-2"},"重要提示",-1),o("ul",{class:"ml-4"},[o("li",null,"客户端密钥只会显示一次，请妥善保管"),o("li",null,"回调URL必须使用HTTPS（本地开发除外）"),o("li",null,"谨慎选择应用权限范围")],-1)])),_:1,__:[12]}),e[14]||(e[14]=o("p",{class:"text-body-2"},[i(" 需要帮助？查看我们的 "),o("a",{href:"#",target:"_blank",class:"text-decoration-none"},"OAuth应用开发指南"),i("。 ")],-1))]),_:1,__:[13,14]})]),_:1})]),_:1})]),_:1}),t(L,{modelValue:s.snackbar.show,"onUpdate:modelValue":e[3]||(e[3]=l=>s.snackbar.show=l),color:s.snackbar.color,timeout:3e3},{default:r(()=>[i(S(s.snackbar.text),1)]),_:1},8,["modelValue","color"])]),_:1})}const M=x(O,[["render",E],["__scopeId","data-v-796f2e06"]]);export{M as default};
