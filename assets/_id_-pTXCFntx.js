import{a as y}from"./Comment-DBzcsMtF.js";import{_ as P}from"./proxylicense-D00uEcui.js";import{_ as b}from"./ProxyShowProjects-BZpXY2pM.js";import{_ as w}from"./ProxyShowUsers-DKy4WfPI.js";import{aa as m,a1 as h,_ as S,Y as j,o as U,N as e,f,e as t,W as v,ah as L,ai as _,L as i,a3 as T,a6 as I,a7 as g,X as r,ez as k,S as l,O as u,j as D,Z as N,n as B,T as W,r as Z}from"./index-BtdOAlf3.js";import"./TimeAgo-CQ5zqTk1.js";import"./_commonjsHelpers-BosuxZz1.js";import"./VTextarea-9IHUMTAQ.js";import"https://static.geetest.com/v4/gt4.js";async function M(a){const s=await m("scratchproxy.url");return h.get(s+`/studios/${a}`)}async function z(a,s=1,n=16){const c=await m("scratchproxy.url");return h.get(c+`/studios/${a}/projects?&offset=${s*16-16}&limit=${n}`)}async function A(a,s=1,n=16){const c=await m("scratchproxy.url");return h.get(c+`/studios/${a}/curators?&offset=${s*16-16}&limit=${n}`)}async function G(a,s=1,n=16){const c=await m("scratchproxy.url");return h.get(c+`/studios/${a}/managers?&offset=${s*16-16}&limit=${n}`)}const O={components:{Comment:y,ProxyShowUsers:w,ProxyShowProjects:b},data(){return{tab:Z(null),UserCardLoading:!0,ProjectsLoading:!0,userid:this.$route.params.id,studioinfo:{id:1,title:"加载中",host:1,description:"加载中",visibility:"visible",public:!0,open_to_all:!0,comments_allowed:!0,image:"",history:{created:"2000-01-01T00:00:00.000Z",modified:"2000-01-01T00:00:00.000Z"},stats:{comments:0,followers:0,managers:0,projects:0}},curators:[],curatorspage:0,curatorscanload:!0,managers:[],managerspage:0,managerscanload:!0,usetime:0,projects:[],curPage:1,limit:18,scratch_proxy:""}},async created(){await this.fetchStudioInfo(),await this.onPageChange(1,!1)},async mounted(){this.scratch_proxy=await m("scratchproxy.url")},methods:{async fetchStudioInfo(){try{const a=await M(this.$route.params.id);this.studioinfo=a.data}catch(a){console.log(a)}finally{this.UserCardLoading=!1}},async onPageChange(a,s){s&&(this.projects=[]),this.usetime=Date.now(),this.ProjectsLoading=!0;try{const n=await z(this.$route.params.id,a,this.limit);this.projects=this.projects.concat(n.data)}catch(n){console.log(n)}finally{this.ProjectsLoading=!1,this.usetime=Date.now()-this.usetime}this.curPage=a},async onCuratorsPageChange(a){try{const s=await A(this.$route.params.id,a,this.limit);s.data.length===0&&(this.curatorscanload=!1),this.curators=this.curators.concat(s.data)}catch(s){console.log(s)}this.curatorspage=a},async onManagersPageChange(a){try{const s=await G(this.$route.params.id,a,this.limit);s.data.length===0&&(this.managerscanload=!1),this.managers=this.managers.concat(s.data)}catch(s){console.log(s)}this.managerspage=a}}},X={class:"mb-2"},Y={class:"font-weight-black"};function q(a,s,n,c,o,E){const p=w,V=b,x=P,C=y;return U(),j(W,null,{default:e(()=>[f("div",X,[t(v,{disabled:o.UserCardLoading,loading:o.UserCardLoading,class:"mx-auto mb-4"},{prepend:e(()=>[t(N,{class:"mb-2"},{default:e(()=>[t(B,{alt:o.studioinfo.username,src:o.studioinfo.image},null,8,["alt","src"])]),_:1})]),title:e(()=>[f("span",Y,r(o.studioinfo.title),1)]),loader:e(({isActive:d})=>[t(D,{active:d,height:"4",indeterminate:""},null,8,["active"])]),subtitle:e(()=>[t(k,{column:""},{default:e(()=>[t(l,null,{default:e(()=>[t(u,{icon:"mdi-account-circle",start:""}),i(" ID:"+r(o.studioinfo.id),1)]),_:1}),t(l,null,{default:e(()=>[t(u,{icon:"mdi-clock",start:""}),i(" "+r(o.studioinfo.history.created)+"创建 ",1)]),_:1}),t(l,null,{default:e(()=>[t(u,{icon:"mdi-clock",start:""}),i(" "+r(o.studioinfo.history.modified)+"更新 ",1)]),_:1}),t(l,null,{default:e(()=>[t(u,{icon:"mdi-earth",start:""}),i(" "+r(o.studioinfo.public==!0?"公开":"私密"),1)]),_:1}),t(l,null,{default:e(()=>[t(u,{icon:"mdi-earth",start:""}),i(" "+r(o.studioinfo.open_to_all==!0?"对所有人开放":"需要邀请"),1)]),_:1}),t(l,null,{default:e(()=>[t(u,{icon:"mdi-earth",start:""}),i(" "+r(o.studioinfo.comments_allowed==!0?"Scratch官网允许评论":"Scratch官网不允许评论"),1)]),_:1}),t(l,null,{default:e(()=>[t(u,{icon:"mdi-earth",start:""}),i(" Scratch官网"+r(o.studioinfo.stats.comments)+"评论 ",1)]),_:1}),t(l,null,{default:e(()=>[t(u,{icon:"mdi-earth",start:""}),i(" "+r(o.studioinfo.stats.followers)+"被关注 ",1)]),_:1}),t(l,null,{default:e(()=>[t(u,{icon:"mdi-earth",start:""}),i(" "+r(o.studioinfo.stats.managers)+"成员 ",1)]),_:1}),t(l,null,{default:e(()=>[t(u,{icon:"mdi-earth",start:""}),i(" "+r(o.studioinfo.stats.projects)+"项目 ",1)]),_:1})]),_:1})]),default:e(()=>[t(L,{modelValue:o.tab,"onUpdate:modelValue":s[0]||(s[0]=d=>o.tab=d)},{default:e(()=>[t(_,{value:"description"},{default:e(()=>s[2]||(s[2]=[i("简介",-1)])),_:1,__:[2]}),t(_,{value:"members"},{default:e(()=>s[3]||(s[3]=[i("成员",-1)])),_:1,__:[3]})]),_:1},8,["modelValue"]),t(T,null,{default:e(()=>[t(I,{modelValue:o.tab,"onUpdate:modelValue":s[1]||(s[1]=d=>o.tab=d)},{default:e(()=>[t(g,{value:"description"},{default:e(()=>[f("pre",null,r(o.studioinfo.description),1)]),_:1}),t(g,{value:"members"},{default:e(()=>[t(p,{autoload:!0,url:`/studios/${o.studioinfo.id}/managers?`,subtitle:"用户列表",title:"管理员"},null,8,["url"]),s[4]||(s[4]=f("br",null,null,-1)),t(p,{autoload:!0,url:`/studios/${o.studioinfo.id}/curators?`,subtitle:"用户列表",title:"成员"},null,8,["url"])]),_:1,__:[4]})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["disabled","loading"]),t(V,{autoload:!0,showUserInfo:!0,url:`/studios/${o.studioinfo.id}/projects?`,subtitle:"项目列表",title:"项目"},null,8,["url"]),t(x,{url:"https://scratch.mit.edu/studios/"+o.studioinfo.id},null,8,["url"])]),t(C,{url:"scratchmitedustudio-"+o.studioinfo.id,name:"Scratch官网工作室"},null,8,["url"])]),_:1})}const ot=S(O,[["render",q]]);export{ot as default};
