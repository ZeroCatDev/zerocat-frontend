import{ai as q,R as n,aj as w,Q as k,r as C,e as B,o as V,a as t,w as l,G as p,c as N,a8 as T,af as E,a4 as g,I as M,H as _,O as x,K as R}from"./index-B0la7aLz.js";import{V as b,a as h}from"./VRow-Cy10sc29.js";import{V as j}from"./VForm-BQYdutB-.js";import{V as F}from"./VAlert-E0oDbRzR.js";/* empty css              */const I={class:"auth-wrapper d-flex align-center justify-center pa-4"},H={__name:"verify",setup(S){const f=q(),u=n(""),s=n(""),r=n(!1),i=n(""),v=n("success"),d={required:a=>!!a||"此字段为必填项",email:a=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)||"请输入有效的邮箱地址",length:a=>(a==null?void 0:a.length)===6||"验证码必须是6位数字"};w(()=>{const a=f.query.email,e=f.query.token;a&&(u.value=a),e&&(s.value=e),a&&e&&y()});const y=async()=>{var a,e;if(!r.value){if(!u.value||!s.value){m("请输入邮箱和验证码","error");return}if(s.value.length!==6){m("验证码必须是6位数字","error");return}r.value=!0,i.value="";try{const o=await k.post("/account/verify-email",{email:u.value,token:s.value});m(o.data.message||"邮箱验证成功！","success")}catch(o){m(((e=(a=o.response)==null?void 0:a.data)==null?void 0:e.message)||"验证失败，请重试","error")}finally{r.value=!1}}},m=(a,e="success")=>{i.value=a,v.value=e};return(a,e)=>{const o=C("v-cardtext");return V(),B("div",I,[t(R,{class:"auth-card pa-4 pt-7","max-width":"448",border:"",rounded:"lg"},{default:l(()=>[t(b,null,{default:l(()=>[t(h,{cols:"12"},{default:l(()=>[t(o,null,{default:l(()=>e[2]||(e[2]=[p("h5",{class:"text-h5 font-weight-semibold mb-1"}," 欢迎来到ZeroCatNext！ 👋🏻 ",-1),p("p",{class:"mb-0"},"验证你的邮箱",-1)])),_:1})]),_:1})]),_:1}),t(o,null,{default:l(()=>[t(b,null,{default:l(()=>[t(h,{cols:"12"},{default:l(()=>[t(j,{onSubmit:E(y,["prevent"])},{default:l(()=>[t(g,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=c=>u.value=c),label:"邮箱地址",type:"email",required:"",rules:[d.required,d.email],placeholder:"请输入邮箱地址",variant:"outlined"},null,8,["modelValue","rules"]),t(g,{modelValue:s.value,"onUpdate:modelValue":e[1]||(e[1]=c=>s.value=c),label:"验证码",type:"text",required:"",rules:[d.required,d.length],maxlength:"6",placeholder:"请输入6位验证码",variant:"outlined",class:"mt-4"},null,8,["modelValue","rules"]),t(M,{type:"submit",loading:r.value,disabled:r.value,color:"primary",size:"large"},{default:l(()=>[_(x(r.value?"验证中...":"验证"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1}),e[3]||(e[3]=p("br",null,null,-1)),i.value?(V(),N(F,{key:0,type:v.value,variant:"tonal"},{default:l(()=>[_(x(i.value),1)]),_:1},8,["type"])):T("",!0)]),_:1})])}}};export{H as default};
