import{l as m,b as y}from"./project-BYNw-iDL.js";import{l as _,b as S}from"./user-BU-b6xhU.js";import{_ as v}from"./43-lazyload-CBkwrR6M.js";import{_ as g,o as i,c,w as t,e as n,T as d,U as p,a as s,R as f,Q,ah as V,af as C,O as h,W as l,ag as w,a3 as k,N as x,a1 as I}from"./index-B38-HsvM.js";import{a as A,V as F}from"./VRow-GcI9zMS4.js";const j={props:{projectIds:{type:Array,required:!0},actions:{type:Array}},data(){return{projects:[],authorids:[],authors:{},liveQuerySubscription:null,authorQuerySubscription:null}},watch:{projectIds:{handler(){this.startLiveFetch(),this.refreshData()},immediate:!0,deep:!0}},methods:{startLiveFetch(){this.liveQuerySubscription&&this.liveQuerySubscription.unsubscribe(),this.liveQuerySubscription=m(this.projectIds,e=>{this.projects=e,this.updateAuthorIds()})},updateAuthorIds(){const e=[...new Set(this.projects.map(a=>a.authorid))];JSON.stringify(e)!==JSON.stringify(this.authorids)&&(this.authorids=e,this.startAuthorLiveFetch())},startAuthorLiveFetch(){this.authorQuerySubscription&&this.authorQuerySubscription.unsubscribe(),this.authorQuerySubscription=_(this.authorids,e=>{const a={};e.forEach(o=>{a[o.id]=o}),this.authors=a})},async refreshData(){await y(this.projectIds),await S(this.authorids)}},beforeDestroy(){this.liveQuerySubscription&&this.liveQuerySubscription.unsubscribe(),this.authorQuerySubscription&&this.authorQuerySubscription.unsubscribe()}};function D(e,a,o,N,b,L){return i(),c(F,null,{default:t(()=>[(i(!0),n(d,null,p(b.projects,r=>(i(),c(A,{key:r.id,cols:"12",xs:"12",sm:"6",md:"4",lg:"3",xl:"2",xxl:"2"},{default:t(()=>[s(f,{rounded:"lg",border:""},{default:t(()=>[s(f,{to:"/projects/"+r.id,style:{"aspect-ratio":"4/3"},rounded:"lg"},{default:t(()=>[s(Q,{src:"https://s4-1.wuyuan.1r.ink/scratch_slt/"+r.id,class:"align-end","lazy-src":v,height:"100%",gradient:"to bottom, rgba(0,0,0,.1), rgba(0,0,0,.5)",cover:""},{default:t(()=>[s(V,null,{default:t(()=>[s(C,null,{default:t(()=>[h(l(r.title||"未缓存"),1)]),_:2},1024),s(w,null,{default:t(()=>[h(l(r.description||""),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["src"])]),_:2},1032,["to"]),o.actions?(i(),c(k,{key:0},{default:t(()=>[(i(!0),n(d,null,p(o.actions,u=>(i(),n("div",{key:u.name},[s(x,{onClick:B=>u.function(r.id,r)},{default:t(()=>[h(l(u.name),1)]),_:2},1032,["onClick"])]))),128))]),_:2},1024)):I("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:1})}const J=g(j,[["render",D]]);export{J as s};
