import{_ as D,bu as S,bp as z,bq as F,c as M,o as j,e as a,M as l,aK as G,Q as H,R as f,aG as T,aF as J,Y as K,a8 as Q,f as n,L as u,m as _,aI as P,i as g,aa as W,aJ as Y,N as X,bo as $,r as i,bs as ee,af as te,a6 as ae,br as B}from"./index-CoinsG4v.js";import{_ as I}from"./AuthCard-BKcjR3Pn.js";import{V as Z}from"./VTooltip-D4_qv6jc.js";import{V as x}from"./VCheckbox-BwJEHft_.js";import"https://static.geetest.com/v4/gt4.js";const oe={components:{LoadingDialog:F,Recaptcha:z,AuthCard:I,OAuthButtons:S},setup(){const p=$(),e=i(null),c=i(""),o=i(""),C=i(""),w=i(!1),k=i(!1),v=i(null),m=i({privacy:!1,terms:!1,rules:!1,datadelete:!1}),R=[t=>!!t||"必须填写邮箱",t=>/.+@.+\..+/.test(t)||"不符合格式"],s=[t=>!!t||"必须填写用户名",t=>t.length>=3||"用户名至少需要3个字符",t=>t.length<=20||"用户名最多20个字符"],r=[t=>!!t||"必须填写密码",t=>t.length>=8||"密码至少需要8个字符",t=>/[A-Za-z]/.test(t)&&/[0-9]/.test(t)||"密码必须包含字母和数字"],q=Object.entries(ee).filter(([t])=>t!=="default").map(([t,y])=>({id:t,...y}));te.isLogin.value===!0&&p.push("/app/dashboard"),ae({title:"注册"});const E=()=>{m.value={privacy:!1,terms:!1,rules:!1,datadelete:!1}},L=()=>{for(const t in m.value)if(m.value[t]===!1)return V("请先阅读并同意相关协议"),!1;return!0},N=async()=>{var t,y,U;try{if(!L())return;w.value=!0;const b=((t=v.value)==null?void 0:t.getResponse())||null,A={email:c.value,username:o.value,password:C.value,captcha:b,skipPassword:!1},d=await B.register(A);d.status==="success"?d.needVerify?(localStorage.setItem("verificationEmail",c.value),d.temporaryToken&&localStorage.setItem("verificationToken",d.temporaryToken),p.push("/app/account/register/verify")):(h(d.message||"注册成功"),d.needPassword?p.push("/app/account/register/setup-password"):p.push("/app/dashboard")):V(d.message||"注册失败")}catch(b){console.error(b);const A=((U=(y=b.response)==null?void 0:y.data)==null?void 0:U.message)||"注册失败，请稍后再试";V(A)}finally{w.value=!1}},O=t=>{window.location.href=B.oauthRedirect(t,!0)},h=t=>{window.$toast?window.$toast.add({severity:"success",summary:"成功",detail:t,life:3e3}):window.$notify?window.$notify({title:"成功",message:t,type:"success"}):(console.log("Success:",t),alert(t))},V=t=>{window.$toast?window.$toast.add({severity:"error",summary:"错误",detail:t,life:3e3}):window.$notify?window.$notify({title:"错误",message:t,type:"error"}):(console.error("Error:",t),alert(t))};return{email:c,username:o,password:C,loading:w,showPassword:k,agreement:m,emailRules:R,usernameRules:s,passwordRules:r,recaptcha:v,registerForm:e,register:N,resetAgreement:E,registerWithOAuth:O,showSuccessToast:h,showErrorToast:V,providers:q}}},le={class:"mb-2"},re={class:"mb-2"},se={class:"mb-2"};function ne(p,e,c,o,C,w){const k=z,v=S,m=I,R=F;return j(),M("div",null,[a(m,{subtitle:"创建你的账户"},{default:l(()=>[a(G,{ref:"registerForm"},{default:l(()=>[a(H,null,{default:l(()=>[a(f,{cols:"12"},{default:l(()=>[a(T,{modelValue:o.email,"onUpdate:modelValue":e[0]||(e[0]=s=>o.email=s),rules:o.emailRules,label:"邮箱",required:"",type:"email",variant:"outlined"},null,8,["modelValue","rules"]),a(T,{modelValue:o.username,"onUpdate:modelValue":e[1]||(e[1]=s=>o.username=s),rules:o.usernameRules,label:"用户名",required:"",type:"text",variant:"outlined"},null,8,["modelValue","rules"]),a(T,{modelValue:o.password,"onUpdate:modelValue":e[2]||(e[2]=s=>o.password=s),"append-icon":o.showPassword?"mdi-eye":"mdi-eye-off",rules:o.passwordRules,type:o.showPassword?"text":"password",label:"密码",required:"",variant:"outlined","onClick:append":e[3]||(e[3]=s=>o.showPassword=!o.showPassword)},null,8,["modelValue","append-icon","rules","type"])]),_:1}),a(f,{cols:"12"},{default:l(()=>[a(k,{ref:"recaptcha",recaptchaId:"recaptcha-div"},null,512)]),_:1}),a(f,{cols:"12"},{default:l(()=>[a(J,{persistent:""},{activator:l(({props:s})=>[a(g,_({loading:o.loading,"append-icon":"mdi-arrow-right",class:"text-none",color:"primary",rounded:"xl",size:"large",text:"注册"},s,{variant:"flat"}),null,16,["loading"])]),default:l(({isActive:s})=>[a(K,{title:"您正在使用由ZeroCat零猫社区提供的服务"},{default:l(()=>[a(Q,null,{default:l(()=>[n("div",le,[e[12]||(e[12]=u(" 你需要同意 ",-1)),a(Z,{location:"bottom"},{activator:l(({props:r})=>[n("a",_({href:"/app/legal/privacy",target:"_blank"},r,{onClick:e[4]||(e[4]=P(()=>{},["stop"]))})," ZeroCat零猫社区隐私政策 ",16)]),default:l(()=>[e[11]||(e[11]=u(" ZeroCat零猫社区隐私政策 ",-1))]),_:1,__:[11]})]),a(x,{modelValue:o.agreement.privacy,"onUpdate:modelValue":e[5]||(e[5]=r=>o.agreement.privacy=r)},{label:l(()=>e[13]||(e[13]=[n("div",null,"我已阅读并同意隐私政策",-1)])),_:1},8,["modelValue"]),e[22]||(e[22]=n("div",{class:"mb-2"}," 我们将在中国大陆安全的存储您的数据，我们暂不提供自助删除您的个人数据，如果您希望删除您的数据，您需要优先选择联系我们 ",-1)),a(x,{modelValue:o.agreement.datadelete,"onUpdate:modelValue":e[6]||(e[6]=r=>o.agreement.datadelete=r)},{label:l(()=>e[14]||(e[14]=[n("div",null," 我理解并同意我无法自助删除我的个人数据，在需要时我会主动联系管理员删除 ",-1)])),_:1},8,["modelValue"]),n("div",re,[e[16]||(e[16]=u(" 在 ZeroCat 上，你需要遵守 ",-1)),a(Z,{location:"bottom"},{activator:l(({props:r})=>[n("a",_({href:"/legal/community-guidelines",target:"_blank"},r,{onClick:e[7]||(e[7]=P(()=>{},["stop"]))})," 社区行为准则 ",16)]),default:l(()=>[e[15]||(e[15]=u(" 社区行为准则 ",-1))]),_:1,__:[15]})]),a(x,{modelValue:o.agreement.rules,"onUpdate:modelValue":e[8]||(e[8]=r=>o.agreement.rules=r)},{label:l(()=>e[17]||(e[17]=[n("div",null,"我已阅读并同意将会遵守社区行为准则",-1)])),_:1},8,["modelValue"]),n("div",se,[e[19]||(e[19]=u(" 你需要同意 ",-1)),a(Z,{location:"bottom"},{activator:l(({props:r})=>[n("a",_({href:"/app/legal/terms",target:"_blank"},r,{onClick:e[9]||(e[9]=P(()=>{},["stop"]))})," ZeroCat零猫社区用户协议 ",16)]),default:l(()=>[e[18]||(e[18]=u(" ZeroCat零猫社区用户协议 ",-1))]),_:1,__:[18]})]),a(x,{modelValue:o.agreement.terms,"onUpdate:modelValue":e[10]||(e[10]=r=>o.agreement.terms=r)},{label:l(()=>e[20]||(e[20]=[n("div",null,"我已阅读并同意用户协议",-1)])),_:1},8,["modelValue"]),a(g,{loading:o.loading,"append-icon":"mdi-arrow-right",class:"text-none mt-4",color:"primary",rounded:"xl",size:"large",text:"注册",variant:"flat",onClick:o.register},null,8,["loading","onClick"]),a(W,{border:"start",class:"mt-4",density:"comfortable",type:"warning",variant:"tonal"},{default:l(()=>e[21]||(e[21]=[u(' 对于技术手段绕过此页面的行为视为对 ZeroCat 的基础设施进行攻击，涉嫌非法入侵计算机系统，我们将保留追究法律责任的权利，违规获得的账户不被授权访问网站，账户将不受保护，如果您同意以上内容，请点击"复选框"以完成注册流程。 ',-1)])),_:1,__:[21]})]),_:1,__:[22]}),a(Y,null,{default:l(()=>[a(X),a(g,{text:"取消",onClick:r=>{s.value=!1,o.resetAgreement()}},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1})]),_:1}),a(f,{cols:"12"},{default:l(()=>[a(g,{"append-icon":"mdi-arrow-right",class:"text-none",color:"white",rounded:"xl",size:"large",text:"登录",to:"/app/account/login",variant:"text"}),a(g,{"append-icon":"mdi-arrow-right",class:"text-none",color:"white",rounded:"xl",size:"large",text:"找回密码",to:"/app/account/retrieve",variant:"text"})]),_:1}),a(f,{cols:"12"},{default:l(()=>[a(v,{mode:"register"})]),_:1})]),_:1})]),_:1},512)]),_:1}),a(R,{show:o.loading,text:"正在注册"},null,8,["show"])])}const fe=D(oe,[["render",ne],["__scopeId","data-v-19a68449"]]);export{fe as default};
