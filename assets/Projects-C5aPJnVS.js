import{_}from"./ProjectCard-DXWUwwWl.js";import{_ as g,bC as V,Y as l,o as a,N as s,c as j,F as y,U as x,R as C,e as o,Q as P,a1 as k,f as d,L as c,j as T,$ as B,S as h,O as m,X as f,aY as F,i as N}from"./index-D8wbA9Dz.js";const b={components:{ProjectCard:_},props:{projectIds:{type:Array,required:!0},showAuthor:{type:Boolean,default:!1}},data(){return{projects:[],loading:!1,VITE_APP_S3_BUCKET:"https://zerocat-bitiful.houlangs.com"}},watch:{projectIds:{handler(){this.loadData()},immediate:!0,deep:!0}},methods:{async loadData(){this.loading=!0;try{await this.fetchProjects()}catch(r){console.error("Failed to load data:",r)}finally{this.loading=!1}},async fetchProjects(){try{this.projects=await V(this.projectIds)}catch(r){console.error("Failed to fetch projects:",r),this.projects=[]}}}};function A(r,t,p,w,e,i){const u=_;return a(),l(P,null,{default:s(()=>[(a(!0),j(y,null,x(e.projects,n=>(a(),l(C,{key:n.id,cols:"12",xs:"12",sm:"6",md:"4",lg:"3",xl:"2",xxl:"2"},{default:s(()=>[o(u,{"project-data":n,"author-data":n.author,"show-author":p.showAuthor},null,8,["project-data","author-data","show-author"])]),_:2},1024))),128))]),_:1})}const I=g(b,[["render",A]]),S={components:{showProjects:I},props:{url:{type:String,required:!0}},data(){return{projectIds:[],page:1,limit:16,totalPage:1,totalCount:0,loading:!1,loadTime:0}},computed:{hasTotalCount(){return this.totalCount>0}},methods:{async fetchProjects(){this.loading=!0;const r=performance.now();try{const t=(await k.get(`${this.url}&curr=${this.page}&limit=${this.limit}`)).data;t.totalCount?(this.projectIds=t.projects,this.totalCount=t.totalCount,this.totalPage=Math.ceil(this.totalCount/this.limit)):this.projectIds=[...this.projectIds,...t.projects]}catch(t){console.error("Failed to fetch projects:",t)}finally{this.loading=!1,this.loadTime=performance.now()-r}},loadMore(){this.page++,this.fetchProjects()}},watch:{url:{handler(){this.page=1,this.fetchProjects()},immediate:!0},page:{handler(){this.fetchProjects()}}}},D={class:"mt-2 text-medium-emphasis"};function E(r,t,p,w,e,i){const u=I;return a(),j(y,null,[o(T,{indeterminate:"",color:"primary",active:e.loading,height:"4"},null,8,["active"]),o(P,null,{default:s(()=>[o(C,{cols:"12"},{default:s(()=>[d("p",D,[o(h,null,{default:s(()=>[o(m,{icon:"mdi-timer",start:""}),c(" 加载耗时: "+f(e.loadTime)+" ms ",1)]),_:1}),e.totalCount?(a(),l(h,{key:0},{default:s(()=>[o(m,{icon:"mdi-counter",start:""}),c(" 总作品数量: "+f(e.totalCount),1)]),_:1})):B("",!0)])]),_:1})]),_:1}),o(u,{projectIds:e.projectIds},null,8,["projectIds"]),t[2]||(t[2]=d("br",null,null,-1)),i.hasTotalCount?(a(),l(F,{key:0,modelValue:e.page,"onUpdate:modelValue":t[0]||(t[0]=n=>e.page=n),length:e.totalPage,onInput:i.fetchProjects,rounded:"circle"},null,8,["modelValue","length","onInput"])):(a(),l(N,{key:1,onClick:i.loadMore,color:"primary"},{default:s(()=>t[1]||(t[1]=[c("继续加载")])),_:1,__:[1]},8,["onClick"])),t[3]||(t[3]=c()),t[4]||(t[4]=d("br",null,null,-1))],64)}const U=g(S,[["render",E]]);export{U as _};
