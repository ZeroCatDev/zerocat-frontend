import{a as f}from"./Comment-DlIgYLd-.js";import{_ as h,a as u}from"./ProjectPlayer-D_oeXTDg.js";import{_ as l}from"./ProjectBranchNav-Db4fbSFj.js";import{_ as y,Y as b,o as w,N as o,e,R as B,S as m,f as C,W as P,ao as $,ap as g,aq as p,ar as x,a7 as I,as as N,ag as H}from"./index-sIbGf8Dn.js";import"./TimeAgo-B0BTBmsi.js";import"./_commonjsHelpers-BosuxZz1.js";import"./VTextarea-DocgrHtD.js";import"./UserRelationControls-BsyiJ5EF.js";import"./projectListService-DsjdqUq9.js";import"./openEdit-BX8FwpvB.js";import"./CodeRunTerminal-p5rMAf-A.js";import"./programming_languages-Aq2ViMcP.js";import"./ProjectSelector-D-hhQ_GE.js";import"./VRadioGroup-EOrIG4Jp.js";import"./VSwitch-YhylQtq2.js";import"./VTimeline-Ctk5STiy.js";import"https://static.geetest.com/v4/gt4.js";const V={components:{ProjectBranchNav:l,ProjectPlayer:u,ProjectInfoCard:h},data(){return{project:{},author:{},localuser:H,projectbranchs:[],projectbranchhistory:[],showplayer:!0,currentCommitId:"",initProject:N}},async mounted(){await this.initlizeProject()},methods:{async initlizeProject(){const r=this.$route.params.username,a=this.$route.params.projectname,n=this.$route.params.branch;if(r==="proxy"){this.$router.replace(`/app${this.$route.path}`);return}const s=await g(r,a);if(s.id===0){p.show404();return}if(this.project=s,this.project.default_branch==null){this.showplayer=!1;return}var t=await x(this.project.id);if(t.data.length===0){this.showplayer=!1;return}this.projectbranchs=t.data;const c=this.projectbranchs.find(i=>i.name===n);if(!c){p.show404();return}this.currentCommitId=c.latest_commit_hash,this.loadBranchHistory(),I({title:`${this.project.title} at ${n}`}),this.author=this.project.author},async loadBranchHistory(){const r=await $(this.project.id,this.currentCommitId);this.projectbranchhistory=r}},watch:{"$route.params.branch":{handler:async function(r){await this.initlizeProject()},immediate:!0}}};function v(r,a,n,s,t,c){const i=l,j=u,d=h,_=f;return w(),b(P,null,{default:o(()=>[e(B,null,{default:o(()=>[e(m,{cols:"12",lg:"8",md:"8",sm:"12",xl:"8",xs:"12",xxl:"8"},{default:o(()=>[e(i,{"branch-history":t.projectbranchhistory,branches:t.projectbranchs,"current-branch":r.$route.params.branch,"current-commit-id":t.currentCommitId,projectname:r.$route.params.projectname,username:r.$route.params.username},null,8,["branch-history","branches","current-branch","current-commit-id","projectname","username"]),e(j,{branch:r.$route.params.branch,"commit-id":t.currentCommitId,"project-id":t.project.id,showplayer:t.showplayer,type:t.project.type},null,8,["branch","commit-id","project-id","showplayer","type"]),a[0]||(a[0]=C("br",null,null,-1))]),_:1}),e(m,{cols:"12",lg:"4",md:"4",sm:"12",xl:"4",xs:"12",xxl:"8"},{default:o(()=>[e(d,{author:t.author,project:t.project,projectname:r.$route.params.projectname,username:r.$route.params.username},null,8,["author","project","projectname","username"])]),_:1}),e(m,{cols:"12",lg:"8",md:"8",sm:"12",xl:"8",xs:"12",xxl:"8"},{default:o(()=>[e(_,{name:` ${t.project.title} 的分支：${r.$route.params.branch} `,url:"project-"+t.project.id+"#"+r.$route.params.branch},null,8,["name","url"])]),_:1})]),_:1})]),_:1})}const Q=y(V,[["render",v]]);export{Q as default};
